---
author:
  nick: Dimas Lanjaka 2
  link: https://www.blogger.com/profile/08197822797622284515
  email: noreply@blogger.com
category: []
comments: true
cover: https://res.cloudinary.com/dimaslanjaka/image/fetch/https://www.seoclerk.com/pics/want29446-1eGFdc1437614695.png
date: 2018-03-26T21:18:00.000+07:00
lang: en
location: ""
modified: 2018-03-27T02:22:48.845+07:00
subtitle: FeatureSupport unzip fileSupport edit file/script on different
  encodingsSupport upload,edit,open,delete,rename,and other.Support add
tags:
  - Tools
  - Script
  - PHP
title: 00webhost file manager alternative
type: post
uuid: 6de7befd-bc1c-4888-8919-f36828840d7a
webtitle: WMI Gitlab
updated: 2018-03-27T02:22:48+07:00
thumbnail: https://res.cloudinary.com/dimaslanjaka/image/fetch/https://www.seoclerk.com/pics/want29446-1eGFdc1437614695.png
photos:
  - https://res.cloudinary.com/dimaslanjaka/image/fetch/https://www.seoclerk.com/pics/want29446-1eGFdc1437614695.png
description: FeatureSupport unzip fileSupport edit file/script on different
  encodingsSupport upload,edit,open,delete,rename,and other.Support add
---

<div>Feature:<br><br><ol><li>Support unzip file</li><li>Support edit file/script on different encodings</li><li>Support upload,edit,open,delete,rename,and other.</li><li>Support add username and password.</li><li>And any other.</li></ol></div><img src="https://res.cloudinary.com/dimaslanjaka/image/fetch/https://www.seoclerk.com/pics/want29446-1eGFdc1437614695.png" title="PHP FILE MANAGER"><br><center><h2>H3K | Tiny File Manager</h2></center><b style="float: right;">Modified By Dimas Lanjaka</b><br><pre>&lt;?php<br>/**<br> * H3K | Tiny File Manager<br> * CCP Programmers<br> * http://fb.com/ccpprogrammers<br> * https://github.com/prasathmani/tinyfilemanager<br> */<br><br>// Default language<br>$lang = 'en';<br><br>// Auth with login/password (set true/false to enable/disable it)<br>$use_auth = true;<br><br>// Users: array('user' =&gt; 'user', 'user' =&gt; 'user2', etc);<br><br>$auth_users = array(<br>    'your_username' =&gt; md5('your_password'),<br>    'user2' =&gt; md5('pass2'), <br>);<br><br>// Readonly users (usernames array)<br>$readonly_users = array(<br>    'user2'<br>);<br><br>// Show or hide files and folders that starts with a dot<br>$show_hidden_files = true;<br><br>// Enable highlight.js (https://highlightjs.org/) on view's page<br>$use_highlightjs = true;<br><br>// highlight.js style<br>$highlightjs_style = 'vs';<br><br>// Enable ace.js (https://ace.c9.io/) on view's page<br>$edit_files = true;<br><br>// Send files though mail<br>$send_mail = false;<br><br>// Send files though mail<br>$toMailId = ""; //yourmailid@mail.com<br><br>// Default timezone for date() and time() - http://php.net/manual/en/timezones.php<br>$default_timezone = 'Etc/UTC'; // UTC<br><br>// Root path for file manager<br>$root_path = $_SERVER['DOCUMENT_ROOT'];<br><br>// Root url for links in file manager.Relative to $http_host. Variants: '', 'path/to/subfolder'<br>// Will not working if $root_path will be outside of server document root<br>$root_url = '';<br><br>// Server hostname. Can set manually if wrong<br>$http_host = $_SERVER['HTTP_HOST'];<br><br>// input encoding for iconv<br>$iconv_input_encoding = 'UTF-8';<br><br>// date() format for file modification date<br>$datetime_format = 'd.m.y H:i';<br><br>// allowed upload file extensions<br>$upload_extensions = ''; // 'gif,png,jpg'<br><br>// show or hide the left side tree view<br>$show_tree_view = false;<br><br>//Array of folders excluded from listing<br>$GLOBALS['exclude_folders'] = array(<br>);<br><br>// include user config php file<br>if (defined('FM_CONFIG') &amp;&amp; is_file(FM_CONFIG) ) {<br> include(FM_CONFIG);<br>}<br><br>//--- EDIT BELOW CAREFULLY OR DO NOT EDIT AT ALL<br><br>// if fm included<br>if (defined('FM_EMBED')) {<br>    $use_auth = false;<br>} else {<br>    @set_time_limit(600);<br><br>    date_default_timezone_set($default_timezone);<br><br>    ini_set('default_charset', 'UTF-8');<br>    if (version_compare(PHP_VERSION, '5.6.0', '&lt;') &amp;&amp; function_exists('mb_internal_encoding')) {<br>        mb_internal_encoding('UTF-8');<br>    }<br>    if (function_exists('mb_regex_encoding')) {<br>        mb_regex_encoding('UTF-8');<br>    }<br><br>    session_cache_limiter('');<br>    session_name('filemanager');<br>    session_start();<br>}<br><br>if (empty($auth_users)) {<br>    $use_auth = false;<br>}<br><br>$is_https = isset($_SERVER['HTTPS']) &amp;&amp; ($_SERVER['HTTPS'] == 'on' || $_SERVER['HTTPS'] == 1)<br>    || isset($_SERVER['HTTP_X_FORWARDED_PROTO']) &amp;&amp; $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https';<br><br>// clean and check $root_path<br>$root_path = rtrim($root_path, '\\/');<br>$root_path = str_replace('\\', '/', $root_path);<br>if (!@is_dir($root_path)) {<br>    echo "&lt;h1&gt;Root path \"{$root_path}\" not found!&lt;/h1&gt;";<br>    exit;<br>}<br><br>// clean $root_url<br>$root_url = fm_clean_path($root_url);<br><br>// abs path for site<br>defined('FM_SHOW_HIDDEN') || define('FM_SHOW_HIDDEN', $show_hidden_files);<br>defined('FM_ROOT_PATH') || define('FM_ROOT_PATH', $root_path);<br>defined('FM_ROOT_URL') || define('FM_ROOT_URL', ($is_https ? 'https' : 'http') . '://' . $http_host . (!empty($root_url) ? '/' . $root_url : ''));<br>defined('FM_SELF_URL') || define('FM_SELF_URL', ($is_https ? 'https' : 'http') . '://' . $http_host . $_SERVER['PHP_SELF']);<br><br>// logout<br>if (isset($_GET['logout'])) {<br>    unset($_SESSION['logged']);<br>    fm_redirect(FM_SELF_URL);<br>}<br><br>// Show image here<br>if (isset($_GET['img'])) {<br>    fm_show_image($_GET['img']);<br>}<br><br>// Auth<br>if ($use_auth) {<br>    if (isset($_SESSION['logged'], $auth_users[$_SESSION['logged']])) {<br>        // Logged<br>    } elseif (isset($_POST['fm_usr'], $_POST['fm_pwd'])) {<br>        // Logging In<br>        sleep(1);<br>        if (isset($auth_users[$_POST['fm_usr']]) &amp;&amp; md5($_POST['fm_pwd']) === $auth_users[$_POST['fm_usr']]) {<br>            $_SESSION['logged'] = $_POST['fm_usr'];<br>            fm_set_msg('You are logged in');<br>            fm_redirect(FM_SELF_URL . '?p=');<br>        } else {<br>            unset($_SESSION['logged']);<br>            fm_set_msg('Wrong password', 'error');<br>            fm_redirect(FM_SELF_URL);<br>        }<br>    } else {<br>        // Form<br>        unset($_SESSION['logged']);<br>        fm_show_header_login();<br>        fm_show_message();<br>        ?&gt;<br>        &lt;div class="path login-form"&gt;<br>                &lt;img src="https://image.ibb.co/k92AFQ/h3k_logo_dark.png" alt="H3K File manager" style="margin:20px;"&gt;<br>            &lt;form action="" method="post"&gt;<br>                &lt;label for="fm_usr"&gt;Username&lt;/label&gt;&lt;input type="text" id="fm_usr" name="fm_usr" value="" placeholder="Username" required&gt;&lt;br&gt;<br>                &lt;label for="fm_pwd"&gt;Password&lt;/label&gt;&lt;input type="password" id="fm_pwd" name="fm_pwd" value="" placeholder="Password" required&gt;&lt;br&gt;<br>                &lt;input type="submit" value="Login"&gt;<br>            &lt;/form&gt;<br>        &lt;/div&gt;<br>        &lt;?php<br>        fm_show_footer_login();<br>        exit;<br>    }<br>}<br><br>defined('FM_LANG') || define('FM_LANG', $lang);<br>defined('FM_EXTENSION') || define('FM_EXTENSION', $upload_extensions);<br>defined('FM_TREEVIEW') || define('FM_TREEVIEW', $show_tree_view);<br>define('FM_READONLY', $use_auth &amp;&amp; !empty($readonly_users) &amp;&amp; isset($_SESSION['logged']) &amp;&amp; in_array($_SESSION['logged'], $readonly_users));<br>define('FM_IS_WIN', DIRECTORY_SEPARATOR == '\\');<br><br>// always use ?p=<br>if (!isset($_GET['p'])) {<br>    fm_redirect(FM_SELF_URL . '?p=');<br>}<br><br>// get path<br>$p = isset($_GET['p']) ? $_GET['p'] : (isset($_POST['p']) ? $_POST['p'] : '');<br><br>// clean path<br>$p = fm_clean_path($p);<br><br>// instead globals vars<br>define('FM_PATH', $p);<br>define('FM_USE_AUTH', $use_auth);<br>define('FM_EDIT_FILE', $edit_files);<br>defined('FM_ICONV_INPUT_ENC') || define('FM_ICONV_INPUT_ENC', $iconv_input_encoding);<br>defined('FM_USE_HIGHLIGHTJS') || define('FM_USE_HIGHLIGHTJS', $use_highlightjs);<br>defined('FM_HIGHLIGHTJS_STYLE') || define('FM_HIGHLIGHTJS_STYLE', $highlightjs_style);<br>defined('FM_DATETIME_FORMAT') || define('FM_DATETIME_FORMAT', $datetime_format);<br><br>unset($p, $use_auth, $iconv_input_encoding, $use_highlightjs, $highlightjs_style);<br><br>/*************************** ACTIONS ***************************/<br><br>//AJAX Request<br>if (isset($_POST['ajax']) &amp;&amp; !FM_READONLY) {<br><br>    //search : get list of files from the current folder<br>    if(isset($_POST['type']) &amp;&amp; $_POST['type']=="search") {<br>        $dir = $_POST['path'];<br>        $response = scan($dir);<br>        echo json_encode($response);<br>    }<br><br>    //Send file to mail<br>    if (isset($_POST['type']) &amp;&amp; $_POST['type']=="mail") {<br>        //send mail Fn removed.<br>    }<br><br>    //backup files<br>    if(isset($_POST['type']) &amp;&amp; $_POST['type']=="backup") {<br>        $file = $_POST['file'];<br>        $path = $_POST['path'];<br>        $date = date("dMy-His");<br>        $newFile = $file.'-'.$date.'.bak';<br>        copy($path.'/'.$file, $path.'/'.$newFile) or die("Unable to backup");<br>        echo "Backup $newFile Created";<br>    }<br><br>    exit;<br>}<br><br>// Delete file / folder<br>if (isset($_GET['del']) &amp;&amp; !FM_READONLY) {<br>    $del = $_GET['del'];<br>    $del = fm_clean_path($del);<br>    $del = str_replace('/', '', $del);<br>    if ($del != '' &amp;&amp; $del != '..' &amp;&amp; $del != '.') {<br>        $path = FM_ROOT_PATH;<br>        if (FM_PATH != '') {<br>            $path .= '/' . FM_PATH;<br>        }<br>        $is_dir = is_dir($path . '/' . $del);<br>        if (fm_rdelete($path . '/' . $del)) {<br>            $msg = $is_dir ? 'Folder &lt;b&gt;%s&lt;/b&gt; deleted' : 'File &lt;b&gt;%s&lt;/b&gt; deleted';<br>            fm_set_msg(sprintf($msg, fm_enc($del)));<br>        } else {<br>            $msg = $is_dir ? 'Folder &lt;b&gt;%s&lt;/b&gt; not deleted' : 'File &lt;b&gt;%s&lt;/b&gt; not deleted';<br>            fm_set_msg(sprintf($msg, fm_enc($del)), 'error');<br>        }<br>    } else {<br>        fm_set_msg('Wrong file or folder name', 'error');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Create folder<br>if (isset($_GET['new']) &amp;&amp; isset($_GET['type']) &amp;&amp; !FM_READONLY) {<br>    $new = strip_tags($_GET['new']);<br>    $type = $_GET['type'];<br>    $new = fm_clean_path($new);<br>    $new = str_replace('/', '', $new);<br>    if ($new != '' &amp;&amp; $new != '..' &amp;&amp; $new != '.') {<br>        $path = FM_ROOT_PATH;<br>        if (FM_PATH != '') {<br>            $path .= '/' . FM_PATH;<br>        }<br>        if($_GET['type']=="file") {<br>            if(!file_exists($path . '/' . $new)) {<br>                @fopen($path . '/' . $new, 'w') or die('Cannot open file:  '.$new);<br>                fm_set_msg(sprintf('File &lt;b&gt;%s&lt;/b&gt; created', fm_enc($new)));<br>            } else {<br>                fm_set_msg(sprintf('File &lt;b&gt;%s&lt;/b&gt; already exists', fm_enc($new)), 'alert');<br>            }<br>        } else {<br>            if (fm_mkdir($path . '/' . $new, false) === true) {<br>                fm_set_msg(sprintf('Folder &lt;b&gt;%s&lt;/b&gt; created', $new));<br>            } elseif (fm_mkdir($path . '/' . $new, false) === $path . '/' . $new) {<br>                fm_set_msg(sprintf('Folder &lt;b&gt;%s&lt;/b&gt; already exists', fm_enc($new)), 'alert');<br>            } else {<br>                fm_set_msg(sprintf('Folder &lt;b&gt;%s&lt;/b&gt; not created', fm_enc($new)), 'error');<br>            }<br>        }<br>    } else {<br>        fm_set_msg('Wrong folder name', 'error');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Copy folder / file<br>if (isset($_GET['copy'], $_GET['finish']) &amp;&amp; !FM_READONLY) {<br>    // from<br>    $copy = $_GET['copy'];<br>    $copy = fm_clean_path($copy);<br>    // empty path<br>    if ($copy == '') {<br>        fm_set_msg('Source path not defined', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br>    // abs path from<br>    $from = FM_ROOT_PATH . '/' . $copy;<br>    // abs path to<br>    $dest = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $dest .= '/' . FM_PATH;<br>    }<br>    $dest .= '/' . basename($from);<br>    // move?<br>    $move = isset($_GET['move']);<br>    // copy/move<br>    if ($from != $dest) {<br>        $msg_from = trim(FM_PATH . '/' . basename($from), '/');<br>        if ($move) {<br>            $rename = fm_rename($from, $dest);<br>            if ($rename) {<br>                fm_set_msg(sprintf('Moved from &lt;b&gt;%s&lt;/b&gt; to &lt;b&gt;%s&lt;/b&gt;', fm_enc($copy), fm_enc($msg_from)));<br>            } elseif ($rename === null) {<br>                fm_set_msg('File or folder with this path already exists', 'alert');<br>            } else {<br>                fm_set_msg(sprintf('Error while moving from &lt;b&gt;%s&lt;/b&gt; to &lt;b&gt;%s&lt;/b&gt;', fm_enc($copy), fm_enc($msg_from)), 'error');<br>            }<br>        } else {<br>            if (fm_rcopy($from, $dest)) {<br>                fm_set_msg(sprintf('Copyied from &lt;b&gt;%s&lt;/b&gt; to &lt;b&gt;%s&lt;/b&gt;', fm_enc($copy), fm_enc($msg_from)));<br>            } else {<br>                fm_set_msg(sprintf('Error while copying from &lt;b&gt;%s&lt;/b&gt; to &lt;b&gt;%s&lt;/b&gt;', fm_enc($copy), fm_enc($msg_from)), 'error');<br>            }<br>        }<br>    } else {<br>        fm_set_msg('Paths must be not equal', 'alert');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Mass copy files/ folders<br>if (isset($_POST['file'], $_POST['copy_to'], $_POST['finish']) &amp;&amp; !FM_READONLY) {<br>    // from<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br>    // to<br>    $copy_to_path = FM_ROOT_PATH;<br>    $copy_to = fm_clean_path($_POST['copy_to']);<br>    if ($copy_to != '') {<br>        $copy_to_path .= '/' . $copy_to;<br>    }<br>    if ($path == $copy_to_path) {<br>        fm_set_msg('Paths must be not equal', 'alert');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br>    if (!is_dir($copy_to_path)) {<br>        if (!fm_mkdir($copy_to_path, true)) {<br>            fm_set_msg('Unable to create destination folder', 'error');<br>            fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>        }<br>    }<br>    // move?<br>    $move = isset($_POST['move']);<br>    // copy/move<br>    $errors = 0;<br>    $files = $_POST['file'];<br>    if (is_array($files) &amp;&amp; count($files)) {<br>        foreach ($files as $f) {<br>            if ($f != '') {<br>                // abs path from<br>                $from = $path . '/' . $f;<br>                // abs path to<br>                $dest = $copy_to_path . '/' . $f;<br>                // do<br>                if ($move) {<br>                    $rename = fm_rename($from, $dest);<br>                    if ($rename === false) {<br>                        $errors++;<br>                    }<br>                } else {<br>                    if (!fm_rcopy($from, $dest)) {<br>                        $errors++;<br>                    }<br>                }<br>            }<br>        }<br>        if ($errors == 0) {<br>            $msg = $move ? 'Selected files and folders moved' : 'Selected files and folders copied';<br>            fm_set_msg($msg);<br>        } else {<br>            $msg = $move ? 'Error while moving items' : 'Error while copying items';<br>            fm_set_msg($msg, 'error');<br>        }<br>    } else {<br>        fm_set_msg('Nothing selected', 'alert');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Rename<br>if (isset($_GET['ren'], $_GET['to']) &amp;&amp; !FM_READONLY) {<br>    // old name<br>    $old = $_GET['ren'];<br>    $old = fm_clean_path($old);<br>    $old = str_replace('/', '', $old);<br>    // new name<br>    $new = $_GET['to'];<br>    $new = fm_clean_path($new);<br>    $new = str_replace('/', '', $new);<br>    // path<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br>    // rename<br>    if ($old != '' &amp;&amp; $new != '') {<br>        if (fm_rename($path . '/' . $old, $path . '/' . $new)) {<br>            fm_set_msg(sprintf('Renamed from &lt;b&gt;%s&lt;/b&gt; to &lt;b&gt;%s&lt;/b&gt;', fm_enc($old), fm_enc($new)));<br>        } else {<br>            fm_set_msg(sprintf('Error while renaming from &lt;b&gt;%s&lt;/b&gt; to &lt;b&gt;%s&lt;/b&gt;', fm_enc($old), fm_enc($new)), 'error');<br>        }<br>    } else {<br>        fm_set_msg('Names not set', 'error');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Download<br>if (isset($_GET['dl'])) {<br>    $dl = $_GET['dl'];<br>    $dl = fm_clean_path($dl);<br>    $dl = str_replace('/', '', $dl);<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br>    if ($dl != '' &amp;&amp; is_file($path . '/' . $dl)) {<br>        header('Content-Description: File Transfer');<br>        header('Content-Type: application/octet-stream');<br>        header('Content-Disposition: attachment; filename="' . basename($path . '/' . $dl) . '"');<br>        header('Content-Transfer-Encoding: binary');<br>        header('Connection: Keep-Alive');<br>        header('Expires: 0');<br>        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');<br>        header('Pragma: public');<br>        header('Content-Length: ' . filesize($path . '/' . $dl));<br>        readfile($path . '/' . $dl);<br>        exit;<br>    } else {<br>        fm_set_msg('File not found', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br>}<br><br>// Upload<br>if (isset($_POST['upl']) &amp;&amp; !FM_READONLY) {<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br><br>    $errors = 0;<br>    $uploads = 0;<br>    $total = count($_FILES['upload']['name']);<br>   $allowed = (FM_EXTENSION) ? explode(',', FM_EXTENSION) : false;<br><br>    for ($i = 0; $i &lt; $total; $i++) {<br>  $filename = $_FILES['upload']['name'][$i];<br>        $tmp_name = $_FILES['upload']['tmp_name'][$i];<br>  $ext = pathinfo($filename, PATHINFO_EXTENSION);<br>  $isFileAllowed = ($allowed) ? in_array($ext,$allowed) : true;<br>        if (empty($_FILES['upload']['error'][$i]) &amp;&amp; !empty($tmp_name) &amp;&amp; $tmp_name != 'none' &amp;&amp; $isFileAllowed) {<br>            if (move_uploaded_file($tmp_name, $path . '/' . $_FILES['upload']['name'][$i])) {<br>                $uploads++;<br>            } else {<br>                $errors++;<br>            }<br>        }<br>    }<br><br>    if ($errors == 0 &amp;&amp; $uploads &gt; 0) {<br>        fm_set_msg(sprintf('All files uploaded to &lt;b&gt;%s&lt;/b&gt;', fm_enc($path)));<br>    } elseif ($errors == 0 &amp;&amp; $uploads == 0) {<br>        fm_set_msg('Nothing uploaded', 'alert');<br>    } else {<br>        fm_set_msg(sprintf('Error while uploading files. Uploaded files: %s', $uploads), 'error');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Mass deleting<br>if (isset($_POST['group'], $_POST['delete']) &amp;&amp; !FM_READONLY) {<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br><br>    $errors = 0;<br>    $files = $_POST['file'];<br>    if (is_array($files) &amp;&amp; count($files)) {<br>        foreach ($files as $f) {<br>            if ($f != '') {<br>                $new_path = $path . '/' . $f;<br>                if (!fm_rdelete($new_path)) {<br>                    $errors++;<br>                }<br>            }<br>        }<br>        if ($errors == 0) {<br>            fm_set_msg('Selected files and folder deleted');<br>        } else {<br>            fm_set_msg('Error while deleting items', 'error');<br>        }<br>    } else {<br>        fm_set_msg('Nothing selected', 'alert');<br>    }<br><br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Pack files<br>if (isset($_POST['group'], $_POST['zip']) &amp;&amp; !FM_READONLY) {<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br><br>    if (!class_exists('ZipArchive')) {<br>        fm_set_msg('Operations with archives are not available', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    $files = $_POST['file'];<br>    if (!empty($files)) {<br>        chdir($path);<br><br>        if (count($files) == 1) {<br>            $one_file = reset($files);<br>            $one_file = basename($one_file);<br>            $zipname = $one_file . '_' . date('ymd_His') . '.zip';<br>        } else {<br>            $zipname = 'archive_' . date('ymd_His') . '.zip';<br>        }<br><br>        $zipper = new FM_Zipper();<br>        $res = $zipper-&gt;create($zipname, $files);<br><br>        if ($res) {<br>            fm_set_msg(sprintf('Archive &lt;b&gt;%s&lt;/b&gt; created', fm_enc($zipname)));<br>        } else {<br>            fm_set_msg('Archive not created', 'error');<br>        }<br>    } else {<br>        fm_set_msg('Nothing selected', 'alert');<br>    }<br><br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Unpack<br>if (isset($_GET['unzip']) &amp;&amp; !FM_READONLY) {<br>    $unzip = $_GET['unzip'];<br>    $unzip = fm_clean_path($unzip);<br>    $unzip = str_replace('/', '', $unzip);<br><br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br><br>    if (!class_exists('ZipArchive')) {<br>        fm_set_msg('Operations with archives are not available', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    if ($unzip != '' &amp;&amp; is_file($path . '/' . $unzip)) {<br>        $zip_path = $path . '/' . $unzip;<br><br>        //to folder<br>        $tofolder = '';<br>        if (isset($_GET['tofolder'])) {<br>            $tofolder = pathinfo($zip_path, PATHINFO_FILENAME);<br>            if (fm_mkdir($path . '/' . $tofolder, true)) {<br>                $path .= '/' . $tofolder;<br>            }<br>        }<br><br>        $zipper = new FM_Zipper();<br>        $res = $zipper-&gt;unzip($zip_path, $path);<br><br>        if ($res) {<br>            fm_set_msg('Archive unpacked');<br>        } else {<br>            fm_set_msg('Archive not unpacked', 'error');<br>        }<br><br>    } else {<br>        fm_set_msg('File not found', 'error');<br>    }<br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>// Change Perms (not for Windows)<br>if (isset($_POST['chmod']) &amp;&amp; !FM_READONLY &amp;&amp; !FM_IS_WIN) {<br>    $path = FM_ROOT_PATH;<br>    if (FM_PATH != '') {<br>        $path .= '/' . FM_PATH;<br>    }<br><br>    $file = $_POST['chmod'];<br>    $file = fm_clean_path($file);<br>    $file = str_replace('/', '', $file);<br>    if ($file == '' || (!is_file($path . '/' . $file) &amp;&amp; !is_dir($path . '/' . $file))) {<br>        fm_set_msg('File not found', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    $mode = 0;<br>    if (!empty($_POST['ur'])) {<br>        $mode |= 0400;<br>    }<br>    if (!empty($_POST['uw'])) {<br>        $mode |= 0200;<br>    }<br>    if (!empty($_POST['ux'])) {<br>        $mode |= 0100;<br>    }<br>    if (!empty($_POST['gr'])) {<br>        $mode |= 0040;<br>    }<br>    if (!empty($_POST['gw'])) {<br>        $mode |= 0020;<br>    }<br>    if (!empty($_POST['gx'])) {<br>        $mode |= 0010;<br>    }<br>    if (!empty($_POST['or'])) {<br>        $mode |= 0004;<br>    }<br>    if (!empty($_POST['ow'])) {<br>        $mode |= 0002;<br>    }<br>    if (!empty($_POST['ox'])) {<br>        $mode |= 0001;<br>    }<br><br>    if (@chmod($path . '/' . $file, $mode)) {<br>        fm_set_msg('Permissions changed');<br>    } else {<br>        fm_set_msg('Permissions not changed', 'error');<br>    }<br><br>    fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>}<br><br>/*************************** /ACTIONS ***************************/<br><br>// get current path<br>$path = FM_ROOT_PATH;<br>if (FM_PATH != '') {<br>    $path .= '/' . FM_PATH;<br>}<br><br>// check path<br>if (!is_dir($path)) {<br>    fm_redirect(FM_SELF_URL . '?p=');<br>}<br><br>// get parent folder<br>$parent = fm_get_parent_path(FM_PATH);<br><br>$objects = is_readable($path) ? scandir($path) : array();<br>$folders = array();<br>$files = array();<br>if (is_array($objects)) {<br>    foreach ($objects as $file) {<br>        if ($file == '.' || $file == '..' &amp;&amp; in_array($file, $GLOBALS['exclude_folders'])) {<br>            continue;<br>        }<br>        if (!FM_SHOW_HIDDEN &amp;&amp; substr($file, 0, 1) === '.') {<br>            continue;<br>        }<br>        $new_path = $path . '/' . $file;<br>        if (is_file($new_path)) {<br>            $files[] = $file;<br>        } elseif (is_dir($new_path) &amp;&amp; $file != '.' &amp;&amp; $file != '..' &amp;&amp; !in_array($file, $GLOBALS['exclude_folders'])) {<br>            $folders[] = $file;<br>        }<br>    }<br>}<br><br>if (!empty($files)) {<br>    natcasesort($files);<br>}<br>if (!empty($folders)) {<br>    natcasesort($folders);<br>}<br><br>// upload form<br>if (isset($_GET['upload']) &amp;&amp; !FM_READONLY) {<br>    fm_show_header(); // HEADER<br>    fm_show_nav_path(FM_PATH); // current path<br>    ?&gt;<br>    &lt;div class="path"&gt;<br>        &lt;p&gt;&lt;b&gt;Uploading files&lt;/b&gt;&lt;/p&gt;<br>        &lt;p class="break-word"&gt;Destination folder: &lt;?php echo fm_enc(fm_convert_win(FM_ROOT_PATH . '/' . FM_PATH)) ?&gt;&lt;/p&gt;<br>        &lt;form action="" method="post" enctype="multipart/form-data"&gt;<br>            &lt;input type="hidden" name="p" value="&lt;?php echo fm_enc(FM_PATH) ?&gt;"&gt;<br>            &lt;input type="hidden" name="upl" value="1"&gt;<br>            &lt;input type="file" name="upload[]"&gt;&lt;br&gt;<br>            &lt;input type="file" name="upload[]"&gt;&lt;br&gt;<br>            &lt;input type="file" name="upload[]"&gt;&lt;br&gt;<br>            &lt;input type="file" name="upload[]"&gt;&lt;br&gt;<br>            &lt;input type="file" name="upload[]"&gt;&lt;br&gt;<br>            &lt;br&gt;<br>            &lt;p&gt;<br>                &lt;button type="submit" class="btn"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; Upload&lt;/button&gt; &amp;nbsp;<br>                &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;"&gt;&lt;i class="fa fa-times-circle"&gt;&lt;/i&gt; Cancel&lt;/a&gt;&lt;/b&gt;<br>            &lt;/p&gt;<br>        &lt;/form&gt;<br>    &lt;/div&gt;<br>    &lt;?php<br>    fm_show_footer();<br>    exit;<br>}<br><br>// copy form POST<br>if (isset($_POST['copy']) &amp;&amp; !FM_READONLY) {<br>    $copy_files = $_POST['file'];<br>    if (!is_array($copy_files) || empty($copy_files)) {<br>        fm_set_msg('Nothing selected', 'alert');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    fm_show_header(); // HEADER<br>    fm_show_nav_path(FM_PATH); // current path<br>    ?&gt;<br>    &lt;div class="path"&gt;<br>        &lt;p&gt;&lt;b&gt;Copying&lt;/b&gt;&lt;/p&gt;<br>        &lt;form action="" method="post"&gt;<br>            &lt;input type="hidden" name="p" value="&lt;?php echo fm_enc(FM_PATH) ?&gt;"&gt;<br>            &lt;input type="hidden" name="finish" value="1"&gt;<br>            &lt;?php<br>            foreach ($copy_files as $cf) {<br>                echo '&lt;input type="hidden" name="file[]" value="' . fm_enc($cf) . '"&gt;' . PHP_EOL;<br>            }<br>            ?&gt;<br>            &lt;p class="break-word"&gt;Files: &lt;b&gt;&lt;?php echo implode('&lt;/b&gt;, &lt;b&gt;', $copy_files) ?&gt;&lt;/b&gt;&lt;/p&gt;<br>            &lt;p class="break-word"&gt;Source folder: &lt;?php echo fm_enc(fm_convert_win(FM_ROOT_PATH . '/' . FM_PATH)) ?&gt;&lt;br&gt;<br>                &lt;label for="inp_copy_to"&gt;Destination folder:&lt;/label&gt;<br>                &lt;?php echo FM_ROOT_PATH ?&gt;/&lt;input type="text" name="copy_to" id="inp_copy_to" value="&lt;?php echo fm_enc(FM_PATH) ?&gt;"&gt;<br>            &lt;/p&gt;<br>            &lt;p&gt;&lt;label&gt;&lt;input type="checkbox" name="move" value="1"&gt; Move'&lt;/label&gt;&lt;/p&gt;<br>            &lt;p&gt;<br>                &lt;button type="submit" class="btn"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; Copy &lt;/button&gt; &amp;nbsp;<br>                &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;"&gt;&lt;i class="fa fa-times-circle"&gt;&lt;/i&gt; Cancel&lt;/a&gt;&lt;/b&gt;<br>            &lt;/p&gt;<br>        &lt;/form&gt;<br>    &lt;/div&gt;<br>    &lt;?php<br>    fm_show_footer();<br>    exit;<br>}<br><br>// copy form<br>if (isset($_GET['copy']) &amp;&amp; !isset($_GET['finish']) &amp;&amp; !FM_READONLY) {<br>    $copy = $_GET['copy'];<br>    $copy = fm_clean_path($copy);<br>    if ($copy == '' || !file_exists(FM_ROOT_PATH . '/' . $copy)) {<br>        fm_set_msg('File not found', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    fm_show_header(); // HEADER<br>    fm_show_nav_path(FM_PATH); // current path<br>    ?&gt;<br>    &lt;div class="path"&gt;<br>        &lt;p&gt;&lt;b&gt;Copying&lt;/b&gt;&lt;/p&gt;<br>        &lt;p class="break-word"&gt;<br>            Source path: &lt;?php echo fm_enc(fm_convert_win(FM_ROOT_PATH . '/' . $copy)) ?&gt;&lt;br&gt;<br>            Destination folder: &lt;?php echo fm_enc(fm_convert_win(FM_ROOT_PATH . '/' . FM_PATH)) ?&gt;<br>        &lt;/p&gt;<br>        &lt;p&gt;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;copy=&lt;?php echo urlencode($copy) ?&gt;&amp;amp;finish=1"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; Copy&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;copy=&lt;?php echo urlencode($copy) ?&gt;&amp;amp;finish=1&amp;amp;move=1"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; Move&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;"&gt;&lt;i class="fa fa-times-circle"&gt;&lt;/i&gt; Cancel&lt;/a&gt;&lt;/b&gt;<br>        &lt;/p&gt;<br>        &lt;p&gt;&lt;i&gt;Select folder&lt;/i&gt;&lt;/p&gt;<br>        &lt;ul class="folders break-word"&gt;<br>            &lt;?php<br>            if ($parent !== false) {<br>                ?&gt;<br>                &lt;li&gt;&lt;a href="?p=&lt;?php echo urlencode($parent) ?&gt;&amp;amp;copy=&lt;?php echo urlencode($copy) ?&gt;"&gt;&lt;i class="fa fa-chevron-circle-left"&gt;&lt;/i&gt; ..&lt;/a&gt;&lt;/li&gt;<br>            &lt;?php<br>            }<br>            foreach ($folders as $f) {<br>                ?&gt;<br>                &lt;li&gt;&lt;a href="?p=&lt;?php echo urlencode(trim(FM_PATH . '/' . $f, '/')) ?&gt;&amp;amp;copy=&lt;?php echo urlencode($copy) ?&gt;"&gt;&lt;i class="fa fa-folder-o"&gt;&lt;/i&gt; &lt;?php echo fm_convert_win($f) ?&gt;&lt;/a&gt;&lt;/li&gt;<br>            &lt;?php<br>            }<br>            ?&gt;<br>        &lt;/ul&gt;<br>    &lt;/div&gt;<br>    &lt;?php<br>    fm_show_footer();<br>    exit;<br>}<br><br>// file viewer<br>if (isset($_GET['view'])) {<br>    $file = $_GET['view'];<br>    $file = fm_clean_path($file);<br>    $file = str_replace('/', '', $file);<br>    if ($file == '' || !is_file($path . '/' . $file)) {<br>        fm_set_msg('File not found', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    fm_show_header(); // HEADER<br>    fm_show_nav_path(FM_PATH); // current path<br><br>    $file_url = FM_ROOT_URL . fm_convert_win((FM_PATH != '' ? '/' . FM_PATH : '') . '/' . $file);<br>    $file_path = $path . '/' . $file;<br><br>    $ext = strtolower(pathinfo($file_path, PATHINFO_EXTENSION));<br>    $mime_type = fm_get_mime_type($file_path);<br>    $filesize = filesize($file_path);<br><br>    $is_zip = false;<br>    $is_image = false;<br>    $is_audio = false;<br>    $is_video = false;<br>    $is_text = false;<br><br>    $view_title = 'File';<br>    $filenames = false; // for zip<br>    $content = ''; // for text<br><br>    if ($ext == 'zip') {<br>        $is_zip = true;<br>        $view_title = 'Archive';<br>        $filenames = fm_get_zif_info($file_path);<br>    } elseif (in_array($ext, fm_get_image_exts())) {<br>        $is_image = true;<br>        $view_title = 'Image';<br>    } elseif (in_array($ext, fm_get_audio_exts())) {<br>        $is_audio = true;<br>        $view_title = 'Audio';<br>    } elseif (in_array($ext, fm_get_video_exts())) {<br>        $is_video = true;<br>        $view_title = 'Video';<br>    } elseif (in_array($ext, fm_get_text_exts()) || substr($mime_type, 0, 4) == 'text' || in_array($mime_type, fm_get_text_mimes())) {<br>        $is_text = true;<br>        $content = file_get_contents($file_path);<br>    }<br><br>    ?&gt;<br>    &lt;div class="path"&gt;<br>        &lt;p class="break-word"&gt;&lt;b&gt;&lt;?php echo $view_title ?&gt; "&lt;?php echo fm_enc(fm_convert_win($file)) ?&gt;"&lt;/b&gt;&lt;/p&gt;<br>        &lt;p class="break-word"&gt;<br>            Full path: &lt;?php echo fm_enc(fm_convert_win($file_path)) ?&gt;&lt;br&gt;<br>            File size: &lt;?php echo fm_get_filesize($filesize) ?&gt;&lt;?php if ($filesize &gt;= 1000): ?&gt; (&lt;?php echo sprintf('%s bytes', $filesize) ?&gt;)&lt;?php endif; ?&gt;&lt;br&gt;<br>           MIME-type: &lt;?php echo $mime_type ?&gt;&lt;br&gt;<br>            &lt;?php<br>            // ZIP info<br>            if ($is_zip &amp;&amp; $filenames !== false) {<br>                $total_files = 0;<br>                $total_comp = 0;<br>                $total_uncomp = 0;<br>                foreach ($filenames as $fn) {<br>                    if (!$fn['folder']) {<br>                        $total_files++;<br>                    }<br>                    $total_comp += $fn['compressed_size'];<br>                    $total_uncomp += $fn['filesize'];<br>                }<br>                ?&gt;<br>                Files in archive: &lt;?php echo $total_files ?&gt;&lt;br&gt;<br>                Total size: &lt;?php echo fm_get_filesize($total_uncomp) ?&gt;&lt;br&gt;<br>                Size in archive: &lt;?php echo fm_get_filesize($total_comp) ?&gt;&lt;br&gt;<br>                Compression: &lt;?php echo round(($total_comp / $total_uncomp) * 100) ?&gt;%&lt;br&gt;<br>                &lt;?php<br>            }<br>            // Image info<br>            if ($is_image) {<br>                $image_size = getimagesize($file_path);<br>                echo 'Image sizes: ' . (isset($image_size[0]) ? $image_size[0] : '0') . ' x ' . (isset($image_size[1]) ? $image_size[1] : '0') . '&lt;br&gt;';<br>            }<br>            // Text info<br>            if ($is_text) {<br>                $is_utf8 = fm_is_utf8($content);<br>                if (function_exists('iconv')) {<br>                    if (!$is_utf8) {<br>                        $content = iconv(FM_ICONV_INPUT_ENC, 'UTF-8//IGNORE', $content);<br>                    }<br>                }<br>                echo 'Charset: ' . ($is_utf8 ? 'utf-8' : '8 bit') . '&lt;br&gt;';<br>            }<br>            ?&gt;<br>        &lt;/p&gt;<br>        &lt;p&gt;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;dl=&lt;?php echo urlencode($file) ?&gt;"&gt;&lt;i class="fa fa-cloud-download"&gt;&lt;/i&gt; Download&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;b&gt;&lt;a href="&lt;?php echo fm_enc($file_url) ?&gt;" target="_blank"&gt;&lt;i class="fa fa-external-link-square"&gt;&lt;/i&gt; Open&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;?php<br>            // ZIP actions<br>            if (!FM_READONLY &amp;&amp; $is_zip &amp;&amp; $filenames !== false) {<br>                $zip_name = pathinfo($file_path, PATHINFO_FILENAME);<br>                ?&gt;<br>                &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;unzip=&lt;?php echo urlencode($file) ?&gt;"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; UnZip&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>                &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;unzip=&lt;?php echo urlencode($file) ?&gt;&amp;amp;tofolder=1" title="UnZip to &lt;?php echo fm_enc($zip_name) ?&gt;"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt;<br>                    UnZip to folder&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>                &lt;?php<br>            }<br>            if($is_text &amp;&amp; !FM_READONLY) {<br>            ?&gt;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(trim(FM_PATH)) ?&gt;&amp;amp;edit=&lt;?php echo urlencode($file) ?&gt;" class="edit-file"&gt;&lt;i class="fa fa-pencil-square"&gt;&lt;/i&gt; Edit&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(trim(FM_PATH)) ?&gt;&amp;amp;edit=&lt;?php echo urlencode($file) ?&gt;&amp;env=ace" class="edit-file"&gt;&lt;i class="fa fa-pencil-square"&gt;&lt;/i&gt; Advanced Edit&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;?php }<br>            if($send_mail &amp;&amp; !FM_READONLY) {<br>            ?&gt;<br>            &lt;b&gt;&lt;a href="javascript:mailto('&lt;?php echo urlencode(trim(FM_ROOT_PATH.'/'.FM_PATH)) ?&gt;','&lt;?php echo urlencode($file) ?&gt;')"&gt;&lt;i class="fa fa-pencil-square"&gt;&lt;/i&gt; Mail&lt;/a&gt;&lt;/b&gt; &amp;nbsp;<br>            &lt;?php } ?&gt;<br>            &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;"&gt;&lt;i class="fa fa-chevron-circle-left"&gt;&lt;/i&gt; Back&lt;/a&gt;&lt;/b&gt;<br>        &lt;/p&gt;<br>        &lt;?php<br>        if ($is_zip) {<br>            // ZIP content<br>            if ($filenames !== false) {<br>                echo '&lt;code class="maxheight"&gt;';<br>                foreach ($filenames as $fn) {<br>                    if ($fn['folder']) {<br>                        echo '&lt;b&gt;' . fm_enc($fn['name']) . '&lt;/b&gt;&lt;br&gt;';<br>                    } else {<br>                        echo $fn['name'] . ' (' . fm_get_filesize($fn['filesize']) . ')&lt;br&gt;';<br>                    }<br>                }<br>                echo '&lt;/code&gt;';<br>            } else {<br>                echo '&lt;p&gt;Error while fetching archive info&lt;/p&gt;';<br>            }<br>        } elseif ($is_image) {<br>            // Image content<br>            if (in_array($ext, array('gif', 'jpg', 'jpeg', 'png', 'bmp', 'ico'))) {<br>                echo '&lt;p&gt;&lt;img src="' . fm_enc($file_url) . '" alt="" class="preview-img"&gt;&lt;/p&gt;';<br>            }<br>        } elseif ($is_audio) {<br>            // Audio content<br>            echo '&lt;p&gt;&lt;audio src="' . fm_enc($file_url) . '" controls preload="metadata"&gt;&lt;/audio&gt;&lt;/p&gt;';<br>        } elseif ($is_video) {<br>            // Video content<br>            echo '&lt;div class="preview-video"&gt;&lt;video src="' . fm_enc($file_url) . '" width="640" height="360" controls preload="metadata"&gt;&lt;/video&gt;&lt;/div&gt;';<br>        } elseif ($is_text) {<br>            if (FM_USE_HIGHLIGHTJS) {<br>                // highlight<br>                $hljs_classes = array(<br>                    'shtml' =&gt; 'xml',<br>                    'htaccess' =&gt; 'apache',<br>                    'phtml' =&gt; 'php',<br>                    'lock' =&gt; 'json',<br>                    'svg' =&gt; 'xml',<br>                );<br>                $hljs_class = isset($hljs_classes[$ext]) ? 'lang-' . $hljs_classes[$ext] : 'lang-' . $ext;<br>                if (empty($ext) || in_array(strtolower($file), fm_get_text_names()) || preg_match('#\.min\.(css|js)$#i', $file)) {<br>                    $hljs_class = 'nohighlight';<br>                }<br>                $content = '&lt;pre class="with-hljs"&gt;&lt;code class="' . $hljs_class . '"&gt;' . fm_enc($content) . '&lt;/code&gt;&lt;/pre&gt;';<br>            } elseif (in_array($ext, array('php', 'php4', 'php5', 'phtml', 'phps'))) {<br>                // php highlight<br>                $content = highlight_string($content, true);<br>            } else {<br>                $content = '&lt;pre&gt;' . fm_enc($content) . '&lt;/pre&gt;';<br>            }<br>            echo $content;<br>        }<br>        ?&gt;<br>    &lt;/div&gt;<br>    &lt;?php<br>    fm_show_footer();<br>    exit;<br>}<br><br>// file editor<br>if (isset($_GET['edit'])) {<br>    $file = $_GET['edit'];<br>    $file = fm_clean_path($file);<br>    $file = str_replace('/', '', $file);<br>    if ($file == '' || !is_file($path . '/' . $file)) {<br>        fm_set_msg('File not found', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    fm_show_header(); // HEADER<br>    fm_show_nav_path(FM_PATH); // current path<br><br>    $file_url = FM_ROOT_URL . fm_convert_win((FM_PATH != '' ? '/' . FM_PATH : '') . '/' . $file);<br>    $file_path = $path . '/' . $file;<br><br>    //normal editer<br>    $isNormalEditor = true;<br>    if(isset($_GET['env'])) {<br>        if($_GET['env'] == "ace") {<br>            $isNormalEditor = false;<br>        }<br>    }<br><br>    //Save File<br>    if(isset($_POST['savedata'])) {<br>        $writedata = $_POST['savedata'];<br>        $fd=fopen($file_path,"w");<br>        @fwrite($fd, $writedata);<br>        fclose($fd);<br>        fm_set_msg('File Saved Successfully', 'alert');<br>    }<br><br>    $ext = strtolower(pathinfo($file_path, PATHINFO_EXTENSION));<br>    $mime_type = fm_get_mime_type($file_path);<br>    $filesize = filesize($file_path);<br>    $is_text = false;<br>    $content = ''; // for text<br><br>    if (in_array($ext, fm_get_text_exts()) || substr($mime_type, 0, 4) == 'text' || in_array($mime_type, fm_get_text_mimes())) {<br>        $is_text = true;<br>        $content = file_get_contents($file_path);<br>    }<br><br>    ?&gt;<br>    &lt;div class="path"&gt;<br>        &lt;div class="edit-file-actions"&gt;<br>            &lt;a title="Cancel" href="?p=&lt;?php echo urlencode(trim(FM_PATH)) ?&gt;&amp;amp;view=&lt;?php echo urlencode($file) ?&gt;"&gt;&lt;i class="fa fa-reply-all"&gt;&lt;/i&gt; Cancel&lt;/a&gt;<br>            &lt;a title="Backup" href="javascript:backup('&lt;?php echo urlencode($path) ?&gt;','&lt;?php echo urlencode($file) ?&gt;')"&gt;&lt;i class="fa fa-database"&gt;&lt;/i&gt; Backup&lt;/a&gt;<br>            &lt;?php if($is_text) { ?&gt;<br>                &lt;?php if($isNormalEditor) { ?&gt;<br>                    &lt;a title="Advanced" href="?p=&lt;?php echo urlencode(trim(FM_PATH)) ?&gt;&amp;amp;edit=&lt;?php echo urlencode($file) ?&gt;&amp;amp;env=ace"&gt;&lt;i class="fa fa-paper-plane"&gt;&lt;/i&gt; Advanced Editor&lt;/a&gt;<br>                    &lt;button type="button" name="Save" data-url="&lt;?php echo fm_enc($file_url) ?&gt;" onclick="edit_save(this,'nrl')"&gt;&lt;i class="fa fa-floppy-o"&gt;&lt;/i&gt; Save&lt;/button&gt;<br>                &lt;?php } else { ?&gt;<br>                    &lt;a title="Plain Editor" href="?p=&lt;?php echo urlencode(trim(FM_PATH)) ?&gt;&amp;amp;edit=&lt;?php echo urlencode($file) ?&gt;"&gt;&lt;i class="fa fa-text-height"&gt;&lt;/i&gt; Plain Editor&lt;/a&gt;<br>                    &lt;button type="button" name="Save" data-url="&lt;?php echo fm_enc($file_url) ?&gt;" onclick="edit_save(this,'ace')"&gt;&lt;i class="fa fa-floppy-o"&gt;&lt;/i&gt; Save&lt;/button&gt;<br>                &lt;?php } ?&gt;<br>            &lt;?php } ?&gt;<br>        &lt;/div&gt;<br>        &lt;?php<br>        if ($is_text &amp;&amp; $isNormalEditor) {<br>            echo '&lt;textarea id="normal-editor" rows="33" cols="120" style="width: 99.5%;"&gt;'. htmlspecialchars($content) .'&lt;/textarea&gt;';<br>        } elseif ($is_text) {<br>            echo '&lt;div id="editor" contenteditable="true"&gt;'. htmlspecialchars($content) .'&lt;/div&gt;';<br>        } else {<br>            fm_set_msg('FILE EXTENSION HAS NOT SUPPORTED', 'error');<br>        }<br>        ?&gt;<br>    &lt;/div&gt;<br>    &lt;?php<br>    fm_show_footer();<br>    exit;<br>}<br><br>// chmod (not for Windows)<br>if (isset($_GET['chmod']) &amp;&amp; !FM_READONLY &amp;&amp; !FM_IS_WIN) {<br>    $file = $_GET['chmod'];<br>    $file = fm_clean_path($file);<br>    $file = str_replace('/', '', $file);<br>    if ($file == '' || (!is_file($path . '/' . $file) &amp;&amp; !is_dir($path . '/' . $file))) {<br>        fm_set_msg('File not found', 'error');<br>        fm_redirect(FM_SELF_URL . '?p=' . urlencode(FM_PATH));<br>    }<br><br>    fm_show_header(); // HEADER<br>    fm_show_nav_path(FM_PATH); // current path<br><br>    $file_url = FM_ROOT_URL . (FM_PATH != '' ? '/' . FM_PATH : '') . '/' . $file;<br>    $file_path = $path . '/' . $file;<br><br>    $mode = fileperms($path . '/' . $file);<br><br>    ?&gt;<br>    &lt;div class="path"&gt;<br>        &lt;p&gt;&lt;b&gt;&lt;?php echo 'Change Permissions'; ?&gt;&lt;/b&gt;&lt;/p&gt;<br>        &lt;p&gt;<br>            &lt;?php echo 'Full path:'; ?&gt; &lt;?php echo $file_path ?&gt;&lt;br&gt;<br>        &lt;/p&gt;<br>        &lt;form action="" method="post"&gt;<br>            &lt;input type="hidden" name="p" value="&lt;?php echo fm_enc(FM_PATH) ?&gt;"&gt;<br>            &lt;input type="hidden" name="chmod" value="&lt;?php echo fm_enc($file) ?&gt;"&gt;<br><br>            &lt;table class="compact-table"&gt;<br>                &lt;tr&gt;<br>                    &lt;td&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;b&gt;Owner&lt;/b&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;b&gt;Group&lt;/b&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;b&gt;Other&lt;/b&gt;&lt;/td&gt;<br>                &lt;/tr&gt;<br>                &lt;tr&gt;<br>                    &lt;td style="text-align: right"&gt;&lt;b&gt;Read&lt;/b&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="ur" value="1"&lt;?php echo ($mode &amp; 00400) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="gr" value="1"&lt;?php echo ($mode &amp; 00040) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="or" value="1"&lt;?php echo ($mode &amp; 00004) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                &lt;/tr&gt;<br>                &lt;tr&gt;<br>                    &lt;td style="text-align: right"&gt;&lt;b&gt;Write&lt;/b&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="uw" value="1"&lt;?php echo ($mode &amp; 00200) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="gw" value="1"&lt;?php echo ($mode &amp; 00020) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="ow" value="1"&lt;?php echo ($mode &amp; 00002) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                &lt;/tr&gt;<br>                &lt;tr&gt;<br>                    &lt;td style="text-align: right"&gt;&lt;b&gt;Execute&lt;/b&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="ux" value="1"&lt;?php echo ($mode &amp; 00100) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="gx" value="1"&lt;?php echo ($mode &amp; 00010) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                    &lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="ox" value="1"&lt;?php echo ($mode &amp; 00001) ? ' checked' : '' ?&gt;&gt;&lt;/label&gt;&lt;/td&gt;<br>                &lt;/tr&gt;<br>            &lt;/table&gt;<br><br>            &lt;p&gt;<br>                &lt;button type="submit" class="btn"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; Change&lt;/button&gt; &amp;nbsp;<br>                &lt;b&gt;&lt;a href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;"&gt;&lt;i class="fa fa-times-circle"&gt;&lt;/i&gt; Cancel&lt;/a&gt;&lt;/b&gt;<br>            &lt;/p&gt;<br><br>        &lt;/form&gt;<br><br>    &lt;/div&gt;<br>    &lt;?php<br>    fm_show_footer();<br>    exit;<br>}<br><br>//--- FILEMANAGER MAIN<br>fm_show_header(); // HEADER<br>fm_show_nav_path(FM_PATH); // current path<br><br>// messages<br>fm_show_message();<br><br>$num_files = count($files);<br>$num_folders = count($folders);<br>$all_files_size = 0;<br>?&gt;<br>&lt;form action="" method="post"&gt;<br>&lt;input type="hidden" name="p" value="&lt;?php echo fm_enc(FM_PATH) ?&gt;"&gt;<br>&lt;input type="hidden" name="group" value="1"&gt;<br>&lt;?php if(FM_TREEVIEW) { ?&gt;<br>&lt;div class="file-tree-view" id="file-tree-view"&gt;<br>    &lt;div class="tree-title"&gt;Browse&lt;/div&gt;<br>&lt;?php<br>//file tre view<br>    echo php_file_tree($_SERVER['DOCUMENT_ROOT'], "javascript:alert('You clicked on [link]');");<br>?&gt;<br>&lt;/div&gt;<br>&lt;?php } ?&gt;<br>&lt;table class="table" id="main-table"&gt;&lt;thead&gt;&lt;tr&gt;<br>&lt;?php if (!FM_READONLY): ?&gt;&lt;th style="width:3%"&gt;&lt;label&gt;&lt;input type="checkbox" title="Invert selection" onclick="checkbox_toggle()"&gt;&lt;/label&gt;&lt;/th&gt;&lt;?php endif; ?&gt;<br>&lt;th&gt;Name&lt;/th&gt;&lt;th style="width:10%"&gt;Size&lt;/th&gt;<br>&lt;th style="width:12%"&gt;Modified&lt;/th&gt;<br>&lt;?php if (!FM_IS_WIN): ?&gt;&lt;th style="width:6%"&gt;Perms&lt;/th&gt;&lt;th style="width:10%"&gt;Owner&lt;/th&gt;&lt;?php endif; ?&gt;<br>&lt;th style="width:&lt;?php if (!FM_READONLY): ?&gt;13&lt;?php else: ?&gt;6.5&lt;?php endif; ?&gt;%"&gt;Actions&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;<br>&lt;?php<br>// link to parent folder<br>if ($parent !== false) {<br>    ?&gt;<br>&lt;tr&gt;&lt;?php if (!FM_READONLY): ?&gt;&lt;td&gt;&lt;/td&gt;&lt;?php endif; ?&gt;&lt;td colspan="&lt;?php echo !FM_IS_WIN ? '6' : '4' ?&gt;"&gt;&lt;a href="?p=&lt;?php echo urlencode($parent) ?&gt;"&gt;&lt;i class="fa fa-chevron-circle-left"&gt;&lt;/i&gt; ..&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;<br>&lt;?php<br>}<br>foreach ($folders as $f) {<br>    $is_link = is_link($path . '/' . $f);<br>    $img = $is_link ? 'icon-link_folder' : 'fa fa-folder-o';<br>    $modif = date(FM_DATETIME_FORMAT, filemtime($path . '/' . $f));<br>    $perms = substr(decoct(fileperms($path . '/' . $f)), -4);<br>    if (function_exists('posix_getpwuid') &amp;&amp; function_exists('posix_getgrgid')) {<br>        $owner = posix_getpwuid(fileowner($path . '/' . $f));<br>        $group = posix_getgrgid(filegroup($path . '/' . $f));<br>    } else {<br>        $owner = array('name' =&gt; '?');<br>        $group = array('name' =&gt; '?');<br>    }<br>    ?&gt;<br>&lt;tr&gt;<br>&lt;?php if (!FM_READONLY): ?&gt;&lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="file[]" value="&lt;?php echo fm_enc($f) ?&gt;"&gt;&lt;/label&gt;&lt;/td&gt;&lt;?php endif; ?&gt;<br>&lt;td&gt;&lt;div class="filename"&gt;&lt;a href="?p=&lt;?php echo urlencode(trim(FM_PATH . '/' . $f, '/')) ?&gt;"&gt;&lt;i class="&lt;?php echo $img ?&gt;"&gt;&lt;/i&gt; &lt;?php echo fm_convert_win($f) ?&gt;&lt;/a&gt;&lt;?php echo ($is_link ? ' &amp;rarr; &lt;i&gt;' . readlink($path . '/' . $f) . '&lt;/i&gt;' : '') ?&gt;&lt;/div&gt;&lt;/td&gt;<br>&lt;td&gt;Folder&lt;/td&gt;&lt;td&gt;&lt;?php echo $modif ?&gt;&lt;/td&gt;<br>&lt;?php if (!FM_IS_WIN): ?&gt;<br>&lt;td&gt;&lt;?php if (!FM_READONLY): ?&gt;&lt;a title="Change Permissions" href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;chmod=&lt;?php echo urlencode($f) ?&gt;"&gt;&lt;?php echo $perms ?&gt;&lt;/a&gt;&lt;?php else: ?&gt;&lt;?php echo $perms ?&gt;&lt;?php endif; ?&gt;&lt;/td&gt;<br>&lt;td&gt;&lt;?php echo $owner['name'] . ':' . $group['name'] ?&gt;&lt;/td&gt;<br>&lt;?php endif; ?&gt;<br>&lt;td class="inline-actions"&gt;&lt;?php if (!FM_READONLY): ?&gt;<br>&lt;a title="Delete" href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;del=&lt;?php echo urlencode($f) ?&gt;" onclick="return confirm('Delete folder?');"&gt;&lt;i class="fa fa-trash-o" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;a title="Rename" href="#" onclick="rename('&lt;?php echo fm_enc(FM_PATH) ?&gt;', '&lt;?php echo fm_enc($f) ?&gt;');return false;"&gt;&lt;i class="fa fa-pencil-square-o" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;a title="Copy to..." href="?p=&amp;amp;copy=&lt;?php echo urlencode(trim(FM_PATH . '/' . $f, '/')) ?&gt;"&gt;&lt;i class="fa fa-files-o" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;?php endif; ?&gt;<br>&lt;a title="Direct link" href="&lt;?php echo fm_enc(FM_ROOT_URL . (FM_PATH != '' ? '/' . FM_PATH : '') . '/' . $f . '/') ?&gt;" target="_blank"&gt;&lt;i class="fa fa-link" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;/td&gt;&lt;/tr&gt;<br>    &lt;?php<br>    flush();<br>}<br><br>foreach ($files as $f) {<br>    $is_link = is_link($path . '/' . $f);<br>    $img = $is_link ? 'fa fa-file-text-o' : fm_get_file_icon_class($path . '/' . $f);<br>    $modif = date(FM_DATETIME_FORMAT, filemtime($path . '/' . $f));<br>    $filesize_raw = filesize($path . '/' . $f);<br>    $filesize = fm_get_filesize($filesize_raw);<br>    $filelink = '?p=' . urlencode(FM_PATH) . '&amp;amp;view=' . urlencode($f);<br>    $all_files_size += $filesize_raw;<br>    $perms = substr(decoct(fileperms($path . '/' . $f)), -4);<br>    if (function_exists('posix_getpwuid') &amp;&amp; function_exists('posix_getgrgid')) {<br>        $owner = posix_getpwuid(fileowner($path . '/' . $f));<br>        $group = posix_getgrgid(filegroup($path . '/' . $f));<br>    } else {<br>        $owner = array('name' =&gt; '?');<br>        $group = array('name' =&gt; '?');<br>    }<br>    ?&gt;<br>&lt;tr&gt;<br>&lt;?php if (!FM_READONLY): ?&gt;&lt;td&gt;&lt;label&gt;&lt;input type="checkbox" name="file[]" value="&lt;?php echo fm_enc($f) ?&gt;"&gt;&lt;/label&gt;&lt;/td&gt;&lt;?php endif; ?&gt;<br>&lt;td&gt;&lt;div class="filename"&gt;&lt;a href="&lt;?php echo $filelink ?&gt;" title="File info"&gt;&lt;i class="&lt;?php echo $img ?&gt;"&gt;&lt;/i&gt; &lt;?php echo fm_convert_win($f) ?&gt;&lt;/a&gt;&lt;?php echo ($is_link ? ' &amp;rarr; &lt;i&gt;' . readlink($path . '/' . $f) . '&lt;/i&gt;' : '') ?&gt;&lt;/div&gt;&lt;/td&gt;<br>&lt;td&gt;&lt;span title="&lt;?php printf('%s bytes', $filesize_raw) ?&gt;"&gt;&lt;?php echo $filesize ?&gt;&lt;/span&gt;&lt;/td&gt;<br>&lt;td&gt;&lt;?php echo $modif ?&gt;&lt;/td&gt;<br>&lt;?php if (!FM_IS_WIN): ?&gt;<br>&lt;td&gt;&lt;?php if (!FM_READONLY): ?&gt;&lt;a title="&lt;?php echo 'Change Permissions' ?&gt;" href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;chmod=&lt;?php echo urlencode($f) ?&gt;"&gt;&lt;?php echo $perms ?&gt;&lt;/a&gt;&lt;?php else: ?&gt;&lt;?php echo $perms ?&gt;&lt;?php endif; ?&gt;&lt;/td&gt;<br>&lt;td&gt;&lt;?php echo fm_enc($owner['name'] . ':' . $group['name']) ?&gt;&lt;/td&gt;<br>&lt;?php endif; ?&gt;<br>&lt;td class="inline-actions"&gt;<br>&lt;?php if (!FM_READONLY): ?&gt;<br>&lt;a title="Delete" href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;del=&lt;?php echo urlencode($f) ?&gt;" onclick="return confirm('Delete file?');"&gt;&lt;i class="fa fa-trash-o"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;a title="Rename" href="#" onclick="rename('&lt;?php echo fm_enc(FM_PATH) ?&gt;', '&lt;?php echo fm_enc($f) ?&gt;');return false;"&gt;&lt;i class="fa fa-pencil-square-o"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;a title="Copy to..." href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;copy=&lt;?php echo urlencode(trim(FM_PATH . '/' . $f, '/')) ?&gt;"&gt;&lt;i class="fa fa-files-o"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;?php endif; ?&gt;<br>&lt;a title="Direct link" href="&lt;?php echo fm_enc(FM_ROOT_URL . (FM_PATH != '' ? '/' . FM_PATH : '') . '/' . $f) ?&gt;" target="_blank"&gt;&lt;i class="fa fa-link"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;a title="Download" href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;dl=&lt;?php echo urlencode($f) ?&gt;"&gt;&lt;i class="fa fa-download"&gt;&lt;/i&gt;&lt;/a&gt;<br>&lt;/td&gt;&lt;/tr&gt;<br>    &lt;?php<br>    flush();<br>}<br><br>if (empty($folders) &amp;&amp; empty($files)) {<br>    ?&gt;<br>&lt;tr&gt;&lt;?php if (!FM_READONLY): ?&gt;&lt;td&gt;&lt;/td&gt;&lt;?php endif; ?&gt;&lt;td colspan="&lt;?php echo !FM_IS_WIN ? '6' : '4' ?&gt;"&gt;&lt;em&gt;&lt;?php echo 'Folder is empty' ?&gt;&lt;/em&gt;&lt;/td&gt;&lt;/tr&gt;<br>&lt;?php<br>} else {<br>    ?&gt;<br>&lt;tr&gt;&lt;?php if (!FM_READONLY): ?&gt;&lt;td class="gray"&gt;&lt;/td&gt;&lt;?php endif; ?&gt;&lt;td class="gray" colspan="&lt;?php echo !FM_IS_WIN ? '6' : '4' ?&gt;"&gt;<br>Full size: &lt;span title="&lt;?php printf('%s bytes', $all_files_size) ?&gt;"&gt;&lt;?php echo fm_get_filesize($all_files_size) ?&gt;&lt;/span&gt;,<br>files: &lt;?php echo $num_files ?&gt;,<br>folders: &lt;?php echo $num_folders ?&gt;<br>&lt;/td&gt;&lt;/tr&gt;<br>&lt;?php<br>}<br>?&gt;<br>&lt;/table&gt;<br>&lt;?php if (!FM_READONLY): ?&gt;<br>&lt;p class="path footer-links"&gt;&lt;a href="#/select-all" class="group-btn" onclick="select_all();return false;"&gt;&lt;i class="fa fa-check-square"&gt;&lt;/i&gt; Select all&lt;/a&gt; &amp;nbsp;<br>&lt;a href="#/unselect-all" class="group-btn" onclick="unselect_all();return false;"&gt;&lt;i class="fa fa-window-close"&gt;&lt;/i&gt; Unselect all&lt;/a&gt; &amp;nbsp;<br>&lt;a href="#/invert-all" class="group-btn" onclick="invert_all();return false;"&gt;&lt;i class="fa fa-th-list"&gt;&lt;/i&gt; Invert selection&lt;/a&gt; &amp;nbsp;<br>&lt;input type="submit" class="hidden" name="delete" id="a-delete" value="Delete" onclick="return confirm('Delete selected files and folders?')"&gt;<br>&lt;a href="javascript:document.getElementById('a-delete').click();" class="group-btn"&gt;&lt;i class="fa fa-trash"&gt;&lt;/i&gt; Delete &lt;/a&gt; &amp;nbsp;<br>&lt;input type="submit" class="hidden" name="zip" id="a-zip" value="Zip" onclick="return confirm('Create archive?')"&gt;<br>&lt;a href="javascript:document.getElementById('a-zip').click();" class="group-btn"&gt;&lt;i class="fa fa-file-archive-o"&gt;&lt;/i&gt; Zip &lt;/a&gt; &amp;nbsp;<br>&lt;input type="submit" class="hidden" name="copy" id="a-copy" value="Copy"&gt;<br>&lt;a href="javascript:document.getElementById('a-copy').click();" class="group-btn"&gt;&lt;i class="fa fa-files-o"&gt;&lt;/i&gt; Copy &lt;/a&gt;<br>&lt;a href="https://github.com/prasathmani/tinyfilemanager" target="_blank" class="float-right" style="color:silver"&gt;H3K | Tiny File Manager&lt;/a&gt;&lt;/p&gt;<br>&lt;?php endif; ?&gt;<br>&lt;/form&gt;<br><br>&lt;?php<br>fm_show_footer();<br><br>//--- END<br><br>// Functions<br><br>/**<br> * Delete  file or folder (recursively)<br> * @param string $path<br> * @return bool<br> */<br>function fm_rdelete($path)<br>{<br>    if (is_link($path)) {<br>        return unlink($path);<br>    } elseif (is_dir($path)) {<br>        $objects = scandir($path);<br>        $ok = true;<br>        if (is_array($objects)) {<br>            foreach ($objects as $file) {<br>                if ($file != '.' &amp;&amp; $file != '..') {<br>                    if (!fm_rdelete($path . '/' . $file)) {<br>                        $ok = false;<br>                    }<br>                }<br>            }<br>        }<br>        return ($ok) ? rmdir($path) : false;<br>    } elseif (is_file($path)) {<br>        return unlink($path);<br>    }<br>    return false;<br>}<br><br>/**<br> * Recursive chmod<br> * @param string $path<br> * @param int $filemode<br> * @param int $dirmode<br> * @return bool<br> * @todo Will use in mass chmod<br> */<br>function fm_rchmod($path, $filemode, $dirmode)<br>{<br>    if (is_dir($path)) {<br>        if (!chmod($path, $dirmode)) {<br>            return false;<br>        }<br>        $objects = scandir($path);<br>        if (is_array($objects)) {<br>            foreach ($objects as $file) {<br>                if ($file != '.' &amp;&amp; $file != '..') {<br>                    if (!fm_rchmod($path . '/' . $file, $filemode, $dirmode)) {<br>                        return false;<br>                    }<br>                }<br>            }<br>        }<br>        return true;<br>    } elseif (is_link($path)) {<br>        return true;<br>    } elseif (is_file($path)) {<br>        return chmod($path, $filemode);<br>    }<br>    return false;<br>}<br><br>/**<br> * Safely rename<br> * @param string $old<br> * @param string $new<br> * @return bool|null<br> */<br>function fm_rename($old, $new)<br>{<br>    return (!file_exists($new) &amp;&amp; file_exists($old)) ? rename($old, $new) : null;<br>}<br><br>/**<br> * Copy file or folder (recursively).<br> * @param string $path<br> * @param string $dest<br> * @param bool $upd Update files<br> * @param bool $force Create folder with same names instead file<br> * @return bool<br> */<br>function fm_rcopy($path, $dest, $upd = true, $force = true)<br>{<br>    if (is_dir($path)) {<br>        if (!fm_mkdir($dest, $force)) {<br>            return false;<br>        }<br>        $objects = scandir($path);<br>        $ok = true;<br>        if (is_array($objects)) {<br>            foreach ($objects as $file) {<br>                if ($file != '.' &amp;&amp; $file != '..') {<br>                    if (!fm_rcopy($path . '/' . $file, $dest . '/' . $file)) {<br>                        $ok = false;<br>                    }<br>                }<br>            }<br>        }<br>        return $ok;<br>    } elseif (is_file($path)) {<br>        return fm_copy($path, $dest, $upd);<br>    }<br>    return false;<br>}<br><br>/**<br> * Safely create folder<br> * @param string $dir<br> * @param bool $force<br> * @return bool<br> */<br>function fm_mkdir($dir, $force)<br>{<br>    if (file_exists($dir)) {<br>        if (is_dir($dir)) {<br>            return $dir;<br>        } elseif (!$force) {<br>            return false;<br>        }<br>        unlink($dir);<br>    }<br>    return mkdir($dir, 0777, true);<br>}<br><br>/**<br> * Safely copy file<br> * @param string $f1<br> * @param string $f2<br> * @param bool $upd<br> * @return bool<br> */<br>function fm_copy($f1, $f2, $upd)<br>{<br>    $time1 = filemtime($f1);<br>    if (file_exists($f2)) {<br>        $time2 = filemtime($f2);<br>        if ($time2 &gt;= $time1 &amp;&amp; $upd) {<br>            return false;<br>        }<br>    }<br>    $ok = copy($f1, $f2);<br>    if ($ok) {<br>        touch($f2, $time1);<br>    }<br>    return $ok;<br>}<br><br>/**<br> * Get mime type<br> * @param string $file_path<br> * @return mixed|string<br> */<br>function fm_get_mime_type($file_path)<br>{<br>    if (function_exists('finfo_open')) {<br>        $finfo = finfo_open(FILEINFO_MIME_TYPE);<br>        $mime = finfo_file($finfo, $file_path);<br>        finfo_close($finfo);<br>        return $mime;<br>    } elseif (function_exists('mime_content_type')) {<br>        return mime_content_type($file_path);<br>    } elseif (!stristr(ini_get('disable_functions'), 'shell_exec')) {<br>        $file = escapeshellarg($file_path);<br>        $mime = shell_exec('file -bi ' . $file);<br>        return $mime;<br>    } else {<br>        return '--';<br>    }<br>}<br><br>/**<br> * HTTP Redirect<br> * @param string $url<br> * @param int $code<br> */<br>function fm_redirect($url, $code = 302)<br>{<br>    header('Location: ' . $url, true, $code);<br>    exit;<br>}<br><br>/**<br> * Clean path<br> * @param string $path<br> * @return string<br> */<br>function fm_clean_path($path)<br>{<br>    $path = trim($path);<br>    $path = trim($path, '\\/');<br>    $path = str_replace(array('../', '..\\'), '', $path);<br>    if ($path == '..') {<br>        $path = '';<br>    }<br>    return str_replace('\\', '/', $path);<br>}<br><br>/**<br> * Get parent path<br> * @param string $path<br> * @return bool|string<br> */<br>function fm_get_parent_path($path)<br>{<br>    $path = fm_clean_path($path);<br>    if ($path != '') {<br>        $array = explode('/', $path);<br>        if (count($array) &gt; 1) {<br>            $array = array_slice($array, 0, -1);<br>            return implode('/', $array);<br>        }<br>        return '';<br>    }<br>    return false;<br>}<br><br>/**<br> * Get nice filesize<br> * @param int $size<br> * @return string<br> */<br>function fm_get_filesize($size)<br>{<br>    if ($size &lt; 1000) {<br>        return sprintf('%s B', $size);<br>    } elseif (($size / 1024) &lt; 1000) {<br>        return sprintf('%s KiB', round(($size / 1024), 2));<br>    } elseif (($size / 1024 / 1024) &lt; 1000) {<br>        return sprintf('%s MiB', round(($size / 1024 / 1024), 2));<br>    } elseif (($size / 1024 / 1024 / 1024) &lt; 1000) {<br>        return sprintf('%s GiB', round(($size / 1024 / 1024 / 1024), 2));<br>    } else {<br>        return sprintf('%s TiB', round(($size / 1024 / 1024 / 1024 / 1024), 2));<br>    }<br>}<br><br>/**<br> * Get info about zip archive<br> * @param string $path<br> * @return array|bool<br> */<br>function fm_get_zif_info($path)<br>{<br>    if (function_exists('zip_open')) {<br>        $arch = zip_open($path);<br>        if ($arch) {<br>            $filenames = array();<br>            while ($zip_entry = zip_read($arch)) {<br>                $zip_name = zip_entry_name($zip_entry);<br>                $zip_folder = substr($zip_name, -1) == '/';<br>                $filenames[] = array(<br>                    'name' =&gt; $zip_name,<br>                    'filesize' =&gt; zip_entry_filesize($zip_entry),<br>                    'compressed_size' =&gt; zip_entry_compressedsize($zip_entry),<br>                    'folder' =&gt; $zip_folder<br>                    //'compression_method' =&gt; zip_entry_compressionmethod($zip_entry),<br>                );<br>            }<br>            zip_close($arch);<br>            return $filenames;<br>        }<br>    }<br>    return false;<br>}<br><br>/**<br> * Encode html entities<br> * @param string $text<br> * @return string<br> */<br>function fm_enc($text)<br>{<br>    return htmlspecialchars($text, ENT_QUOTES, 'UTF-8');<br>}<br><br>/**<br> * This function scans the files folder recursively, and builds a large array<br> * @param string $dir<br> * @return json<br> */<br>function scan($dir){<br>    $files = array();<br>    $_dir = $dir;<br>    $dir = FM_ROOT_PATH.'/'.$dir;<br>    // Is there actually such a folder/file?<br>    if(file_exists($dir)){<br>        foreach(scandir($dir) as $f) {<br>            if(!$f || $f[0] == '.') {<br>                continue; // Ignore hidden files<br>            }<br><br>            if(is_dir($dir . '/' . $f)) {<br>                // The path is a folder<br>                $files[] = array(<br>                    "name" =&gt; $f,<br>                    "type" =&gt; "folder",<br>                    "path" =&gt; $_dir.'/'.$f,<br>                    "items" =&gt; scan($dir . '/' . $f), // Recursively get the contents of the folder<br>                );<br>            } else {<br>                // It is a file<br>                $files[] = array(<br>                    "name" =&gt; $f,<br>                    "type" =&gt; "file",<br>                    "path" =&gt; $_dir,<br>                    "size" =&gt; filesize($dir . '/' . $f) // Gets the size of this file<br>                );<br>            }<br>        }<br>    }<br>    return $files;<br>}<br><br>/**<br>* Scan directory and return tree view<br>* @param string $directory<br>* @param boolean $first_call<br>*/<br>function php_file_tree_dir($directory, $first_call = true) {<br> // Recursive function called by php_file_tree() to list directories/files<br><br> $php_file_tree = "";<br> // Get and sort directories/files<br> if( function_exists("scandir") ) $file = scandir($directory);<br> natcasesort($file);<br> // Make directories first<br> $files = $dirs = array();<br> foreach($file as $this_file) {<br>  if( is_dir("$directory/$this_file" ) ) {<br>      if(!in_array($this_file, $GLOBALS['exclude_folders'])){<br>          $dirs[] = $this_file;<br>      }<br>    } else {<br>      $files[] = $this_file;<br>    }<br> }<br> $file = array_merge($dirs, $files);<br><br> if( count($file) &gt; 2 ) { // Use 2 instead of 0 to account for . and .. "directories"<br>  $php_file_tree = "&lt;ul";<br>  if( $first_call ) { $php_file_tree .= " class=\"php-file-tree\""; $first_call = false; }<br>  $php_file_tree .= "&gt;";<br>  foreach( $file as $this_file ) {<br>   if( $this_file != "." &amp;&amp; $this_file != ".." ) {<br>    if( is_dir("$directory/$this_file") ) {<br>     // Directory<br>     $php_file_tree .= "&lt;li class=\"pft-directory\"&gt;&lt;i class=\"fa fa-folder-o\"&gt;&lt;/i&gt;&lt;a href=\"#\"&gt;" . htmlspecialchars($this_file) . "&lt;/a&gt;";<br>     $php_file_tree .= php_file_tree_dir("$directory/$this_file", false);<br>     $php_file_tree .= "&lt;/li&gt;";<br>    } else {<br>     // File<br>                    $ext = fm_get_file_icon_class($this_file);<br>                    $path = str_replace($_SERVER['DOCUMENT_ROOT'],"",$directory);<br>     $link = "?p="."$path" ."&amp;view=".urlencode($this_file);<br>     $php_file_tree .= "&lt;li class=\"pft-file\"&gt;&lt;a href=\"$link\"&gt; &lt;i class=\"$ext\"&gt;&lt;/i&gt;" . htmlspecialchars($this_file) . "&lt;/a&gt;&lt;/li&gt;";<br>    }<br>   }<br>  }<br>  $php_file_tree .= "&lt;/ul&gt;";<br> }<br> return $php_file_tree;<br>}<br><br>/**<br> * Scan directory and render tree view<br> * @param string $directory<br> */<br>function php_file_tree($directory) {<br>    // Remove trailing slash<br>    $code = "";<br>    if( substr($directory, -1) == "/" ) $directory = substr($directory, 0, strlen($directory) - 1);<br>    if(function_exists('php_file_tree_dir')) {<br>        $code .= php_file_tree_dir($directory);<br>        return $code;<br>    }<br>}<br><br>/**<br> * Save message in session<br> * @param string $msg<br> * @param string $status<br> */<br>function fm_set_msg($msg, $status = 'ok')<br>{<br>    $_SESSION['message'] = $msg;<br>    $_SESSION['status'] = $status;<br>}<br><br>/**<br> * Check if string is in UTF-8<br> * @param string $string<br> * @return int<br> */<br>function fm_is_utf8($string)<br>{<br>    return preg_match('//u', $string);<br>}<br><br>/**<br> * Convert file name to UTF-8 in Windows<br> * @param string $filename<br> * @return string<br> */<br>function fm_convert_win($filename)<br>{<br>    if (FM_IS_WIN &amp;&amp; function_exists('iconv')) {<br>        $filename = iconv(FM_ICONV_INPUT_ENC, 'UTF-8//IGNORE', $filename);<br>    }<br>    return $filename;<br>}<br><br>/**<br> * Get CSS classname for file<br> * @param string $path<br> * @return string<br> */<br>function fm_get_file_icon_class($path)<br>{<br>    // get extension<br>    $ext = strtolower(pathinfo($path, PATHINFO_EXTENSION));<br><br>    switch ($ext) {<br>        case 'ico': case 'gif': case 'jpg': case 'jpeg': case 'jpc': case 'jp2':<br>        case 'jpx': case 'xbm': case 'wbmp': case 'png': case 'bmp': case 'tif':<br>        case 'tiff': case 'svg':<br>            $img = 'fa fa-picture-o';<br>            break;<br>        case 'passwd': case 'ftpquota': case 'sql': case 'js': case 'json': case 'sh':<br>        case 'config': case 'twig': case 'tpl': case 'md': case 'gitignore':<br>        case 'c': case 'cpp': case 'cs': case 'py': case 'map': case 'lock': case 'dtd':<br>            $img = 'fa fa-file-code-o';<br>            break;<br>        case 'txt': case 'ini': case 'conf': case 'log': case 'htaccess':<br>            $img = 'fa fa-file-text-o';<br>            break;<br>        case 'css': case 'less': case 'sass': case 'scss':<br>            $img = 'fa fa-css3';<br>            break;<br>        case 'zip': case 'rar': case 'gz': case 'tar': case '7z':<br>            $img = 'fa fa-file-archive-o';<br>            break;<br>        case 'php': case 'php4': case 'php5': case 'phps': case 'phtml':<br>            $img = 'fa fa-code';<br>            break;<br>        case 'htm': case 'html': case 'shtml': case 'xhtml':<br>            $img = 'fa fa-html5';<br>            break;<br>        case 'xml': case 'xsl':<br>            $img = 'fa fa-file-excel-o';<br>            break;<br>        case 'wav': case 'mp3': case 'mp2': case 'm4a': case 'aac': case 'ogg':<br>        case 'oga': case 'wma': case 'mka': case 'flac': case 'ac3': case 'tds':<br>            $img = 'fa fa-music';<br>            break;<br>        case 'm3u': case 'm3u8': case 'pls': case 'cue':<br>            $img = 'fa fa-headphones';<br>            break;<br>        case 'avi': case 'mpg': case 'mpeg': case 'mp4': case 'm4v': case 'flv':<br>        case 'f4v': case 'ogm': case 'ogv': case 'mov': case 'mkv': case '3gp':<br>        case 'asf': case 'wmv':<br>            $img = 'fa fa-file-video-o';<br>            break;<br>        case 'eml': case 'msg':<br>            $img = 'fa fa-envelope-o';<br>            break;<br>        case 'xls': case 'xlsx':<br>            $img = 'fa fa-file-excel-o';<br>            break;<br>        case 'csv':<br>            $img = 'fa fa-file-text-o';<br>            break;<br>        case 'bak':<br>            $img = 'fa fa-clipboard';<br>            break;<br>        case 'doc': case 'docx':<br>            $img = 'fa fa-file-word-o';<br>            break;<br>        case 'ppt': case 'pptx':<br>            $img = 'fa fa-file-powerpoint-o';<br>            break;<br>        case 'ttf': case 'ttc': case 'otf': case 'woff':case 'woff2': case 'eot': case 'fon':<br>            $img = 'fa fa-font';<br>            break;<br>        case 'pdf':<br>            $img = 'fa fa-file-pdf-o';<br>            break;<br>        case 'psd': case 'ai': case 'eps': case 'fla': case 'swf':<br>            $img = 'fa fa-file-image-o';<br>            break;<br>        case 'exe': case 'msi':<br>            $img = 'fa fa-file-o';<br>            break;<br>        case 'bat':<br>            $img = 'fa fa-terminal';<br>            break;<br>        default:<br>            $img = 'fa fa-info-circle';<br>    }<br><br>    return $img;<br>}<br><br>/**<br> * Get image files extensions<br> * @return array<br> */<br>function fm_get_image_exts()<br>{<br>    return array('ico', 'gif', 'jpg', 'jpeg', 'jpc', 'jp2', 'jpx', 'xbm', 'wbmp', 'png', 'bmp', 'tif', 'tiff', 'psd');<br>}<br><br>/**<br> * Get video files extensions<br> * @return array<br> */<br>function fm_get_video_exts()<br>{<br>    return array('webm', 'mp4', 'm4v', 'ogm', 'ogv', 'mov');<br>}<br><br>/**<br> * Get audio files extensions<br> * @return array<br> */<br>function fm_get_audio_exts()<br>{<br>    return array('wav', 'mp3', 'ogg', 'm4a');<br>}<br><br>/**<br> * Get text file extensions<br> * @return array<br> */<br>function fm_get_text_exts()<br>{<br>    return array(<br>        'txt', 'css', 'ini', 'conf', 'log', 'htaccess', 'passwd', 'ftpquota', 'sql', 'js', 'json', 'sh', 'config',<br>        'php', 'php4', 'php5', 'phps', 'phtml', 'htm', 'html', 'shtml', 'xhtml', 'xml', 'xsl', 'm3u', 'm3u8', 'pls', 'cue',<br>        'eml', 'msg', 'csv', 'bat', 'twig', 'tpl', 'md', 'gitignore', 'less', 'sass', 'scss', 'c', 'cpp', 'cs', 'py',<br>        'map', 'lock', 'dtd', 'svg',<br>    );<br>}<br><br>/**<br> * Get mime types of text files<br> * @return array<br> */<br>function fm_get_text_mimes()<br>{<br>    return array(<br>        'application/xml',<br>        'application/javascript',<br>        'application/x-javascript',<br>        'image/svg+xml',<br>        'message/rfc822',<br>    );<br>}<br><br>/**<br> * Get file names of text files w/o extensions<br> * @return array<br> */<br>function fm_get_text_names()<br>{<br>    return array(<br>        'license',<br>        'readme',<br>        'authors',<br>        'contributors',<br>        'changelog',<br>    );<br>}<br><br>/**<br> * Class to work with zip files (using ZipArchive)<br> */<br>class FM_Zipper<br>{<br>    private $zip;<br><br>    public function __construct()<br>    {<br>        $this-&gt;zip = new ZipArchive();<br>    }<br><br>    /**<br>     * Create archive with name $filename and files $files (RELATIVE PATHS!)<br>     * @param string $filename<br>     * @param array|string $files<br>     * @return bool<br>     */<br>    public function create($filename, $files)<br>    {<br>        $res = $this-&gt;zip-&gt;open($filename, ZipArchive::CREATE);<br>        if ($res !== true) {<br>            return false;<br>        }<br>        if (is_array($files)) {<br>            foreach ($files as $f) {<br>                if (!$this-&gt;addFileOrDir($f)) {<br>                    $this-&gt;zip-&gt;close();<br>                    return false;<br>                }<br>            }<br>            $this-&gt;zip-&gt;close();<br>            return true;<br>        } else {<br>            if ($this-&gt;addFileOrDir($files)) {<br>                $this-&gt;zip-&gt;close();<br>                return true;<br>            }<br>            return false;<br>        }<br>    }<br><br>    /**<br>     * Extract archive $filename to folder $path (RELATIVE OR ABSOLUTE PATHS)<br>     * @param string $filename<br>     * @param string $path<br>     * @return bool<br>     */<br>    public function unzip($filename, $path)<br>    {<br>        $res = $this-&gt;zip-&gt;open($filename);<br>        if ($res !== true) {<br>            return false;<br>        }<br>        if ($this-&gt;zip-&gt;extractTo($path)) {<br>            $this-&gt;zip-&gt;close();<br>            return true;<br>        }<br>        return false;<br>    }<br><br>    /**<br>     * Add file/folder to archive<br>     * @param string $filename<br>     * @return bool<br>     */<br>    private function addFileOrDir($filename)<br>    {<br>        if (is_file($filename)) {<br>            return $this-&gt;zip-&gt;addFile($filename);<br>        } elseif (is_dir($filename)) {<br>            return $this-&gt;addDir($filename);<br>        }<br>        return false;<br>    }<br><br>    /**<br>     * Add folder recursively<br>     * @param string $path<br>     * @return bool<br>     */<br>    private function addDir($path)<br>    {<br>        if (!$this-&gt;zip-&gt;addEmptyDir($path)) {<br>            return false;<br>        }<br>        $objects = scandir($path);<br>        if (is_array($objects)) {<br>            foreach ($objects as $file) {<br>                if ($file != '.' &amp;&amp; $file != '..') {<br>                    if (is_dir($path . '/' . $file)) {<br>                        if (!$this-&gt;addDir($path . '/' . $file)) {<br>                            return false;<br>                        }<br>                    } elseif (is_file($path . '/' . $file)) {<br>                        if (!$this-&gt;zip-&gt;addFile($path . '/' . $file)) {<br>                            return false;<br>                        }<br>                    }<br>                }<br>            }<br>            return true;<br>        }<br>        return false;<br>    }<br>}<br><br>//--- templates functions<br><br>/**<br> * Show nav block<br> * @param string $path<br> */<br>function fm_show_nav_path($path)<br>{<br>    global $lang;<br>    ?&gt;<br>&lt;div class="path main-nav"&gt;<br><br>        &lt;?php<br>        $path = fm_clean_path($path);<br>        $root_url = "&lt;a href='?p='&gt;&lt;i class='fa fa-home' aria-hidden='true' title='" . FM_ROOT_PATH . "'&gt;&lt;/i&gt;&lt;/a&gt;";<br>        $sep = '&lt;i class="fa fa-caret-right"&gt;&lt;/i&gt;';<br>        if ($path != '') {<br>            $exploded = explode('/', $path);<br>            $count = count($exploded);<br>            $array = array();<br>            $parent = '';<br>            for ($i = 0; $i &lt; $count; $i++) {<br>                $parent = trim($parent . '/' . $exploded[$i], '/');<br>                $parent_enc = urlencode($parent);<br>                $array[] = "&lt;a href='?p={$parent_enc}'&gt;" . fm_enc(fm_convert_win($exploded[$i])) . "&lt;/a&gt;";<br>            }<br>            $root_url .= $sep . implode($sep, $array);<br>        }<br>        echo '&lt;div class="break-word float-left"&gt;' . $root_url . '&lt;/div&gt;';<br>        ?&gt;<br><br>        &lt;div class="float-right"&gt;<br>        &lt;?php if (!FM_READONLY): ?&gt;<br>        &lt;a title="Search" href="javascript:showSearch('&lt;?php echo urlencode(FM_PATH) ?&gt;')"&gt;&lt;i class="fa fa-search"&gt;&lt;/i&gt;&lt;/a&gt;<br>        &lt;a title="Upload files" href="?p=&lt;?php echo urlencode(FM_PATH) ?&gt;&amp;amp;upload"&gt;&lt;i class="fa fa-cloud-upload" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt;<br>        &lt;a title="New folder" href="#createNewItem" &gt;&lt;i class="fa fa-plus-square"&gt;&lt;/i&gt;&lt;/a&gt;<br>        &lt;?php endif; ?&gt;<br>        &lt;?php if (FM_USE_AUTH): ?&gt;&lt;a title="Logout" href="?logout=1"&gt;&lt;i class="fa fa-sign-out" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt;&lt;?php endif; ?&gt;<br>        &lt;/div&gt;<br>&lt;/div&gt;<br>&lt;?php<br>}<br><br>/**<br> * Show message from session<br> */<br>function fm_show_message()<br>{<br>    if (isset($_SESSION['message'])) {<br>        $class = isset($_SESSION['status']) ? $_SESSION['status'] : 'ok';<br>        echo '&lt;p class="message ' . $class . '"&gt;' . $_SESSION['message'] . '&lt;/p&gt;';<br>        unset($_SESSION['message']);<br>        unset($_SESSION['status']);<br>    }<br>}<br><br>/**<br> * Show page header in Login Form<br> */<br>function fm_show_header_login()<br>{<br>    $sprites_ver = '20160315';<br>    header("Content-Type: text/html; charset=utf-8");<br>    header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");<br>    header("Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0");<br>    header("Pragma: no-cache");<br><br>    global $lang;<br>    ?&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta charset="utf-8"&gt;<br>&lt;title&gt;H3K | File Manager&lt;/title&gt;<br>&lt;meta name="Description" CONTENT="Author: CCP Programmers, H3K Tiny PHP File Manager"&gt;<br>&lt;link rel="icon" href="&lt;?php echo FM_SELF_URL ?&gt;?img=favicon" type="image/png"&gt;<br>&lt;link rel="shortcut icon" href="&lt;?php echo FM_SELF_URL ?&gt;?img=favicon" type="image/png"&gt;<br>&lt;link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"&gt;<br>&lt;style&gt;<br>a img,img{border:none}.filename,td,th{white-space:nowrap}.close,.close:focus,.close:hover,.php-file-tree a,a{text-decoration:none}a,body,code,div,em,form,html,img,label,li,ol,p,pre,small,span,strong,table,td,th,tr,ul{margin:0;padding:0;vertical-align:baseline;outline:0;font-size:100%;background:0 0;border:none;text-decoration:none}p,table,ul{margin-bottom:10px}html{overflow-y:scroll}body{padding:0;font:13px/16px Tahoma,Arial,sans-serif;color:#222;background:#F7F7F7;margin:50px 30px 0}button,input,select,textarea{font-size:inherit;font-family:inherit}a{color:#296ea3}a:hover{color:#b00}img{vertical-align:middle}span{color:#777}small{font-size:11px;color:#999}ul{list-style-type:none;margin-left:0}ul li{padding:3px 0}table{border-collapse:collapse;border-spacing:0;width:100%}.file-tree-view+#main-table{width:75%!important;float:left}td,th{padding:4px 7px;text-align:left;vertical-align:top;border:1px solid #ddd;background:#fff}td.gray,th{background-color:#eee}td.gray span{color:#222}tr:hover td{background-color:#f5f5f5}tr:hover td.gray{background-color:#eee}.table{width:100%;max-width:100%;margin-bottom:1rem}.table td,.table th{padding:.55rem;vertical-align:top;border-top:1px solid #ddd}.table thead th{vertical-align:bottom;border-bottom:2px solid #eceeef}.table tbody+tbody{border-top:2px solid #eceeef}.table .table{background-color:#fff}code,pre{display:block;margin-bottom:10px;font:13px/16px Consolas,'Courier New',Courier,monospace;border:1px dashed #ccc;padding:5px;overflow:auto}.hidden,.modal{display:none}.btn,.close{font-weight:700}pre.with-hljs{padding:0}pre.with-hljs code{margin:0;border:0;overflow:visible}code.maxheight,pre.maxheight{max-height:512px}input[type=checkbox]{margin:0;padding:0}.message,.path{padding:4px 7px;border:1px solid #ddd;background-color:#fff}.fa.fa-caret-right{font-size:1.2em;margin:0 4px;vertical-align:middle;color:#ececec}.fa.fa-home{font-size:1.2em;vertical-align:bottom}#wrapper{min-width:400px;margin:0 auto}.path{margin-bottom:10px}.right{text-align:right}.center,.close,.login-form{text-align:center}.float-right{float:right}.float-left{float:left}.message.ok{border-color:green;color:green}.message.error{border-color:red;color:red}.message.alert{border-color:orange;color:orange}.btn{border:0;background:0 0;padding:0;margin:0;color:#296ea3;cursor:pointer}.btn:hover{color:#b00}.preview-img{max-width:100%;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAKklEQVR42mL5//8/Azbw+PFjrOJMDCSCUQ3EABZc4S0rKzsaSvTTABBgAMyfCMsY4B9iAAAAAElFTkSuQmCC)}.inline-actions&gt;a&gt;i{font-size:1em;margin-left:5px;background:#3785c1;color:#fff;padding:3px;border-radius:3px}.preview-video{position:relative;max-width:100%;height:0;padding-bottom:62.5%;margin-bottom:10px}.preview-video video{position:absolute;width:100%;height:100%;left:0;top:0;background:#000}.compact-table{border:0;width:auto}.compact-table td,.compact-table th{width:100px;border:0;text-align:center}.compact-table tr:hover td{background-color:#fff}.filename{max-width:420px;overflow:hidden;text-overflow:ellipsis}.break-word{word-wrap:break-word;margin-left:30px}.break-word.float-left a{color:#7d7d7d}.break-word+.float-right{padding-right:30px;position:relative}.break-word+.float-right&gt;a{color:#7d7d7d;font-size:1.2em;margin-right:4px}.modal{position:fixed;z-index:1;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}#editor,.edit-file-actions{position:absolute;right:30px}.modal-content{background-color:#fefefe;margin:auto;padding:20px;border:1px solid #888;width:80%}.close:focus,.close:hover{color:#000;cursor:pointer}#editor{top:50px;bottom:5px;left:30px}.edit-file-actions{top:0;background:#fff;margin-top:5px}.edit-file-actions&gt;a,.edit-file-actions&gt;button{background:#fff;padding:5px 15px;cursor:pointer;color:#296ea3;border:1px solid #296ea3}.group-btn{background:#fff;padding:2px 6px;border:1px solid;cursor:pointer;color:#296ea3}.main-nav{position:fixed;top:0;left:0;padding:10px 30px 10px 1px;width:100%;background:#fff;color:#000;border:0;box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2)}.login-form{width:320px;margin:0 auto;box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.2)}.login-form label,.path.login-form input{padding:8px;margin:10px}.footer-links{background:0 0;border:0;clear:both}select[name=lang]{border:none;position:relative;text-transform:uppercase;left:-30%;top:12px;color:silver}input[type=search]{height:30px;margin:5px;width:80%;border:1px solid #ccc}.path.login-form input[type=submit]{background-color:#4285f4;color:#fff;border:1px solid;border-radius:2px;font-weight:700;cursor:pointer}.modalDialog{position:fixed;font-family:Arial,Helvetica,sans-serif;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.8);z-index:99999;opacity:0;-webkit-transition:opacity .4s ease-in;-moz-transition:opacity .4s ease-in;transition:opacity .4s ease-in;pointer-events:none}.modalDialog:target{opacity:1;pointer-events:auto}.modalDialog&gt;.model-wrapper{max-width:400px;position:relative;margin:10% auto;padding:15px;border-radius:2px;background:#fff}.close{float:right;background:#fff;color:#000;line-height:25px;position:absolute;right:0;top:0;width:24px;border-radius:0 5px 0 0;font-size:18px}.close:hover{background:#e4e4e4}.modalDialog p{line-height:30px}div#searchresultWrapper{max-height:320px;overflow:auto}div#searchresultWrapper li{margin:8px 0;list-style:none}li.file:before,li.folder:before{font:normal normal normal 14px/1 FontAwesome;content:"\f016";margin-right:5px}li.folder:before{content:"\f114"}i.fa.fa-folder-o{color:#eeaf4b}i.fa.fa-picture-o{color:#26b99a}i.fa.fa-file-archive-o{color:#da7d7d}.footer-links i.fa.fa-file-archive-o{color:#296ea3}i.fa.fa-css3{color:#f36fa0}i.fa.fa-file-code-o{color:#ec6630}i.fa.fa-code{color:#cc4b4c}i.fa.fa-file-text-o{color:#0096e6}i.fa.fa-html5{color:#d75e72}i.fa.fa-file-excel-o{color:#09c55d}i.fa.fa-file-powerpoint-o{color:#f6712e}.file-tree-view{width:24%;float:left;overflow:auto;border:1px solid #ddd;border-right:0;background:#fff}.file-tree-view .tree-title{background:#eee;padding:9px 2px 9px 10px;font-weight:700}.file-tree-view ul{margin-left:15px;margin-bottom:0}.file-tree-view i{padding-right:3px}.php-file-tree{font-size:100%;letter-spacing:1px;line-height:1.5;margin-left:5px!important}.php-file-tree a{color:#296ea3}.php-file-tree A:hover{color:#b00}.php-file-tree .open{font-style:italic;color:#2183ce}.php-file-tree .closed{font-style:normal}#file-tree-view::-webkit-scrollbar{width:10px;background-color:#F5F5F5}#file-tree-view::-webkit-scrollbar-track{border-radius:10px;background:rgba(0,0,0,.1);border:1px solid #ccc}#file-tree-view::-webkit-scrollbar-thumb{border-radius:10px;background:linear-gradient(left,#fff,#e4e4e4);border:1px solid #aaa}#file-tree-view::-webkit-scrollbar-thumb:hover{background:#fff}#file-tree-view::-webkit-scrollbar-thumb:active{background:linear-gradient(left,#22ADD4,#1E98BA)}<br>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;div id="wrapper"&gt;<br><br>&lt;?php<br>}<br><br>/**<br> * Show page footer in Login Form<br> */<br>function fm_show_footer_login()<br>{<br>    ?&gt;<br>&lt;/div&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br>&lt;?php<br>}<br><br>/**<br> * Show page header<br> */<br>function fm_show_header()<br>{<br>    $sprites_ver = '20160315';<br>    header("Content-Type: text/html; charset=utf-8");<br>    header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");<br>    header("Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0");<br>    header("Pragma: no-cache");<br><br>    global $lang;<br>    ?&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta charset="utf-8"&gt;<br>&lt;title&gt;H3K | File Manager&lt;/title&gt;<br>&lt;meta name="Description" CONTENT="Author: CCP Programmers, H3K Tiny PHP File Manager"&gt;<br>&lt;link rel="icon" href="&lt;?php echo FM_SELF_URL ?&gt;?img=favicon" type="image/png"&gt;<br>&lt;link rel="shortcut icon" href="&lt;?php echo FM_SELF_URL ?&gt;?img=favicon" type="image/png"&gt;<br>&lt;link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"&gt;<br>&lt;?php if (isset($_GET['view']) &amp;&amp; FM_USE_HIGHLIGHTJS): ?&gt;<br>&lt;link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/&lt;?php echo FM_HIGHLIGHTJS_STYLE ?&gt;.min.css"&gt;<br>&lt;?php endif; ?&gt;<br>&lt;style&gt;<br>a img,img{border:none}.filename,td,th{white-space:nowrap}.close,.close:focus,.close:hover,.php-file-tree a,a{text-decoration:none}a,body,code,div,em,form,html,img,label,li,ol,p,pre,small,span,strong,table,td,th,tr,ul{margin:0;padding:0;vertical-align:baseline;outline:0;font-size:100%;background:0 0;border:none;text-decoration:none}p,table,ul{margin-bottom:10px}html{overflow-y:scroll}body{padding:0;font:13px/16px Tahoma,Arial,sans-serif;color:#222;background:#F7F7F7;margin:50px 30px 0}button,input,select,textarea{font-size:inherit;font-family:inherit}a{color:#296ea3}a:hover{color:#b00}img{vertical-align:middle}span{color:#777}small{font-size:11px;color:#999}ul{list-style-type:none;margin-left:0}ul li{padding:3px 0}table{border-collapse:collapse;border-spacing:0;width:100%}.file-tree-view+#main-table{width:75%!important;float:left}td,th{padding:4px 7px;text-align:left;vertical-align:top;border:1px solid #ddd;background:#fff}td.gray,th{background-color:#eee}td.gray span{color:#222}tr:hover td{background-color:#f5f5f5}tr:hover td.gray{background-color:#eee}.table{width:100%;max-width:100%;margin-bottom:1rem}.table td,.table th{padding:.55rem;vertical-align:top;border-top:1px solid #ddd}.table thead th{vertical-align:bottom;border-bottom:2px solid #eceeef}.table tbody+tbody{border-top:2px solid #eceeef}.table .table{background-color:#fff}code,pre{display:block;margin-bottom:10px;font:13px/16px Consolas,'Courier New',Courier,monospace;border:1px dashed #ccc;padding:5px;overflow:auto}.hidden,.modal{display:none}.btn,.close{font-weight:700}pre.with-hljs{padding:0}pre.with-hljs code{margin:0;border:0;overflow:visible}code.maxheight,pre.maxheight{max-height:512px}input[type=checkbox]{margin:0;padding:0}.message,.path{padding:4px 7px;border:1px solid #ddd;background-color:#fff}.fa.fa-caret-right{font-size:1.2em;margin:0 4px;vertical-align:middle;color:#ececec}.fa.fa-home{font-size:1.2em;vertical-align:bottom}#wrapper{min-width:400px;margin:0 auto}.path{margin-bottom:10px}.right{text-align:right}.center,.close,.login-form{text-align:center}.float-right{float:right}.float-left{float:left}.message.ok{border-color:green;color:green}.message.error{border-color:red;color:red}.message.alert{border-color:orange;color:orange}.btn{border:0;background:0 0;padding:0;margin:0;color:#296ea3;cursor:pointer}.btn:hover{color:#b00}.preview-img{max-width:100%;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAKklEQVR42mL5//8/Azbw+PFjrOJMDCSCUQ3EABZc4S0rKzsaSvTTABBgAMyfCMsY4B9iAAAAAElFTkSuQmCC)}.inline-actions&gt;a&gt;i{font-size:1em;margin-left:5px;background:#3785c1;color:#fff;padding:3px;border-radius:3px}.preview-video{position:relative;max-width:100%;height:0;padding-bottom:62.5%;margin-bottom:10px}.preview-video video{position:absolute;width:100%;height:100%;left:0;top:0;background:#000}.compact-table{border:0;width:auto}.compact-table td,.compact-table th{width:100px;border:0;text-align:center}.compact-table tr:hover td{background-color:#fff}.filename{max-width:420px;overflow:hidden;text-overflow:ellipsis}.break-word{word-wrap:break-word;margin-left:30px}.break-word.float-left a{color:#7d7d7d}.break-word+.float-right{padding-right:30px;position:relative}.break-word+.float-right&gt;a{color:#7d7d7d;font-size:1.2em;margin-right:4px}.modal{position:fixed;z-index:1;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}#editor,.edit-file-actions{position:absolute;right:30px}.modal-content{background-color:#fefefe;margin:auto;padding:20px;border:1px solid #888;width:80%}.close:focus,.close:hover{color:#000;cursor:pointer}#editor{top:50px;bottom:5px;left:30px}.edit-file-actions{top:0;background:#fff;margin-top:5px}.edit-file-actions&gt;a,.edit-file-actions&gt;button{background:#fff;padding:5px 15px;cursor:pointer;color:#296ea3;border:1px solid #296ea3}.group-btn{background:#fff;padding:2px 6px;border:1px solid;cursor:pointer;color:#296ea3}.main-nav{position:fixed;top:0;left:0;padding:10px 30px 10px 1px;width:100%;background:#fff;color:#000;border:0;box-shadow:0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12),0 2px 4px -1px rgba(0,0,0,.2)}.login-form{width:320px;margin:0 auto;box-shadow:0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12),0 5px 5px -3px rgba(0,0,0,.2)}.login-form label,.path.login-form input{padding:8px;margin:10px}.footer-links{background:0 0;border:0;clear:both}select[name=lang]{border:none;position:relative;text-transform:uppercase;left:-30%;top:12px;color:silver}input[type=search]{height:30px;margin:5px;width:80%;border:1px solid #ccc}.path.login-form input[type=submit]{background-color:#4285f4;color:#fff;border:1px solid;border-radius:2px;font-weight:700;cursor:pointer}.modalDialog{position:fixed;font-family:Arial,Helvetica,sans-serif;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.8);z-index:99999;opacity:0;-webkit-transition:opacity .4s ease-in;-moz-transition:opacity .4s ease-in;transition:opacity .4s ease-in;pointer-events:none}.modalDialog:target{opacity:1;pointer-events:auto}.modalDialog&gt;.model-wrapper{max-width:400px;position:relative;margin:10% auto;padding:15px;border-radius:2px;background:#fff}.close{float:right;background:#fff;color:#000;line-height:25px;position:absolute;right:0;top:0;width:24px;border-radius:0 5px 0 0;font-size:18px}.close:hover{background:#e4e4e4}.modalDialog p{line-height:30px}div#searchresultWrapper{max-height:320px;overflow:auto}div#searchresultWrapper li{margin:8px 0;list-style:none}li.file:before,li.folder:before{font:normal normal normal 14px/1 FontAwesome;content:"\f016";margin-right:5px}li.folder:before{content:"\f114"}i.fa.fa-folder-o{color:#eeaf4b}i.fa.fa-picture-o{color:#26b99a}i.fa.fa-file-archive-o{color:#da7d7d}.footer-links i.fa.fa-file-archive-o{color:#296ea3}i.fa.fa-css3{color:#f36fa0}i.fa.fa-file-code-o{color:#ec6630}i.fa.fa-code{color:#cc4b4c}i.fa.fa-file-text-o{color:#0096e6}i.fa.fa-html5{color:#d75e72}i.fa.fa-file-excel-o{color:#09c55d}i.fa.fa-file-powerpoint-o{color:#f6712e}.file-tree-view{width:24%;float:left;overflow:auto;border:1px solid #ddd;border-right:0;background:#fff}.file-tree-view .tree-title{background:#eee;padding:9px 2px 9px 10px;font-weight:700}.file-tree-view ul{margin-left:15px;margin-bottom:0}.file-tree-view i{padding-right:3px}.php-file-tree{font-size:100%;letter-spacing:1px;line-height:1.5;margin-left:5px!important}.php-file-tree a{color:#296ea3}.php-file-tree A:hover{color:#b00}.php-file-tree .open{font-style:italic;color:#2183ce}.php-file-tree .closed{font-style:normal}#file-tree-view::-webkit-scrollbar{width:10px;background-color:#F5F5F5}#file-tree-view::-webkit-scrollbar-track{border-radius:10px;background:rgba(0,0,0,.1);border:1px solid #ccc}#file-tree-view::-webkit-scrollbar-thumb{border-radius:10px;background:linear-gradient(left,#fff,#e4e4e4);border:1px solid #aaa}#file-tree-view::-webkit-scrollbar-thumb:hover{background:#fff}#file-tree-view::-webkit-scrollbar-thumb:active{background:linear-gradient(left,#22ADD4,#1E98BA)}<br>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;div id="wrapper"&gt;<br>  &lt;div id="createNewItem" class="modalDialog"&gt;&lt;div class="model-wrapper"&gt;&lt;a href="#close" title="Close" class="close"&gt;X&lt;/a&gt;&lt;h2&gt;Create New Item&lt;/h2&gt;&lt;p&gt;<br>        &lt;label for="newfile"&gt;Item Type &amp;nbsp; : &lt;/label&gt;&lt;input type="radio" name="newfile" id="newfile" value="file"&gt;File &lt;input type="radio" name="newfile" value="folder" checked&gt; Folder&lt;br&gt;&lt;label for="newfilename"&gt;Item Name : &lt;/label&gt;&lt;input type="text" name="newfilename" id="newfilename" value=""&gt;&lt;br&gt;<br>        &lt;input type="submit" name="submit" class="group-btn" value="Create Now" onclick="newfolder('&lt;?php echo fm_enc(FM_PATH) ?&gt;');return false;"&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;<br>    &lt;div id="searchResult" class="modalDialog"&gt;&lt;div class="model-wrapper"&gt;&lt;a href="#close" title="Close" class="close"&gt;X&lt;/a&gt;<br>    &lt;input type="search" name="search" value="" placeholder="Find a item in current folder..."&gt;<br>    &lt;h2&gt;Search Results&lt;/h2&gt;<br>    &lt;div id="searchresultWrapper"&gt;&lt;/div&gt;<br>    &lt;/div&gt;&lt;/div&gt;<br>&lt;?php<br>}<br><br>/**<br> * Show page footer<br> */<br>function fm_show_footer()<br>{<br>    ?&gt;<br>&lt;/div&gt;<br>&lt;script&gt;<br>function newfolder(e){var t=document.getElementById("newfilename").value,n=document.querySelector('input[name="newfile"]:checked').value;null!==t&amp;&amp;""!==t&amp;&amp;n&amp;&amp;(window.location.hash="#",window.location.search="p="+encodeURIComponent(e)+"&amp;new="+encodeURIComponent(t)+"&amp;type="+encodeURIComponent(n))}function rename(e,t){var n=prompt("New name",t);null!==n&amp;&amp;""!==n&amp;&amp;n!=t&amp;&amp;(window.location.search="p="+encodeURIComponent(e)+"&amp;ren="+encodeURIComponent(t)+"&amp;to="+encodeURIComponent(n))}function change_checkboxes(e,t){for(var n=e.length-1;n&gt;=0;n--)e[n].checked="boolean"==typeof t?t:!e[n].checked}function get_checkboxes(){for(var e=document.getElementsByName("file[]"),t=[],n=e.length-1;n&gt;=0;n--)(e[n].type="checkbox")&amp;&amp;t.push(e[n]);return t}function select_all(){change_checkboxes(get_checkboxes(),!0)}function unselect_all(){change_checkboxes(get_checkboxes(),!1)}function invert_all(){change_checkboxes(get_checkboxes())}function mailto(e,t){var n=new XMLHttpRequest,a="path="+e+"&amp;file="+t+"&amp;type=mail&amp;ajax=true";n.open("POST","",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4==n.readyState&amp;&amp;200==n.status&amp;&amp;alert(n.responseText)},n.send(a)}function showSearch(e){var t=new XMLHttpRequest,n="path="+e+"&amp;type=search&amp;ajax=true";t.open("POST","",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&amp;&amp;200==t.status&amp;&amp;(window.searchObj=t.responseText,document.getElementById("searchresultWrapper").innerHTML="",window.location.hash="#searchResult")},t.send(n)}function getSearchResult(e,t){var n=[],a=[];return e.forEach(function(e){"folder"===e.type?(getSearchResult(e.items,t),e.name.toLowerCase().match(t)&amp;&amp;n.push(e)):"file"===e.type&amp;&amp;e.name.toLowerCase().match(t)&amp;&amp;a.push(e)}),{folders:n,files:a}}function checkbox_toggle(){var e=get_checkboxes();e.push(this),change_checkboxes(e)}function backup(e,t){var n=new XMLHttpRequest,a="path="+e+"&amp;file="+t+"&amp;type=backup&amp;ajax=true";return n.open("POST","",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4==n.readyState&amp;&amp;200==n.status&amp;&amp;alert(n.responseText)},n.send(a),!1}function edit_save(e,t){var n="ace"==t?editor.getSession().getValue():document.getElementById("normal-editor").value;if(n){var a=document.createElement("form");a.setAttribute("method","POST"),a.setAttribute("action","");var o=document.createElement("textarea");o.setAttribute("type","textarea"),o.setAttribute("name","savedata");var c=document.createTextNode(n);o.appendChild(c),a.appendChild(o),document.body.appendChild(a),a.submit()}}function init_php_file_tree(){if(document.getElementsByTagName){for(var e=document.getElementsByTagName("LI"),t=0;t&lt;e.length;t++){var n=e[t].className;if(n.indexOf("pft-directory")&gt;-1)for(var a=e[t].childNodes,o=0;o&lt;a.length;o++)"A"==a[o].tagName&amp;&amp;(a[o].onclick=function(){for(var e=this.nextSibling;;){if(null==e)return!1;if("UL"==e.tagName){var t="none"==e.style.display;return e.style.display=t?"block":"none",this.className=t?"open":"closed",!1}e=e.nextSibling}return!1},a[o].className=n.indexOf("open")&gt;-1?"open":"closed"),"UL"==a[o].tagName&amp;&amp;(a[o].style.display=n.indexOf("open")&gt;-1?"block":"none")}return!1}}var searchEl=document.querySelector("input[type=search]"),timeout=null;searchEl.onkeyup=function(e){clearTimeout(timeout);var t=JSON.parse(window.searchObj),n=document.querySelector("input[type=search]").value;timeout=setTimeout(function(){if(n.length&gt;=2){var e=getSearchResult(t,n),a="",o="";e.folders.forEach(function(e){a+='&lt;li class="'+e.type+'"&gt;&lt;a href="?p='+e.path+'"&gt;'+e.name+"&lt;/a&gt;&lt;/li&gt;"}),e.files.forEach(function(e){o+='&lt;li class="'+e.type+'"&gt;&lt;a href="?p='+e.path+"&amp;view="+e.name+'"&gt;'+e.name+"&lt;/a&gt;&lt;/li&gt;"}),document.getElementById("searchresultWrapper").innerHTML='&lt;div class="model-wrapper"&gt;'+a+o+"&lt;/div&gt;"}},500)},window.onload=init_php_file_tree;if(document.getElementById("file-tree-view")){var tableViewHt=document.getElementById("main-table").offsetHeight-2;document.getElementById("file-tree-view").setAttribute("style","height:"+tableViewHt+"px")};<br>&lt;/script&gt;<br>&lt;?php if (isset($_GET['view']) &amp;&amp; FM_USE_HIGHLIGHTJS): ?&gt;<br>&lt;script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"&gt;&lt;/script&gt;<br>&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;<br>&lt;?php endif; ?&gt;<br>&lt;?php if (isset($_GET['edit']) &amp;&amp; isset($_GET['env']) &amp;&amp; FM_EDIT_FILE): ?&gt;<br>&lt;script src="//cdnjs.cloudflare.com/ajax/libs/ace/1.2.9/ace.js"&gt;&lt;/script&gt;<br>&lt;script&gt;var editor = ace.edit("editor");editor.getSession().setMode("ace/mode/javascript");&lt;/script&gt;<br>&lt;?php endif; ?&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br>&lt;?php<br>}<br><br>/**<br> * Show image<br> * @param string $img<br> */<br>function fm_show_image($img)<br>{<br>    $modified_time = gmdate('D, d M Y 00:00:00') . ' GMT';<br>    $expires_time = gmdate('D, d M Y 00:00:00', strtotime('+1 day')) . ' GMT';<br><br>    $img = trim($img);<br>    $images = fm_get_images();<br>    $image = 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAEElEQVR42mL4//8/A0CAAQAI/AL+26JNFgAAAABJRU5ErkJggg==';<br>    if (isset($images[$img])) {<br>        $image = $images[$img];<br>    }<br>    $image = base64_decode($image);<br>    if (function_exists('mb_strlen')) {<br>        $size = mb_strlen($image, '8bit');<br>    } else {<br>        $size = strlen($image);<br>    }<br><br>    if (function_exists('header_remove')) {<br>        header_remove('Cache-Control');<br>        header_remove('Pragma');<br>    } else {<br>        header('Cache-Control:');<br>        header('Pragma:');<br>    }<br><br>    header('Last-Modified: ' . $modified_time, true, 200);<br>    header('Expires: ' . $expires_time);<br>    header('Content-Length: ' . $size);<br>    header('Content-Type: image/png');<br>    echo $image;<br><br>    exit;<br>}<br><br>/**<br> * Get base64-encoded images<br> * @return array<br> */<br>function fm_get_images()<br>{<br>    return array(<br>        'favicon' =&gt; 'iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJ<br>bWFnZVJlYWR5ccllPAAAAZVJREFUeNqkk79Lw0AUx1+uidTQim4Waxfpnl1BcHMR6uLkIF0cpYOI<br>f4KbOFcRwbGTc0HQSVQQXCqlFIXgFkhIyvWS870LaaPYH9CDy8vdfb+fey930aSUMEvT6VHVzw8x<br>rKUX3N3Hj/8M+cZ6GcOtBPl6KY5iAA7KJzfVWrfbhUKhALZtQ6myDf1+X5nsuzjLUmUOnpa+v5r1<br>Z4ZDDfsLiwER45xDEATgOI6KntfDd091GidzC8vZ4vH1QQ09+4MSMAMWRREKPMhmsyr6voYmrnb2<br>PKEizdEabUaeFCDKCCHAdV0wTVNFznMgpVqGlZ2cipzHGtKSZwCIZJgJwxB38KHT6Sjx21V75Jcn<br>LXmGAKTRpGVZUx2dAqQzSEqw9kqwuGqONTufPrw37D8lQFxCvjgPXIixANLEGfwuQacMOC4kZz+q<br>GdhJS550BjpRCdCbAJCMJRkMASEIg+4Bxz4JwAwDSEueAYDLIM+QrOk6GHiRxjXSkJY8KUCvdXZ6<br>kbuvNx+mOcbN9taGBlpLAWf9nX8EGADoCfqkKWV/cgAAAABJRU5ErkJggg==',<br>        'sprites' =&gt; 'iVBORw0KGgoAAAANSUhEUgAAAYAAAAAgCAMAAAAscl/XAAAC/VBMVEUAAABUfn4KKipIcXFSeXsx<br>VlZSUlNAZ2c4Xl4lSUkRDg7w8O/d3d3LhwAWFhYXODgMLCx8fHw9PT2TtdOOAACMXgE8lt+dmpq+<br>fgABS3RUpN+VUycuh9IgeMJUe4C5dUI6meKkAQEKCgoMWp5qtusJmxSUPgKudAAXCghQMieMAgIU<br>abNSUlJLe70VAQEsh85oaGjBEhIBOGxfAoyUbUQAkw8gui4LBgbOiFPHx8cZX6PMS1OqFha/MjIK<br>VKFGBABSAXovGAkrg86xAgIoS5Y7c6Nf7W1Hz1NmAQB3Hgx8fHyiTAAwp+eTz/JdDAJ0JwAAlxCQ<br>UAAvmeRiYp6ysrmIAABJr/ErmiKmcsATpRyfEBAOdQgOXahyAAAecr1JCwHMiABgfK92doQGBgZG<br>AGkqKiw0ldYuTHCYsF86gB05UlJmQSlra2tVWED////8/f3t9fX5/Pzi8/Px9vb2+/v0+fnn8vLf<br>7OzZ6enV5+eTpKTo6Oj6/v765Z/U5eX4+Pjx+Pjv0ojWBASxw8O8vL52dnfR19CvAADR3PHr6+vi<br>4uPDx8v/866nZDO7iNT335jtzIL+7aj86aTIztXDw8X13JOlpKJoaHDJAACltratrq3lAgKfAADb<br>4vb76N2au9by2I9gYGVIRkhNTE90wfXq2sh8gL8QMZ3pyn27AADr+uu1traNiIh2olTTshifodQ4<br>ZM663PH97+YeRq2GqmRjmkGjnEDnfjLVVg6W4f7s6/p/0fr98+5UVF6wz+SjxNsmVb5RUVWMrc7d<br>zrrIpWI8PD3pkwhCltZFYbNZja82wPv05NPRdXzhvna4uFdIiibPegGQXankxyxe0P7PnOhTkDGA<br>gBrbhgR9fX9bW1u8nRFamcgvVrACJIvlXV06nvtdgON4mdn3og7AagBTufkucO7snJz4b28XEhIT<br>sflynsLEvIk55kr866aewo2YuYDrnFffOTk6Li6hgAn3y8XkusCHZQbt0NP571lqRDZyMw96lZXE<br>s6qcrMmJaTmVdRW2AAAAbnRSTlMAZodsJHZocHN7hP77gnaCZWdx/ki+RfqOd/7+zc9N/szMZlf8<br>z8yeQybOzlv+tP5q/qKRbk78i/vZmf798s3MojiYjTj+/vqKbFc2/vvMzJiPXPzbs4z9++bj1XbN<br>uJxhyMBWwJbp28C9tJ6L1xTnMfMAAA79SURBVGje7Jn5b8thHMcfzLDWULXq2upqHT2kbrVSrJYx<br>NzHmviWOrCudqxhbNdZqHauKJTZHm0j0ByYkVBCTiC1+EH6YRBY/EJnjD3D84PMc3++39Z1rjp+8<br>Kn189rT5Pt/363k+3YHEDOrCSKP16t48q8U1IysLAUKZk1obLBYDKjAUoB8ziLv4vyQLQD+Lcf4Q<br>jvno90kfDaQTRhcioIv7QPk2oJqF0PsIT29RzQdOEhfKG6QW8lcoLIYxjWPQD2GXr/63BhYsWrQA<br>fYc0JSaNxa8dH4zUEYag32f009DTkNTnC4WkpcRAl4ryHTt37d5/ugxCIIEfZ0Dg4poFThIXygSp<br>hfybmhSWLS0dCpDrdFMRZubUkmJ2+d344qIU8sayN8iFQaBgMDy+FWA/wjelOmbrHUKVtQgxFqFc<br>JeE2RpmLEIlfFazzer3hcOAPCQiFasNheAo9HQ1f6FZRTgzs2bOnFwn8+AnG8d6impClTkSjCXWW<br>kH80GmUGWP6A4kKkQwG616/tOhin6kii3dzl5YHqT58+bf5KQdq8IjCAg3+tk3NDCoPZC2fQuGcI<br>7+8nKQMk/b41r048UKOk48zln4MgesydOw0NDbeVCA2B+FVaEIDz/0MCSkOlAa+3tDRQSgW4t1MD<br>+7d1Q8DA9/sY7weKapZ/Qp+tzwYDtLyRiOrBANQ0/3hTMBIJNsXPb0GM5ANfrLO3telmTrWXGBG7<br>fHVHbWjetKKiPCJsAkQv17VNaANv6zJTWAcvmCEtI0hnII4RLsIIBIjmHStXaqKzNCtXOvj+STxl<br>OXKwgDuEBuAOEQDxgwDIv85bCwKMw6B5DzOyoVMCHpc+Dnu9gUD4MSeAGWACTnCBnxgorgGHRqPR<br>Z8OTg5ZqtRoEwLODy79JdfiwqgkMGBAlJ4caYK3HNGGCHedPBLgqtld30IbmLZk2jTsB9jadboJ9<br>Aj4BMqlAXCqV4e3udGH8zn6CgMrtQCUIoPMEbj5Xk3jS3N78UpPL7R81kJOTHdU7QACff/9kAbD/<br>IxHvEGTcmi/1+/NlMjJsNXZKAAcIoAkwA0zAvqOMfQNFNcOsf2BGAppotl6D+P0fi6nOnFHFYk1x<br>CzOgvqEGA4ICk91uQpQee90V1W58fdYDx0Ls+JnmTwy02e32iRNJB5L5X7y4/Pzq1buXX/lb/X4Z<br>SRtTo4C8uf6/Nez11dRI0pkNCswzA+Yn7e3NZi5/aKcYaKPqLBDw5iHPKGUutCAQoKqri0QizsgW<br>lJ6/1mqNK4C41bo2P72TnwEMEEASYAa29SCBHz1J2fdo4ExRTbHl5NiSBWQ/yGYCLBnFLbFY8PPn<br>YCzWUpxhYS9IJDSIx1iydKJpKTPQ0+lyV9MuCEcQJw+tH57Hjcubhyhy00TAJEdAuocX4Gn1eNJJ<br>wHG/xB+PQ8BC/6/0ejw1nAAJAeZ5A83tNH+kuaHHZD8A1MsRUvZ/c0WgPwhQBbGAiAQz2CjzZSJr<br>GOxKw1aU6ZOhX2ZK6GYZ42ZoChbgdDED5UzAWcLRR4+cA0U1ZfmiRcuRgJkIYIwBARThuyDzE7hf<br>nulLR5qKS5aWMAFOV7WrghjAAvKKpoEByH8J5C8WMELCC5AckkhGYCeS1lZfa6uf2/AuoM51yePB<br>DYrM18AD/sE8Z2DSJLaeLHNCr385C9iowbekfHOvQWBN4dzxXhUIuIRPgD+yCskWrs3MOETIyFy7<br>sFMC9roYe0EA2YLMwIGeCBh68iDh5P2TFUOhzhs3LammFC5YUIgEVmY/mKVJ4wTUx2JvP358G4vV<br>8wLo/TKKl45cWgwaTNNx1b3M6TwNh5DuANJ7xk37Kv+RBDCAtzMvoPJUZSUVID116pTUw3ecyPZI<br>vHIzfEQXMAEeAszzpKUhoR81m4GVNnJHyocN/Xnu2NLmaj/CEVBdqvX5FArvXGTYoAhIaxUb2GDo<br>jAD3doabCeAMVFABZ6mAs/fP7sCBLykal1KjYemMYYhh2zgrWUBLi2r8eFVLiyDAlpS/ccXIkSXk<br>IJTIiYAy52l8COkOoAZE+ZtMzEA/p8ApJ/lcldX4fc98fn8Nt+Fhd/Lbnc4DdF68fjgNzZMQhQkQ<br>UKK52mAQC/D5fHVe6VyEDBlWqzXDwAbUGQEHdjAOgACcAGegojsRcPAY4eD9g7uGonl5S4oWL77G<br>17D+fF/AewmzkDNQaG5v1+SmCtASAWKgAVWtKKD/w0egD/TC005igO2AsctAQB6/RU1VVVUmuZwM<br>CM3oJ2CB7+1xwPkeQj4TUOM5x/o/IJoXrR8MJAkY9ab/PZ41uZwAr88nBUDA7wICyncyypkAzoCb<br>CbhIgMCbh6K8d5jFfA3346qUePywmtrDfAdcrmmfZeMENNbXq7Taj/X1Hf8qYk7VxOlcMwIRfbt2<br>7bq5jBqAHUANLFlmRBzyFVUr5NyQgoUdqcGZhMFGmrfUA5D+L57vcP25thQBArZCIkCl/eCF/IE5<br>6PdZHzqwjXEgtB6+0KuMM+DuRQQcowKO3T/WjE/A4ndwAmhNBXjq4q1wyluLamWIN2Aebl4uCAhq<br>x2u/JUA+Z46Ri4aeBLYHYAEggBooSHmDXBgE1lnggcQU0LgLUMekrl+EclQSSgQCVFrVnFWTKav+<br>xAlY35Vn/RTSA4gB517X3j4IGMC1oOsHB8yEetm7xSl15kL4TVIAfjDxKjIRT6Ft0iQb3da3GhuD<br>QGPjrWL0E7AlsAX8ZUTr/xFzIP7pRvQ36SsI6Yvr+QN45uN607JlKbUhg8eAOgB2S4bFarVk/PyG<br>6Sss4O/y4/WL7+avxS/+e8D/+ku31tKbRBSFXSg+6iOpMRiiLrQ7JUQ3vhIXKks36h/QhY+FIFJ8<br>pEkx7QwdxYUJjRC1mAEF0aK2WEActVVpUbE2mBYp1VofaGyibW19LDSeOxdm7jCDNI0rv0lIvp7v<br>nnPnHKaQ+zHV/sxcPlPZT5Hrp69SEVg1vdgP+C/58cOT00+5P2pKreynyPWr1s+Ff4EOOzpctTt2<br>rir2A/bdxPhSghfrt9TxcCVlcWU+r5NH+ukk9fu6MYZL1NtwA9De3n6/dD4GA/N1EYwRxXzl+7NL<br>i/FJUo9y0Mp+inw/Kgp9BwZz5wxArV5e7AfcNGDcLMGL9XXnEOpcAVlcmXe+QYAJTFLfbcDoLlGv<br>/QaeQKiwfusuH8BB5EMnfYcKPGLAiCjmK98frQFDK9kvNZdW9lPk96cySKAq9gOCxmBw7hd4LcGl<br>enQDBsOoAW5AFlfkMICnhqdvDJ3pSerDRje8/93GMM9xwwznhHowAINhCA0gz5f5MOxiviYG8K4F<br>XoBHjO6RkdNuY4TI9wFuoZBPFfd6vR6EOAIaQHV9vaO+sJ8Ek7gAF5OQ7JeqoJX9FPn9qYwSqIr9<br>gGB10BYMfqkOluBIr6Y7AHQz4q4667k6q8sVIOI4n5zjARjfGDtH0j1E/FoepP4dg+Nha/fwk+Fu<br>axj0uN650e+vxHqhG6YbptcmbSjPd13H8In5TRaU7+Ix4GgAI5Fx7qkxIuY7N54T86m89mba6WTZ<br>Do/H2+HhB3Cstra2sP9EdSIGV3VCcn+Umlb2U+T9UJmsBEyqYj+gzWJrg8vSVoIjPW3vWLjQY6fx<br>DXDcKOcKNBBxyFdTQ3KmSqOpauF5upPjuE4u3UPEhQGI66FhR4/iAYQfwGUNgx7Xq3v1anxUqBdq<br>j8WG7mlD/jzfcf0jf+0Q8s9saoJnYFBzkWHgrC9qjUS58RFrVMw3ynE5IZ/Km2lsZtmMF9p/544X<br>DcAEDwDAXo/iA5bEXd9dn2VAcr/qWlrZT5H7LSqrmYBVxfsBc5trTjbbeD+g7crNNuj4lTZYocSR<br>nqa99+97aBrxgKvV5WoNNDTgeMFfSCYJzmi2ATQtiKfTrZ2t6daeHiLeD81PpVLXiPVmaBgfD1eE<br>hy8Nwyvocb1X7tx4a7JQz98eg/8/sYQ/z3cXngDJfizm94feHzqMBsBFotFohIsK+Vw5t0vcv8pD<br>0SzVjPvPdixH648eO1YLmIviUMp33Xc9FpLkp2i1sp8i91sqzRUEzJUgMNbQdrPZTtceBEHvlc+f<br>P/f2XumFFUoc6Z2Nnvu/4o1OxBsC7kAgl2s4T8RN1RPJ5ITIP22rulXVsi2LeE/aja6et4T+Zxja<br>/yOVEtfzDePjfRW2cF/YVtGH9LhebuPqBqGeP9QUCjVd97/M82U7fAg77EL+WU0Igy2DDDMLDeBS<br>JBq5xEWFfDl3MiDmq/R0wNvfy7efdd5BAzDWow8Bh6OerxdLDDgGHDE/eb9oAsp+itxvqaw4QaCi<br>Eh1HXz2DFGfOHp+FGo7RCyuUONI7nZ7MWNzpRLwhj/NE3GRKfp9Iilyv0XVpuqr0iPfk8ZbQj/2E<br>/v/4kQIu+BODhwYhjgaAN9oHeqV6L/0YLwv5tu7dAXCYJfthtg22tPA8yrUicFHlfDCATKYD+o/a<br>74QBoPVHjuJnAOIwAAy/JD9Fk37K/auif0L6LRc38IfjNQRO8AOoYRthhuxJCyTY/wwjaKZpCS/4<br>BaBnG+NDQ/FGFvEt5zGSRNz4fSPgu8D1XTqdblCnR3zxW4yHhP7j2M/fT09dTgnr8w1DfFEfRhj0<br>SvXWvMTwYa7gb8yA97/unQ59F5oBJnsUI6KcDz0B0H/+7S8MwG6DR8Bhd6D4Jj9GQlqPogk/JZs9<br>K/gn5H40e7aL7oToUYAfYMvUnMw40Gkw4Q80O6XcLMRZFgYwxrKl4saJjabqjRMCf6QDdOkeldJ/<br>BfSnrvWLcWgYxGX6KfPswEKLZVL6yrgXvv6g9uMBoDic3B/9e36KLvDNS7TZ7K3sGdE/wfoqDQD9<br>NGG+9AmYL/MDRM5iLo9nqDEYAJWRx5U5o+3SaHRaplS8H+Faf78Yh4bJ8k2Vz24qgJldXj8/DkCf<br>wDy8fH/sdpujTD2KxhxM/ueA249E/wTru/Dfl05bPkeC5TI/QOAvbJjL47TnI8BDy+KlOJPV6bJM<br>yfg3wNf+r99KxafOibNu5IQvKKsv2x9lTtEFvmGlXq9/rFeL/gnWD2kB6KcwcpB+wP/IyeP2svqp<br>9oeiCT9Fr1cL/gmp125aUc4P+B85iX+qJ/la0k/Ze0D0T0j93jXTpv0BYUGhQhdSooYAAAAASUVO<br>RK5CYII=',<br>    );<br>}<br>?&gt;<br><small style="float: right;">Original Source: <a href="https://raw.githubusercontent.com/prasathmani/tinyfilemanager/master/tinyfilemanager.php" title="github" rel="noopener noreferer nofollow">Github</a></small></pre>