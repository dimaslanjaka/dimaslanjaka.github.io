!function(){const e={orderBy:"startTime",showLocation:!1,offsetMax:72,offsetMin:4,showDeleted:!1,singleEvents:!0,maxResults:250};Object.assign(e,CONFIG.calendar);const t=new Date,n=new Date,s=new Date;n.setHours(t.getHours()+e.offsetMax),s.setHours(t.getHours()-e.offsetMin);const a={key:e.api_key,orderBy:e.orderBy,timeMax:n.toISOString(),timeMin:s.toISOString(),showDeleted:e.showDeleted,singleEvents:e.singleEvents,maxResults:e.maxResults},o=new URL(`https://www.googleapis.com/calendar/v3/calendars/${e.calendar_id}/events`);function buildEventDOM(n,s,a,o){const i={weekday:"short",hour:"2-digit",minute:"2-digit"},r="now"===n?"NOW":function(e,t){const n=36e5,s=864e5,a=2592e6,o=31536e6;let i=e-t;const r=i>0?" ago":" later";return i=Math.abs(i),i<n?Math.round(i/6e4)+" minutes"+r:i<s?Math.round(i/n)+" hours"+r:i<a?"about "+Math.round(i/s)+" days"+r:i<o?"about "+Math.round(i/a)+" months"+r:"about "+Math.round(i/o)+" years"+r}(t,a),c=a.toLocaleTimeString([],i)+" - "+o.toLocaleTimeString([],i);let d="";e.showLocation&&s.location&&(d=`<span class="event-location event-details">${s.location}</span>`);let l="";s.description&&(l=`<span class="event-description event-details">${s.description}</span>`);return`<section class="event event-${n}">\n        <h2 class="event-summary">\n          ${s.summary}\n          <span class="event-relative-time">${r}</span>\n        </h2>\n        ${d}\n        <span class="event-duration event-details">${c}</span>\n        ${l}\n      </section>`}function fetchData(){const e=document.querySelector(".event-list");e&&fetch(o.href).then((e=>e.json())).then((n=>{if(0===n.items.length)return void(e.innerHTML="<hr>");e.innerHTML="";let s=0;const a=6e4*(new Date).getTimezoneOffset();n.items.forEach((n=>{const o=new Date(n.start.dateTime||new Date(n.start.date).getTime()+a),i=new Date(n.end.dateTime||new Date(n.end.date).getTime()+a);let r="now";i<t?r="past":o>t&&(r="future"),"future"===r&&s<t&&e.insertAdjacentHTML("beforeend","<hr>"),e.insertAdjacentHTML("beforeend",buildEventDOM(r,n,o,i)),s=i}))}))}Object.entries(a).forEach((e=>o.searchParams.append(...e))),fetchData();const i=setInterval(fetchData,6e4);document.addEventListener("pjax:send",(()=>{clearInterval(i)}))}();