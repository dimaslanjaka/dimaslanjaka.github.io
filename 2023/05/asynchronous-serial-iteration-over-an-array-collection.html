<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>Asynchronous serial iteration over an array collection</title><meta name="description" content="Asynchronous serial iteration over an array collection Node.js design patterns:Asynchronous serial iteration over a collection using callbacks. This is an example of a very common Node.js design pattern.Serial asynchronous iteration over collections arrays using callbacks. If you want to learn m"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><meta name="keywords" content="the legend of neverland, genshin impact, games, how to, tips and tricks, php, javascript, jquery, mysql, seo, e-commerce"><meta name="image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/2048px-No_image_available.svg.png"><meta name="original-source" content="https://www.webmanajemen.com/2023/05/asynchronous-serial-iteration-over-an-array-collection.html"><link rel="canonical" href="https://www.webmanajemen.com/2023/05/asynchronous-serial-iteration-over-an-array-collection.html"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Asynchronous serial iteration over an array collection"><meta property="og:description" content="Asynchronous serial iteration over an array collection Node.js design patterns:Asynchronous serial iteration over a collection using callbacks. This is an example of a very common Node.js design pattern.Serial asynchronous iteration over collections arrays using callbacks. If you want to learn m"><meta property="og:url" content="https://www.webmanajemen.com/2023/05/asynchronous-serial-iteration-over-an-array-collection.html"><meta property="og:site_name" content="WMI"><meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/2048px-No_image_available.svg.png"><!--meta(property='og:image:secure_url' content=thumbnail)--><meta name="twitter:title" content="Asynchronous serial iteration over an array collection"><meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/2048px-No_image_available.svg.png"><meta name="twitter:description" content="Asynchronous serial iteration over an array collection Node.js design patterns:Asynchronous serial iteration over a collection using callbacks. This is an example of a very common Node.js design pattern.Serial asynchronous iteration over collections arrays using callbacks. If you want to learn m"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@WebsiteName"><!-- Google Analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q || []).push(arguments)},i[r].l=1 * new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-106238155-1', 'auto');
ga('send', 'pageview');</script><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="Node.js design patterns:
Asynchronous serial iteration over a collection using callbacks.
This is an example of a very common Node.js design pattern.
Serial asynchronous iteration over collections (arrays) using callbacks.
If you want to learn more about common (and not-so-common) Node.js design patterns, check this out.
Book Node.js design patterns by Mar.."><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="WMI" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="WMI" type="application/rss+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><!--a(href= url_for("/"))= (theme.user && theme.user.name || config.author) + "'s blog"--><a href="/">WMI</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Asynchronous serial iteration over an array collection</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Features"><span class="toc-text">Features</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Javascript-Asynchronous-serial-iteration-over-an-array-collection"><span class="toc-text">Javascript Asynchronous serial iteration over an array collection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Typescript-Asynchronous-serial-iteration-over-an-array-collection"><span class="toc-text">Typescript Asynchronous serial iteration over an array collection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usage-Asynchronous-serial-iteration-over-an-array-collection"><span class="toc-text">Usage Asynchronous serial iteration over an array collection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Live-Playground"><span class="toc-text">Live Playground</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/snippet"><i class="tag post-item-tag">snippet</i></a><a href="/tags/script"><i class="tag post-item-tag">script</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Asynchronous serial iteration over an array collection</h1><time class="has-text-grey" datetime="2023-05-23T15:16:52.000Z">2023-05-23</time><article class="mt-2 post-content"><p>Node.js design patterns:<br>
Asynchronous serial iteration over a collection using callbacks.</p>
<p>This is an example of a very common Node.js design pattern.<br>
Serial asynchronous iteration over collections (arrays) using callbacks.</p>
<p>If you want to learn more about common (and not-so-common) Node.js design patterns, check this out.<br>
Book Node.js design patterns by Mario Casciaro and Luciano Mammino modified by L3n4r0x support for typescript. <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webmanajemen.com/page/safelink.html?url=aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbG1hbW1pbm8vYWM5MWE3YmRlODhjMGY2YzY5NjIyNjhkNjdlM2ZmYmU=">source</a></p>
<h2 id="Features">Features</h2>
<ul>
<li>iterate without callback (auto detect callback is called or not)</li>
<li>support asynchronous or synchronous callback function</li>
<li>typescript generic type supported</li>
</ul>
<h2 id="Javascript-Asynchronous-serial-iteration-over-an-array-collection">Javascript Asynchronous serial iteration over an array collection</h2>
<pre><code class="highlight javascript"><span class="meta">"use strict"</span>;
<span class="comment">/**</span>
<span class="comment"> * A callback based function that allows to iterate over a collection</span>
<span class="comment"> * and perform asynchronous actions on every element. The processing is</span>
<span class="comment"> * done is series, so an element is started only when the previous one</span>
<span class="comment"> * has been completed. In case of error the whole processing is interrupted</span>
<span class="comment"> * early and the error is propagated to the finalCallback to let the caller</span>
<span class="comment"> * decide how to handle it.</span>
<span class="comment"> *</span>
<span class="comment"> *</span>
<span class="comment"> * <span class="doctag">@param</span> <span class="variable">collection</span> - The generic array of elements to iterate over</span>
<span class="comment"> * <span class="doctag">@param</span> <span class="variable">iteratorCallback</span> - The callback based function that will</span>
<span class="comment"> *        be used to process the current element.</span>
<span class="comment"> *        It receives the current element as first paramenter and a callback</span>
<span class="comment"> *        as second parameter. The callback needs to be invoked to indicate</span>
<span class="comment"> *        the end of the asynchronous processing. It can be called passing an</span>
<span class="comment"> *        error as first parameter to propagate an error)</span>
<span class="comment"> * <span class="doctag">@param</span> <span class="variable">finalCallback</span> - A function that is called when all the</span>
<span class="comment"> *        items have been processed or when an error occurred. If an error</span>
<span class="comment"> *        occurred the function will be invoked with a single argument</span>
<span class="comment"> *        representing the error.</span>
<span class="comment"> */</span>
<span class="keyword">const</span> <span class="title function_">iterateSeries</span> = (<span class="params">collection, iteratorCallback, finalCallback</span>) =&gt; {
    <span class="keyword">const</span> stoppingPoint = collection.<span class="property">length</span>;
    <span class="keyword">function</span> <span class="title function_">iterate</span>(<span class="params">index</span>) {
        <span class="comment">// console.log('it', index);</span>
        <span class="keyword">if</span> (index === stoppingPoint) {
            <span class="comment">// console.log('final');</span>
            <span class="keyword">return</span> <span class="title function_">finalCallback</span>();
        }
        <span class="keyword">else</span> {
            <span class="keyword">const</span> current = collection[index];
            <span class="keyword">let</span> called = <span class="literal">false</span>;
            <span class="keyword">const</span> done = <span class="keyword">function</span> (<span class="params">err</span>) {
                called = <span class="literal">true</span>;
                <span class="keyword">if</span> (err) {
                    <span class="keyword">return</span> <span class="title function_">finalCallback</span>(err);
                }
                <span class="keyword">return</span> <span class="title function_">iterate</span>(index + <span class="number">1</span>);
            };
            <span class="keyword">if</span> (iteratorCallback <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) {
                <span class="title function_">iteratorCallback</span>(current, done).<span class="title function_">then</span>(done);
            }
            <span class="keyword">else</span> {
                <span class="title function_">iteratorCallback</span>(current, done);
            }
            <span class="keyword">if</span> (!called)
                <span class="title function_">done</span>();
        }
    }
    <span class="title function_">iterate</span>(<span class="number">0</span>);
};</code></pre>
<h2 id="Typescript-Asynchronous-serial-iteration-over-an-array-collection">Typescript Asynchronous serial iteration over an array collection</h2>
<pre><code class="highlight typescript"><span class="comment">/**</span>
<span class="comment"> * A callback based function that allows to iterate over a collection</span>
<span class="comment"> * and perform asynchronous actions on every element. The processing is</span>
<span class="comment"> * done is series, so an element is started only when the previous one</span>
<span class="comment"> * has been completed. In case of error the whole processing is interrupted</span>
<span class="comment"> * early and the error is propagated to the finalCallback to let the caller</span>
<span class="comment"> * decide how to handle it.</span>
<span class="comment"> *</span>
<span class="comment"> *</span>
<span class="comment"> * <span class="doctag">@param</span> <span class="variable">collection</span> - The generic array of elements to iterate over</span>
<span class="comment"> * <span class="doctag">@param</span> <span class="variable">iteratorCallback</span> - The callback based function that will</span>
<span class="comment"> *        be used to process the current element.</span>
<span class="comment"> *        It receives the current element as first paramenter and a callback</span>
<span class="comment"> *        as second parameter. The callback needs to be invoked to indicate</span>
<span class="comment"> *        the end of the asynchronous processing. It can be called passing an</span>
<span class="comment"> *        error as first parameter to propagate an error)</span>
<span class="comment"> * <span class="doctag">@param</span> <span class="variable">finalCallback</span> - A function that is called when all the</span>
<span class="comment"> *        items have been processed or when an error occurred. If an error</span>
<span class="comment"> *        occurred the function will be invoked with a single argument</span>
<span class="comment"> *        representing the error.</span>
<span class="comment"> */</span>
<span class="keyword">const</span> iterateSeries = &lt;T <span class="keyword">extends</span> <span class="built_in">any</span>[]&gt;(
  <span class="attr">collection</span>: T,
  <span class="attr">iteratorCallback</span>:
    | (<span class="function">(<span class="params">currentElement: T[<span class="built_in">number</span>], done: (...args: <span class="built_in">any</span>[]) =&gt; <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">any</span>)
    | (<span class="function">(<span class="params">currentElement: T[<span class="built_in">number</span>], done: (...args: <span class="built_in">any</span>[]) =&gt; <span class="built_in">any</span></span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt;),
  <span class="attr">finalCallback</span>: <span class="function">(<span class="params">err?: <span class="built_in">Error</span></span>) =&gt;</span> <span class="built_in">any</span> | <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt;
) =&gt; {
  <span class="keyword">const</span> stoppingPoint = collection.<span class="property">length</span>;

  <span class="keyword">function</span> <span class="title function_">iterate</span>(<span class="params">index: <span class="built_in">number</span></span>) {
    <span class="comment">// console.log('it', index);</span>
    <span class="keyword">if</span> (index === stoppingPoint) {
      <span class="comment">// console.log('final');</span>
      <span class="keyword">return</span> <span class="title function_">finalCallback</span>();
    } <span class="keyword">else</span> {
      <span class="keyword">const</span> current = collection[index];
      <span class="keyword">let</span> called = <span class="literal">false</span>;
      <span class="keyword">const</span> done = <span class="keyword">function</span> (<span class="params">err?: <span class="built_in">Error</span> | <span class="literal">undefined</span></span>) {
        called = <span class="literal">true</span>;
        <span class="keyword">if</span> (err) {
          <span class="keyword">return</span> <span class="title function_">finalCallback</span>(err);
        }

        <span class="keyword">return</span> <span class="title function_">iterate</span>(index + <span class="number">1</span>);
      };
      <span class="keyword">if</span> (iteratorCallback <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) {
        <span class="title function_">iteratorCallback</span>(current, done).<span class="title function_">then</span>(done);
      } <span class="keyword">else</span> {
        <span class="title function_">iteratorCallback</span>(current, done);
      }
      <span class="keyword">if</span> (!called) <span class="title function_">done</span>();
    }
  }

  <span class="title function_">iterate</span>(<span class="number">0</span>);
};</code></pre>
<h2 id="Usage-Asynchronous-serial-iteration-over-an-array-collection">Usage Asynchronous serial iteration over an array collection</h2>
<pre><code class="highlight js"><span class="keyword">const</span> deployInfo = [
  {
    <span class="attr">name</span>: <span class="string">'root'</span>,
    <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">'.deploy_git'</span>),
    <span class="attr">url</span>: <span class="string">'https://github.com/dimaslanjaka/dimaslanjaka.github.io'</span>,
    <span class="attr">ref</span>: <span class="string">'master'</span>
  },
  {
    <span class="attr">name</span>: <span class="string">'docs'</span>,
    <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">'.deploy_git/docs'</span>),
    <span class="attr">url</span>: <span class="string">'https://github.com/dimaslanjaka/docs'</span>,
    <span class="attr">ref</span>: <span class="string">'master'</span>
  },
  {
    <span class="attr">name</span>: <span class="string">'chimeraland'</span>,
    <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">'.deploy_git/chimeraland'</span>),
    <span class="attr">url</span>: <span class="string">'https://github.com/dimaslanjaka/chimeraland'</span>,
    <span class="attr">ref</span>: <span class="string">'gh-pages'</span>
  },
  {
    <span class="attr">name</span>: <span class="string">'page'</span>,
    <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">'.deploy_git/page'</span>),
    <span class="attr">url</span>: <span class="string">'https://github.com/dimaslanjaka/page'</span>,
    <span class="attr">ref</span>: <span class="string">'gh-pages'</span>
  }
];

<span class="title function_">iterateSeries</span>(
  deployInfo,
  <span class="keyword">function</span> (<span class="params">info</span>) {
    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`writing <span class="subst">${info.dest}</span>`</span>);
  },
  <span class="keyword">function</span> (<span class="params">err</span>) {
    <span class="keyword">if</span> (err) {
      <span class="variable language_">console</span>.<span class="title function_">error</span>(err);
      process.<span class="title function_">exit</span>(<span class="number">1</span>);
    }
  }
);</code></pre>
<ul>
<li><a href="https://www.webmanajemen.com/page/safelink.html?url=aHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL3BsYXk/bm9JbXBsaWNpdFRoaXM9ZmFsc2UmYW1wO3RhcmdldD0yJmFtcDtqc3g9MSZhbXA7bW9kdWxlPTEmYW1wO2FsbG93U3ludGhldGljRGVmYXVsdEltcG9ydHM9dHJ1ZSNjb2RlL0pZV3dEZzlnVGdMZ0JHQWhqQUZuQVpsQ0k0SEltcTREY0FVQ1FQUUJVbEpjbGNBZ25BTWFJQTJiQVJvc3dOWnpjQXpnRk1BSmhnQ3VBTzJZeGdFS1hGVEk0N05oQUR1Z3BSRGpBWXdxTW1Gd0lBTjBPcVdFRHNObnlwdGVvaW5pd2g5TkJ5SkJBVHhrb1dGSVFFdG84Y2dyYUNuRENGbEMrTVd6Q0lNSlNNQUIwY0FBcUtDWmdXTXpDZ29MQVVnRG1lb0pPY0tJS0pzRGFJbERBUlFBMGNJSzZMb25KcWZBTkhUQ0lzR0ttVW13SkdybUtxSGxRc2ZLaFk4TFZLRDRDd3FuVzRFa0dvcGtBa29xc0lxYm9NVkJZVUVxNWNGTTJjeENGeGFVVkE2VUdseEpnZTlYQ3d4TlZLNGJpWkRGZEtnZ3NFZ3lzWnhEQmRMTU1LVjJBQmhOVGNQZzZPQzdFRXNOU0dhcWlPekFJbHdGQ2FMRnJWeEpQUVpKejB1aHdBQUNTQ01PR1lOaVM5bWlBRnBzcmN5cWxETUJtS3BMb2dFaEJ6c0lraWswdHA0YlRETVpUSEZxaXpob2djUHBsZkNvR2lPQmorSHljaVpXSWFlUHdoS04wTkp1VE0xdkFOTUFPTlU0TzZQUnM0S0ZSb3I4azhpZ3Jic3dKSmMrajA1WFRHWjZQUWQ0UE5Dc0FMRUd6YUg1bWtJK0gxdWhnRkJCUEJXVnErcFlYT0pFSGlMWHczVEhWSTA3QW8zSnFVcDlNcWFLMXhMWEFwSnRSQXJkSng2bEl6QkJlTDdkS1ZSQ0xqTldZNGpVdUlwYmlmUDVtSUVGQ0Z0UDduaVZ5b2Q0S3hGQVAyNk1rQzl5a0NaNTZ3ZEJhMGk4d1dtOEpQbGotZENWZDFyMUFBSlRxd3M0SE5TS2k2S2RueVRDMmpJRVFPaW9Bem1razRoVEZzYWdncGVIbzZpQTJockJZR3hiRnVnYWpEZUNHS0IrbHczazhJWmh2c2NBSE9jeEZYQ2g3cGtXbXZxM09COXAzQzZiQmVxVXc2anZCK2hvT1dPNWxEU3d4bEJJa2IwWEE4ejVFVWZTdkxpbjdwRTQ1QWtCeVVqNWtxUmdHQUF5c0tSUndBQXZIQUFBOFdReEFBSGdZcmhoRkl2Z0FOb0FMb0FId0FCUzBOWXRqMmdBWE5rclR1VHFXblFBYUhaOEY1N251Z0FQbkFMa3VlUjZZd0FBb3JLZlErVmtkbFNPSkE1UUE1N1MxTjJQa3Vla1JXaVlJUGt1UFpEbGZvWlRsQXI0VlVHVFY1VS1wNlVVeFhGZlJKYjBhU3BlbG1XR0RsTlIxQVZSWHBDVlpXMlk1OVdOYlpVMXdBQUNsZ0lBTk1JQUF5d0Nqc1o1Vk9WK2ZudWdCUUdWcndCVmdnQS1ENUNVa2QrMVcxWEFVVUxkZ3kxclJ0VzBrTE5BRGU3bHFScCtZUUdBWUN2SE5FQWZJWkhsY3BCNlJKT1VxQ2tPNXJHUVpweGd1Uk93am1UNUdVZ0ZsVlVmWjY1RGtOWTZrUEJERUJsQzV1RDZMZzdUSStaWDZrSjZ3RG5FanJnbzRaQmxHVDlmMEEwRGFSWStGSHE0LWpuUkpFVEpPNFB0YkM0RFR2UHV2TU1DaG9vWXZCVWFMbVM1NkFDK2lTbk5qTVpmZnVURVprWkhLZVpCZGxVdzV0TXhqaXNHakVaNkRzQ0k1dWVqcmczZGlEY01PTkZwM25aZHQzZWt6QUZpRHpOYnVsYjRoR1RBVUFTTUlEc3h2VEh1WElIUWZTMCtjdElvQmJDSzVhTGxnaXJRZXEyUWljeXluQVdJMVRjQUFOUndBQWpEbmF2Uis2c2RJNTh5QkJjQm1LbFBtTGlGSXU5MUxTSUNjMXNYZW9aM3dzVjZ6QXVWMUYrNlN6RklMbDVjSU5jZXVyTXFhMUxxRk4wUHJlOEtQWVpwQlAzYUwrNmVjRHd6QUNFSWRWZlB5dlI4ZmNCNS01Ry1DQzVBQU1rdXF6RC1PaElnZ29kRnFZQkpGVUoyUkotNFFGOEVjVHdJTTdMdVMxdTZRQ0tRZks0Q3dCQUdBRk5lWkVuekQ1QWdLQjBnQUNzdVl1UUFQb0VNbkZBT0J3aDJpNEhTTUE5UXZnQ0ZsSEpqdFhtb1kyQUlKUURBR0FZQlNxNDNvYWdDUW5CMGdjaEFPUVNjSUFmQnNCY0RneEF2QkVEQ05BR0lpUlVqRURwQjRTZ1BoNlI1Q29NOVBNZEFDRFJINWtNTGdkeXF0ZHB3QmdWMklzQ0Rhak1FRUpvajA2Q1lDWU9RTmd2QnBSQ0hFTnpHUWloVkRoQWdOb1R3NFJUd2JHTU05TXcxaDdET0ZlVzRmeE5SZ2paRjZQRVZJU1IwaUFuV05zVW5IUmVBOUdmRU1VZkV4Wml5RUlOWEtBWlVDVFJCcEpxRVVCeENBbkc0UHdVUWtobmk4RGVOOFhRLVE1QWlrcENNS1VpV0pqM1NoTHdHd2poWER5QXFKaWRnT0o4akVtS1BhU2dZcFhUU3psTzBRZ3NvS0FlVFFpS0RrdStlVGVZRkx3T3M4cDlqSEdvRnFhNCtwSGlpeGVPb2FBMXBNQnlEN09DUjZmcHVCQmtSS2lidy1oc1NSR1RLU1RJLVp2U3BMQ0F5YmdGWmF6djRiS01TUU0yWkJCN0NGMHMwSW9ibDNSWExBVklUd0ppM2JSRVpwNGZ1QXRDYnFCSmdBQXcwTTBPUTU0QUFrYjFTaWVHOGZtVldCS2M3R05obmFlR1dkNDZtTjVnM2JPN0theGZVSnArVmwzNDY2UWdETVVkSUtOOUF1V3JqZkNGTk1nQQ==" rel="external nofollow noreferrer">typescript playground</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.webmanajemen.com/page/safelink.html?url=aHR0cHM6Ly9ydW5raXQuY29tL2RpbWFzbGFuamFrYS82NDZkM2YzMjA0OTg3MDAwMDg3NTczNjQ=">javascript playground</a></li>
</ul>
<h2 id="Live-Playground">Live Playground</h2>
<script src="https://embed.runkit.com" data-element-id="6d970065551ff88a95fe634bd4565044"></script><div id="6d970065551ff88a95fe634bd4565044">const path_1 = require("path")
/**
 * A callback based function that allows to iterate over a collection
 * and perform asynchronous actions on every element. The processing is
 * done is series, so an element is started only when the previous one
 * has been completed. In case of error the whole processing is interrupted
 * early and the error is propagated to the finalCallback to let the caller
 * decide how to handle it.
 *
 *
 * @param collection - The generic array of elements to iterate over
 * @param iteratorCallback - The callback based function that will
 *        be used to process the current element.
 *        It receives the current element as first paramenter and a callback
 *        as second parameter. The callback needs to be invoked to indicate
 *        the end of the asynchronous processing. It can be called passing an
 *        error as first parameter to propagate an error)
 * @param finalCallback - A function that is called when all the
 *        items have been processed or when an error occurred. If an error
 *        occurred the function will be invoked with a single argument
 *        representing the error.
 */
const iterateSeries = (collection, iteratorCallback, finalCallback) =&gt; {
    const stoppingPoint = collection.length;
    function iterate(index) {
        // console.log('it', index);
        if (index === stoppingPoint) {
            // console.log('final');
            return finalCallback();
        }
        else {
            const current = collection[index];
            let called = false;
            const done = function (err) {
                called = true;
                if (err) {
                    return finalCallback(err);
                }
                return iterate(index + 1);
            };
            if (iteratorCallback instanceof Promise) {
                iteratorCallback(current, done).then(done);
            }
            else {
                iteratorCallback(current, done);
            }
            if (!called)
                done();
        }
    }
    iterate(0);
};
// usage samples
const deployInfo = [
    {
        name: 'root',
        dest: path_1.join(__dirname, '.deploy_git'),
        url: 'https://github.com/dimaslanjaka/dimaslanjaka.github.io',
        ref: 'master'
    },
    {
        name: 'docs',
        dest: path_1.join(__dirname, '.deploy_git/docs'),
        url: 'https://github.com/dimaslanjaka/docs',
        ref: 'master'
    },
    {
        name: 'chimeraland',
        dest: path_1.join(__dirname, '.deploy_git/chimeraland'),
        url: 'https://github.com/dimaslanjaka/chimeraland',
        ref: 'gh-pages'
    },
    {
        name: 'page',
        dest: path_1.join(__dirname, '.deploy_git/page'),
        url: 'https://github.com/dimaslanjaka/page',
        ref: 'gh-pages'
    }
];
iterateSeries(deployInfo, function (info) {
    console.log(`writing ${info.dest}`);
}, function (err) {
    if (err) {
        console.error(err);
        process.exit(1);
    }
});</div>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/chimeraland/monsters/zebrafish.html" title="Monster Zebrafish"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: Monster Zebrafish</span></a><a class="button is-default" href="/chimeraland/monsters/fire-lobcray.html" title="Monster fire lobcray"><span class="has-text-weight-semibold">Next: Monster fire lobcray</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><!--section.related-posts= getRelatedPost(page)--><div id="disqus_thread"></div><article class="mt-6 comment-container" id="disqus"><script>var disqus_config = function () { this.page.url = 'https://www.webmanajemen.com/2023/05/asynchronous-serial-iteration-over-an-array-collection.html'; this.page.identifier = 'dimaslanjaka'; this.page.title = document.title; };</script><script>(function() {var d = document, s = d.createElement('script');s.src = '//dimaslanjaka.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script><script id="dsq-count-scr" src="//blog-pubgj2togw.disqus.com/count.js" async=""></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/dimaslanjaka"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//dimaslanjaka1"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Dimas Lanjaka 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap hidden"><p>Powered by Hexo |&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" href="//github.com/haojen" rel="nofollow noopener noopener">Theme by Haojen&nbsp;</a><a title="Hexo theme contributor" target="_blank" href="//github.com/dimaslanjaka" rel="nofollow noopener noopener">Modded by L3n4r0x&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" href="https://www.webmanajemen.com/page/safelink.html?url=aHR0cHM6Ly9naXRodWIuY29tL0hhb2plbi9oZXhvLXRoZW1lLUNsYXVkaWE=" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true" rel="nofollow noopener noopener"></a></div></div><div><span></span></div></footer><!-- script(async defer src="//buttons.github.io/buttons.js")--><script src="//www.webmanajemen.com/page/assets/js/r-ads.js" type="text/javascript"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script>
<script src="/hexo-shortcodes-lib/githubcard.js"></script>
<link rel="stylesheet" href="/hexo-shortcodes-lib/gist.css">

      </body></html>