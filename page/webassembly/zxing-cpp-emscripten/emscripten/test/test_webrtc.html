<html><body><script async src="../../build/zxing.js"></script><div id="scanned"></div><script>var image,last=Date.now(),DEBUG=0,tick=function(){window.ZXing?(ZXing=ZXing(),testZXing()):setTimeout(tick,10)};function log(){var t,e;DEBUG&&(t=Date.now(),(e=Array.prototype.slice.call(arguments)).unshift("+"+(t-last)+"ms"),console.log.apply(console,e),last=t)}function testZXing(){var o=document.createElement("video");o.autoplay=!0,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;function t(t){console.log("Can't access user media",t)}navigator.getUserMedia?navigator.getUserMedia({audio:!1,video:{mandatory:{maxWidth:640,maxHeight:480}}},function(t){console.log("success",t),o.src=window.URL.createObjectURL(t),o.onclick=function(){o.play()},o.play();var n=ZXing.Runtime.addFunction(function(t,e,i,a,n,o,r,l,d,c,g,s){e=new Uint8Array(ZXing.HEAPU8.buffer,t,e),e=String.fromCharCode.apply(null,e);0===i&&(window.resultString=""),window.resultString+=e+"<br>",ctx.fillStyle="red",ctx.fillRect(n-5,o-5,10,10),ctx.fillStyle="green",ctx.fillRect(r-5,l-5,10,10),ctx.fillStyle="blue",ctx.fillRect(d-5,c-5,10,10),ctx.fillStyle="purple",ctx.fillRect(g-5,s-5,10,10)});!function t(){if(requestAnimationFrame(t),o.videoWidth){if(!image){width=o.videoWidth,height=o.videoHeight,log("video",width,height,o);var e=document.createElement("canvas");return e.width=width,e.height=height,e.style.transform="scale(-1, 1)",ctx=e.getContext("2d"),document.body.appendChild(e),log("start"),void log("_xsetup",image=ZXing._resize(width,height),"pointer")}log("interval"),console.time("a"),ctx.drawImage(o,0,0,width,height),e=ctx.getImageData(0,0,width,height),data=e.data;for(var i=0,a=0;i<data.length;i+=4,a++)ZXing.HEAPU8[image+a]=.2989*data[i+0]+.587*data[i+1]+.114*data[i+2];e=(e=ZXing._decode_qr_multi(n))?"error: "+e:window.resultString,scanned.innerHTML=e,console.timeEnd("a")}}()},t):t("")}tick()</script></body></html>