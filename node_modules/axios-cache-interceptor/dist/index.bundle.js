!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AxiosCacheInterceptor=t():e.AxiosCacheInterceptor=t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";var e={d:function(t,r){for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Header:function(){return i},buildKeyGenerator:function(){return M},buildMemoryStorage:function(){return O},buildStorage:function(){return A},buildWebStorage:function(){return L},canStale:function(){return C},createCacheResponse:function(){return g},createValidateStatus:function(){return h},defaultHeaderInterpreter:function(){return s},defaultKeyGenerator:function(){return P},defaultRequestInterceptor:function(){return m},defaultResponseInterceptor:function(){return w},isExpired:function(){return I},isMethodIn:function(){return v},isStorage:function(){return x},setupCache:function(){return k},testCachePredicate:function(){return b},updateCache:function(){return y},updateStaleRequest:function(){return p}});var r=Symbol("cache-parser");function a(e){return("string"==typeof e||"number"==typeof e)&&(e=Number(e))>=0&&e<1/0}function n(e){return!0===e||"number"==typeof e||"string"==typeof e&&"false"!==e}var o=Number;function c(e){var t=Object.defineProperty({},r,{enumerable:!1,value:1});if(!e||"string"!=typeof e)return t;var c=function(e){var t={},r=e.toLowerCase().replace(/\s+/g,"").split(",");for(var a in r){var n,o=r[a].split("=",2);t[o[0]]=null==(n=o[1])||n}return t}(e),i=c["max-age"],s=c["max-stale"],u=c["min-fresh"],d=c["s-maxage"],l=c["stale-if-error"],f=c["stale-while-revalidate"];return n(c.immutable)&&(t.immutable=!0),a(i)&&(t.maxAge=o(i)),a(s)&&(t.maxStale=o(s)),a(u)&&(t.minFresh=o(u)),n(c["must-revalidate"])&&(t.mustRevalidate=!0),n(c["must-understand"])&&(t.mustUnderstand=!0),n(c["no-cache"])&&(t.noCache=!0),n(c["no-store"])&&(t.noStore=!0),n(c["no-transform"])&&(t.noTransform=!0),n(c["only-if-cached"])&&(t.onlyIfCached=!0),n(c.private)&&(t.private=!0),n(c["proxy-revalidate"])&&(t.proxyRevalidate=!0),n(c.public)&&(t.public=!0),a(d)&&(t.sMaxAge=o(d)),a(l)&&(t.staleIfError=o(l)),a(f)&&(t.staleWhileRevalidate=o(f)),t}var i=Object.freeze({IfModifiedSince:"if-modified-since",LastModified:"last-modified",IfNoneMatch:"if-none-match",CacheControl:"cache-control",Pragma:"pragma",ETag:"etag",Expires:"expires",Age:"age",XAxiosCacheEtag:"x-axios-cache-etag",XAxiosCacheLastModified:"x-axios-cache-last-modified",XAxiosCacheStaleIfError:"x-axios-cache-stale-if-error"}),s=function(e){if(!e)return"not enough headers";var t=e[i.CacheControl];if(t){var r=c(String(t)),a=r.noCache,n=r.noStore,o=r.maxAge,s=r.maxStale,u=r.immutable,d=r.staleWhileRevalidate;if(a||n)return"dont cache";if(u)return{cache:31536e6};if(void 0!==o){var l=e[i.Age];return{cache:l?1e3*(o-Number(l)):1e3*o,stale:void 0!==s?1e3*s:void 0!==d?1e3*d:void 0}}}var f=e[i.Expires];if(f){var h=Date.parse(String(f))-Date.now();return h>=0?{cache:h}:"dont cache"}return"not enough headers"};var u=function(){return u=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},u.apply(this,arguments)};function d(e,t,r,a){return new(r||(r=Promise))((function(n,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,i)}s((a=a.apply(e,t||[])).next())}))}function l(e,t){var r,a,n,o,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(c=0)),c;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,a=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(n=c.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){c.label=i[1];break}if(6===i[0]&&c.label<n[1]){c.label=n[1],n=i;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(i);break}n[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}Object.create;Object.create;var f=Symbol();function h(e){return e?function(t){return e(t)||304===t}:function(e){return e>=200&&e<300||304===e}}function v(e,t){return void 0===e&&(e="get"),void 0===t&&(t=[]),e=e.toLowerCase(),t.some((function(t){return t===e}))}function p(e,t){var r;t.headers||(t.headers={});var a=t.cache,n=a.etag,o=a.modifiedSince;if(n){var c=!0===n?null===(r=e.data)||void 0===r?void 0:r.headers[i.ETag]:n;c&&(t.headers[i.IfNoneMatch]=c)}o&&(t.headers[i.IfModifiedSince]=!0===o?e.data.headers[i.LastModified]||new Date(e.createdAt).toUTCString():o.toUTCString())}function g(e,t){return 304===e.status&&t?(e.cached=!0,e.data=t.data,e.status=t.status,e.statusText=t.statusText,e.headers=u(u({},t.headers),e.headers),t):{data:e.data,status:e.status,statusText:e.statusText,headers:e.headers}}function m(e){var t=this,r=function(r){return d(t,void 0,void 0,(function(){var t,a,n,o,c,s,d,g,m,b,y,w,x,S,C,I,A,O,j,E;return l(this,(function(l){switch(l.label){case 0:return t=r.id=e.generateKey(r),!1===r.cache?[2,r]:(r.cache=u(u({},e.defaults.cache),r.cache),r.cache.cacheTakeover&&(null!==(s=(C=r.headers)[I=i.CacheControl])&&void 0!==s||(C[I]="no-cache"),null!==(d=(A=r.headers)[O=i.Pragma])&&void 0!==d||(A[O]="no-cache"),null!==(g=(j=r.headers)[E=i.Expires])&&void 0!==g||(j[E]="0")),v(r.method,r.cache.methods)?[4,e.storage.get(t,r)]:[2,r]);case 1:return a=l.sent(),n=r.cache.override,"empty"===a.state||"stale"===a.state||n?!e.waiting[t]||n?[3,3]:[4,e.storage.get(t,r)]:[3,7];case 2:if("empty"!==(a=l.sent()).state)return[3,7];l.label=3;case 3:return e.waiting[t]=function(){var e,t,r=new Promise((function(r,a){e=r,t=a}));return r.resolve=e,r.reject=t,r[f]=1,r}(),e.waiting[t].catch((function(){})),[4,e.storage.set(t,{state:"loading",previous:n?a.data?"stale":"empty":a.state,data:a.data,createdAt:n&&!a.createdAt?Date.now():a.createdAt},r)];case 4:return l.sent(),"stale"===a.state&&p(a,r),r.validateStatus=h(r.validateStatus),"stale"===a.state||a.data?[4,null===(b=(m=r.cache).hydrate)||void 0===b?void 0:b.call(m,a)]:[3,6];case 5:l.sent(),l.label=6;case 6:return[2,r];case 7:return"loading"!==a.state?[3,18]:(c=e.waiting[t])?[3,11]:[4,e.storage.remove(t,r)];case 8:return l.sent(),a.data?[4,null===(w=(y=r.cache).hydrate)||void 0===w?void 0:w.call(y,a)]:[3,10];case 9:l.sent(),l.label=10;case 10:return[2,r];case 11:0,l.label=12;case 12:return l.trys.push([12,14,,17]),[4,c];case 13:return o=l.sent(),[3,17];case 14:return l.sent(),a.data?[4,null===(S=(x=r.cache).hydrate)||void 0===S?void 0:S.call(x,a)]:[3,16];case 15:l.sent(),l.label=16;case 16:return[2,r];case 17:return[3,19];case 18:o=a.data,l.label=19;case 19:return r.adapter=function(){return Promise.resolve({config:r,data:o.data,headers:o.headers,status:o.status,statusText:o.statusText,cached:!0,id:t})},[2,r]}}))}))};return{onFulfilled:r,apply:function(){return e.interceptors.request.use(r)}}}function b(e,t){var r;return d(this,void 0,void 0,(function(){var a,n,o,c,i,s,u,d,f,h;return l(this,(function(l){switch(l.label){case 0:return"function"==typeof t?[2,t(e)]:(a=t.statusCheck,n=t.responseMatch,o=t.containsHeaders,(i=a)?[4,a(e.status)]:[3,2]);case 1:i=!l.sent(),l.label=2;case 2:return(c=i)?[3,5]:(s=n)?[4,n(e)]:[3,4];case 3:s=!l.sent(),l.label=4;case 4:c=s,l.label=5;case 5:if(c)return[2,!1];if(!o)return[3,9];u=0,d=Object.entries(o),l.label=6;case 6:return u<d.length?(f=d[u],h=f[0],[4,(0,f[1])(null!==(r=e.headers[h.toLowerCase()])&&void 0!==r?r:e.headers[h])]):[3,9];case 7:if(!l.sent())return[2,!1];l.label=8;case 8:return u++,[3,6];case 9:return[2,!0]}}))}))}function y(e,t,r){return d(this,void 0,void 0,(function(){var a,n,o,c,i,s,u;return l(this,(function(d){switch(d.label){case 0:if("function"==typeof r)return[2,r(t)];a=0,n=Object.entries(r),d.label=1;case 1:return a<n.length?(o=n[a],c=o[0],"delete"!==(i=o[1])?[3,3]:[4,e.remove(c,t.config)]):[3,10];case 2:return d.sent(),[3,9];case 3:return[4,e.get(c,t.config)];case 4:return"loading"===(s=d.sent()).state?[3,9]:[4,i(s,t)];case 5:return"delete"!==(u=d.sent())?[3,7]:[4,e.remove(c,t.config)];case 6:return d.sent(),[3,9];case 7:return"ignore"===u?[3,9]:[4,e.set(c,u,t.config)];case 8:d.sent(),d.label=9;case 9:return a++,[3,1];case 10:return[2]}}))}))}function w(e){var t=this,r=function(r,a){return d(t,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return[4,e.storage.remove(r,a)];case 1:return n.sent(),null===(t=e.waiting[r])||void 0===t||t.reject(),delete e.waiting[r],[2]}}))}))},a=function(a){return d(t,void 0,void 0,(function(){var t,n,o,c,s,d,f,h,p,m,w,x,S,C,I,A,O;return l(this,(function(l){switch(l.label){case 0:return a.config,t=a.id=null!==(I=(O=a.config).id)&&void 0!==I?I:O.id=e.generateKey(a.config),null!==(A=a.cached)&&void 0!==A||(a.cached=!1),a.cached?[2,a]:(n=a.config,(o=n.cache)?o.update?[4,y(e.storage,a,o.update)]:[3,2]:[2,u(u({},a),{cached:!1})]);case 1:l.sent(),l.label=2;case 2:return v(n.method,o.methods)?[4,e.storage.get(t,n)]:[2,a];case 3:return"loading"!==(c=l.sent()).state?[2,a]:(s=!c.data)?[4,b(a,o.cachePredicate)]:[3,5];case 4:s=!l.sent(),l.label=5;case 5:return s?[4,r(t,n)]:[3,7];case 6:return l.sent(),[2,a];case 7:for(d=0,f=Object.keys(a.headers);d<f.length;d++)(h=f[d]).startsWith("x-axios-cache")&&delete a.headers[h];return o.etag&&!0!==o.etag&&(a.headers[i.XAxiosCacheEtag]=o.etag),o.modifiedSince&&(a.headers[i.XAxiosCacheLastModified]=!0===o.modifiedSince?"use-cache-timestamp":o.modifiedSince.toUTCString()),p=o.ttl||-1,o.interpretHeader?"dont cache"!==(w=e.headerInterpreter(a.headers))?[3,9]:[4,r(t,n)]:[3,10];case 8:return l.sent(),[2,a];case 9:"not enough headers"!==w&&("number"==typeof w?p=w:(p=w.cache,m=w.stale)),l.label=10;case 10:return x=g(a,c.data),"function"!=typeof p?[3,12]:[4,p(a)];case 11:p=l.sent(),l.label=12;case 12:return o.staleIfError&&(a.headers[i.XAxiosCacheStaleIfError]=String(p)),S={state:"cached",ttl:p,staleTtl:m,createdAt:Date.now(),data:x},(C=e.waiting[t])&&(C.resolve(S.data),delete e.waiting[t]),[4,e.storage.set(t,S,n)];case 13:return l.sent(),[2,a]}}))}))},n=function(a){return d(t,void 0,void 0,(function(){var t,n,o,s,u,d,f,h,p,g;return l(this,(function(l){switch(l.label){case 0:if(t=a.config,n=t.id,o=t.cache,s=a.response,!o||!n)throw a;if(!v(t.method,o.methods))throw a;return[4,e.storage.get(n,t)];case 1:return"loading"===(u=l.sent()).state&&"stale"===u.previous?[3,3]:[4,r(n,t)];case 2:throw l.sent(),a;case 3:return o.staleIfError?(d=String(null==s?void 0:s.headers[i.CacheControl]),f=d&&c(d).staleIfError,"function"!=typeof o.staleIfError?[3,5]:[4,o.staleIfError(s,u,a)]):[3,8];case 4:return p=l.sent(),[3,6];case 5:p=!0===o.staleIfError&&f?1e3*f:o.staleIfError,l.label=6;case 6:return!0===(h=p)||"number"==typeof h&&u.createdAt+h>Date.now()?(null===(g=e.waiting[n])||void 0===g||g.resolve(u.data),delete e.waiting[n],[4,e.storage.set(n,{state:"stale",createdAt:Date.now(),data:u.data},t)]):[3,8];case 7:return l.sent(),[2,{cached:!0,config:t,id:n,data:u.data.data,headers:u.data.headers,status:u.data.status,statusText:u.data.statusText}];case 8:throw a}}))}))};return{onFulfilled:a,onRejected:n,apply:function(){return e.interceptors.response.use(a,n)}}}var x=function(e){return!!e&&!!e["is-storage"]};function S(e){var t=e.data.headers;return i.ETag in t||i.LastModified in t||i.XAxiosCacheEtag in t||i.XAxiosCacheLastModified in t}function C(e){return!String(e.data.headers[i.CacheControl]).includes("must-revalidate")&&(!!S(e)||"cached"===e.state&&void 0!==e.staleTtl&&Math.abs(Date.now()-(e.createdAt+e.ttl))<=e.staleTtl)}function I(e){return void 0!==e.ttl&&e.createdAt+e.ttl<=Date.now()}function A(e){var t,r=this,a=e.set,n=e.find,o=e.remove;return(t={})["is-storage"]=1,t.set=a,t.remove=o,t.get=function(e,t){return d(r,void 0,void 0,(function(){var r;return l(this,(function(c){switch(c.label){case 0:return[4,n(e,t)];case 1:return(r=c.sent())?"empty"===r.state||"loading"===r.state?[2,r]:"cached"!==r.state?[3,5]:I(r)?C(r)?[3,3]:[4,o(e,t)]:[2,r]:[2,{state:"empty"}];case 2:return c.sent(),[2,{state:"empty"}];case 3:return r={state:"stale",createdAt:r.createdAt,data:r.data,ttl:void 0!==r.staleTtl?r.staleTtl+r.ttl:void 0},[4,a(e,r,t)];case 4:c.sent(),c.label=5;case 5:return I(r)?S(r)?[2,r]:[4,o(e,t)]:[2,r];case 6:return c.sent(),[2,{state:"empty"}]}}))}))},t}function O(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===r&&(r=!1);var a=A({set:function(e,t){if(r){var n=Object.keys(a.data);if(n.length>=r)for(a.cleanup(),n=Object.keys(a.data);n.length>=r;)delete a.data[n.shift()]}a.data[e]=t},remove:function(e){delete a.data[e]},find:function(t){var r=a.data[t];return e&&void 0!==r?"function"==typeof structuredClone?structuredClone(r):JSON.parse(JSON.stringify(r)):r}});return a.data=Object.create(null),a.cleanup=function(){for(var e,t,r=Object.keys(a.data),n=-1;++n<r.length;)t=r[n],"empty"!==(e=a.data[t]).state?"cached"===e.state&&I(e)&&!C(e)&&a.remove(t):a.remove(t)},t&&(a.cleaner=setInterval(a.cleanup,t)),a}function j(e){var t=typeof e;if(e&&"object"===t&&!(e instanceof Date||e instanceof RegExp)){for(var r=Array.isArray(e)?[]:{},a=Object.keys(e).sort((function(e,t){return e>t?1:-1})),n=a.length;n--;){var o=a[n];r[o]=j(e[o])}return String(e.constructor)+JSON.stringify(r,a)}return t+String(e)}function E(e){e=j(e);for(var t=5381,r=0;r<e.length;)t=33*t^e.charCodeAt(r++);return t}var T=/^\/|\/$/g;function M(e){return function(t){if(t.id)return t.id;var r=e(t);return"".concat("string"==typeof r||"number"==typeof r?r:E(r))}}var P=M((function(e){var t=e.baseURL,r=void 0===t?"":t,a=e.url,n=void 0===a?"":a,o=e.method,c=void 0===o?"get":o,i=e.params,s=e.data;return r&&(r=r.replace(T,"")),n&&(n=n.replace(T,"")),c&&(c=c.toLowerCase()),{url:r+(r&&n?"/":"")+n,params:i,method:c,data:s}}));function k(e,t){var r,a,n,o,c,i;void 0===t&&(t={});var u=e;if(u.defaults.cache)throw new Error("setupCache() should be called only once");if(u.storage=t.storage||O(),!x(u.storage))throw new Error("Use buildStorage() function");return u.waiting=t.waiting||{},u.generateKey=t.generateKey||P,u.headerInterpreter=t.headerInterpreter||s,u.requestInterceptor=t.requestInterceptor||m(u),u.responseInterceptor=t.responseInterceptor||w(u),u.debug=t.debug,u.defaults.cache={update:t.update||{},ttl:null!==(r=t.ttl)&&void 0!==r?r:3e5,methods:t.methods||["get","head"],cachePredicate:t.cachePredicate||{statusCheck:function(e){return[200,203,300,301,302,404,405,410,414,501].includes(e)}},etag:null===(a=t.etag)||void 0===a||a,modifiedSince:null!==(n=t.modifiedSince)&&void 0!==n?n:!1===t.etag,interpretHeader:null===(o=t.interpretHeader)||void 0===o||o,cacheTakeover:null===(c=t.cacheTakeover)||void 0===c||c,staleIfError:null===(i=t.staleIfError)||void 0===i||i,override:!1,hydrate:void 0},u.requestInterceptor.apply(),u.responseInterceptor.apply(),u}function L(e,t){return void 0===t&&(t="axios-cache-"),A({find:function(r){var a=e.getItem(t+r);return a?JSON.parse(a):void 0},remove:function(r){e.removeItem(t+r)},set:function(r,a){var n=function(){return e.setItem(t+r,JSON.stringify(a))};try{return n()}catch(a){for(var o=Object.entries(e).filter((function(e){return e[0].startsWith(t)})).map((function(e){return[e[0],JSON.parse(e[1])]})),c=0,i=o;c<i.length;c++){var s=i[c];"cached"===s[1].state&&I(s[1])&&!C(s[1])&&e.removeItem(s[0])}try{return n()}catch(t){for(var u=o.sort((function(e,t){return(e[1].createdAt||0)-(t[1].createdAt||0)})),d=0,l=u;d<l.length;d++){var f=l[d];e.removeItem(f[0]);try{return n()}catch(e){}}}e.removeItem(t+r)}}})}return t}()}));