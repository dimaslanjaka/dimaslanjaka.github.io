<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>How to remove thousands old unneeded commits</title><meta name="description" content="Removing old unneeded commits - saving disk space and making git clones faster"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><meta name="keywords" content="the legend of neverland, genshin impact, games, how to, tips and tricks, php, javascript, jquery, mysql, seo, e-commerce"><meta name="image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/2048px-No_image_available.svg.png"><meta name="original-source" content="https://www.webmanajemen.com/GitHub/delete-thousands-old-commits-github.html"><link rel="canonical" href="https://www.webmanajemen.com/GitHub/delete-thousands-old-commits-github.html"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="How to remove thousands old unneeded commits"><meta property="og:description" content="Removing old unneeded commits - saving disk space and making git clones faster"><meta property="og:url" content="https://www.webmanajemen.com/GitHub/delete-thousands-old-commits-github.html"><meta property="og:site_name" content="WMI"><meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/2048px-No_image_available.svg.png"><!--meta(property='og:image:secure_url' content=thumbnail)--><meta name="twitter:title" content="How to remove thousands old unneeded commits"><meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/2048px-No_image_available.svg.png"><meta name="twitter:description" content="Removing old unneeded commits - saving disk space and making git clones faster"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@WebsiteName"><!-- Google Analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q || []).push(arguments)},i[r].l=1 * new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-106238155-1', 'auto');
ga('send', 'pageview');</script><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="Say my git repo has 5,000 commits, how can I remove the first 4,000 commits that are quite old and no longer needed, in order to save disk space?

by Sebass van Boxel, Solutions Engineer at GitHub (2018-present)

First of all, I would try less destructive ways to clean up disk space in your git project. If you’re collaborating on a repository with others, .."><meta name="generator" content="Hexo 7.0.0-rc1"><link rel="alternate" href="/atom.xml" title="WMI" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="WMI" type="application/rss+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><!--a(href= url_for("/"))= (theme.user && theme.user.name || config.author) + "'s blog"--><a href="/">WMI</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">How to remove thousands old unneeded commits</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Say-my-git-repo-has-5-000-commits-how-can-I-remove-the-first-4-000-commits-that-are-quite-old-and-no-longer-needed-in-order-to-save-disk-space"><span class="toc-text">Say my git repo has 5,000 commits, how can I remove the first 4,000 commits that are quite old and no longer needed, in order to save disk space?</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/github"><i class="tag post-item-tag">github</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">How to remove thousands old unneeded commits</h1><time class="has-text-grey" datetime="2023-05-31T21:47:07.000Z">2023-06-01</time><article class="mt-2 post-content"><h2 id="Say-my-git-repo-has-5-000-commits-how-can-I-remove-the-first-4-000-commits-that-are-quite-old-and-no-longer-needed-in-order-to-save-disk-space">Say my git repo has 5,000 commits, how can I remove the first 4,000 commits that are quite old and no longer needed, in order to save disk space?</h2>
<blockquote>
<p>by Sebass van Boxel, Solutions Engineer at GitHub (2018-present)</p>
</blockquote>
<p>First of all, I would try less destructive ways to clean up disk space in your git project. If you’re collaborating on a repository with others, it’s considered a bad practice to rewrite published history. If you’ve already decided that this is what you want to do, please skip the first part.<br>
One of the great powers of Git is that it preserves all history. Often you only realize that you really needed that history when it isn’t there anymore.<br>
For new people that join your project, it can be of great value to know what happened for what reason, by “removing” those old commits, they’ll lose that context. My advice, before anything else, would be to run Git’s built-in housekeeping task:</p>
<pre><code class="highlight bash">git -gc</code></pre>
<p>More info on this, as well as the options it accepts, can be found in the Git manual: Git - git-gc Documentation</p>
<p>If your <code>.git</code>-folder is still too big there could be another issue, and that is that someone has checked in files/folder that should’ve been ignored, and are now part of your git history. Although Git is optimized for speed and reliability, and not for efficient use of disk space, it still is, quite efficient. Unless you accidentally commit directories/files that shouldn’t be part of your git history of course. Infamous examples are the <code>node_modules</code> and <code>vendor</code> directories. If that is the case, the following commands are here to help: (source)</p>
<pre><code class="highlight plaintext">git filter-branch --tree-filter 'rm -rf &lt;DIRECTORY_NAME&gt;' --prune-empty HEAD 
git for-each-ref --format="%(refname)" refs/original/ | xargs -n 1 git update-ref -d
echo &lt;DIRECTORY_NAME&gt;/ &gt;&gt; .gitignore 
git add .gitignore git commit -m 'Removing &lt;DIRECTORY_NAME&gt; from git history' 
git gc</code></pre>
<p>If, at this point, you’re still not content with your Git history and want to get rid of the history that is contained in your first x commits, you can squash them altogether. This will discard all the separate</p>
<p>First, find the commit hash of the last commit you want to keep.<br>
Check out that commit as an orphan in a new branch, this commit will have no parent and therefor no history.</p>
<pre><code class="highlight bash">git checkout --orphan tempBranch &lt;COMMIT_HASH&gt;</code></pre>
<p>Commit all the files in your project:</p>
<pre><code class="highlight bash">git add -all
git commit -m “Squashed all old commits”
Now, you can rebase all commits that came after the commit you’ve chosen <span class="keyword">in</span> step one, on top of this initial commit:
git rebase --onto tempBranch &lt;COMMIT_HASH&gt; master</code></pre>
<p>At this stage validate your project status and Git log output. If everything is okay you can overwrite the remote with the new history, and remove the tempBranch:</p>
<pre><code class="highlight bash">git push -f
git branch -D tempBranch
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/GitHub/git-detach-subfolder-to-their-own-repository.html" title="git detach subfolder to their own repository"><span class="has-text-weight-semibold">Next: git detach subfolder to their own repository</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><!--section.related-posts= getRelatedPost(page)--><div id="disqus_thread"></div><article class="mt-6 comment-container" id="disqus"><script>var disqus_config = function () { this.page.url = 'https://www.webmanajemen.com/GitHub/delete-thousands-old-commits-github.html'; this.page.identifier = 'dimaslanjaka'; this.page.title = document.title; };</script><script>(function() {var d = document, s = d.createElement('script');s.src = '//dimaslanjaka.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();</script><script id="dsq-count-scr" src="//blog-pubgj2togw.disqus.com/count.js" async=""></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/dimaslanjaka"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//dimaslanjaka1"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Dimas Lanjaka 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap hidden"><p>Powered by Hexo |&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" href="//github.com/haojen" rel="nofollow noopener noopener">Theme by Haojen&nbsp;</a><a title="Hexo theme contributor" target="_blank" href="//github.com/dimaslanjaka" rel="nofollow noopener noopener">Modded by L3n4r0x&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" href="https://www.webmanajemen.com/page/safelink.html?url=aHR0cHM6Ly9naXRodWIuY29tL0hhb2plbi9oZXhvLXRoZW1lLUNsYXVkaWE=" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true" rel="nofollow noopener noopener"></a></div></div><div><span></span></div></footer><!-- script(async defer src="//buttons.github.io/buttons.js")--><script src="//www.webmanajemen.com/page/assets/js/r-ads.js" type="text/javascript"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script>
<script src="/hexo-shortcodes-lib/githubcard.js"></script>
<link rel="stylesheet" href="/hexo-shortcodes-lib/gist.css">

      </body></html>