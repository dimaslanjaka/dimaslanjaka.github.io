!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AxiosCacheInterceptor=t():e.AxiosCacheInterceptor=t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";var e={d:function(t,r){for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Header:function(){return c},buildKeyGenerator:function(){return M},buildMemoryStorage:function(){return O},buildStorage:function(){return A},buildWebStorage:function(){return N},canStale:function(){return C},createCacheResponse:function(){return g},createValidateStatus:function(){return h},defaultHeaderInterpreter:function(){return s},defaultKeyGenerator:function(){return k},defaultRequestInterceptor:function(){return m},defaultResponseInterceptor:function(){return S},isExpired:function(){return I},isMethodIn:function(){return v},isStorage:function(){return w},setupCache:function(){return P},testCachePredicate:function(){return y},updateCache:function(){return b},updateStaleRequest:function(){return p}});var r=Symbol("cache-parser");function a(e){return("string"==typeof e||"number"==typeof e)&&(e=Number(e))>=0&&e<1/0}function n(e){return!0===e||"number"==typeof e||"string"==typeof e&&"false"!==e}var o=Number;function i(e){var t=Object.defineProperty({},r,{enumerable:!1,value:1});if(!e||"string"!=typeof e)return t;var i=function(e){var t={},r=e.toLowerCase().replace(/\s+/g,"").split(",");for(var a in r){var n,o=r[a].split("=",2);t[o[0]]=null==(n=o[1])||n}return t}(e),c=i["max-age"],s=i["max-stale"],u=i["min-fresh"],d=i["s-maxage"],l=i["stale-if-error"],f=i["stale-while-revalidate"];return n(i.immutable)&&(t.immutable=!0),a(c)&&(t.maxAge=o(c)),a(s)&&(t.maxStale=o(s)),a(u)&&(t.minFresh=o(u)),n(i["must-revalidate"])&&(t.mustRevalidate=!0),n(i["must-understand"])&&(t.mustUnderstand=!0),n(i["no-cache"])&&(t.noCache=!0),n(i["no-store"])&&(t.noStore=!0),n(i["no-transform"])&&(t.noTransform=!0),n(i["only-if-cached"])&&(t.onlyIfCached=!0),n(i.private)&&(t.private=!0),n(i["proxy-revalidate"])&&(t.proxyRevalidate=!0),n(i.public)&&(t.public=!0),a(d)&&(t.sMaxAge=o(d)),a(l)&&(t.staleIfError=o(l)),a(f)&&(t.staleWhileRevalidate=o(f)),t}var c=Object.freeze({IfModifiedSince:"if-modified-since",LastModified:"last-modified",IfNoneMatch:"if-none-match",CacheControl:"cache-control",Pragma:"pragma",ETag:"etag",Expires:"expires",Age:"age",XAxiosCacheEtag:"x-axios-cache-etag",XAxiosCacheLastModified:"x-axios-cache-last-modified",XAxiosCacheStaleIfError:"x-axios-cache-stale-if-error"}),s=function(e){if(!e)return"not enough headers";var t=e[c.CacheControl];if(t){var r=i(String(t)),a=r.noCache,n=r.noStore,o=r.maxAge,s=r.maxStale,u=r.immutable,d=r.staleWhileRevalidate;if(a||n)return"dont cache";if(u)return{cache:31536e6};if(void 0!==o){var l=e[c.Age];return{cache:l?1e3*(o-Number(l)):1e3*o,stale:void 0!==s?1e3*s:void 0!==d?1e3*d:void 0}}}var f=e[c.Expires];if(f){var h=Date.parse(String(f))-Date.now();return h>=0?{cache:h}:"dont cache"}return"not enough headers"};var u=function(){return u=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},u.apply(this,arguments)};function d(e,t,r,a){return new(r||(r=Promise))((function(n,o){function i(e){try{s(a.next(e))}catch(e){o(e)}}function c(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,c)}s((a=a.apply(e,t||[])).next())}))}function l(e,t){var r,a,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(r=1,a&&(n=2&c[0]?a.return:c[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,c[1])).done)return n;switch(a=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,a=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){i.label=c[1];break}if(6===c[0]&&i.label<n[1]){i.label=n[1],n=c;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(c);break}n[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],a=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;var f=Symbol();function h(e){return e?function(t){return e(t)||304===t}:function(e){return e>=200&&e<300||304===e}}function v(e,t){return void 0===e&&(e="get"),void 0===t&&(t=[]),e=e.toLowerCase(),t.some((function(t){return t===e}))}function p(e,t){var r;t.headers||(t.headers={});var a=t.cache,n=a.etag,o=a.modifiedSince;if(n){var i=!0===n?null===(r=e.data)||void 0===r?void 0:r.headers[c.ETag]:n;i&&(t.headers[c.IfNoneMatch]=i)}o&&(t.headers[c.IfModifiedSince]=!0===o?e.data.headers[c.LastModified]||new Date(e.createdAt).toUTCString():o.toUTCString())}function g(e,t){return 304===e.status&&t?(e.cached=!0,e.data=t.data,e.status=t.status,e.statusText=t.statusText,e.headers=u(u({},t.headers),e.headers),t):{data:e.data,status:e.status,statusText:e.statusText,headers:e.headers}}function m(e){var t=this,r=function(a){return d(t,void 0,void 0,(function(){var t,n,o,i,s,d,g,m,y,b,S,w,x,C,I,A,O,j,E;return l(this,(function(l){switch(l.label){case 0:return a.id=e.generateKey(a),!1===a.cache?[2,a]:(a.cache=u(u({},e.defaults.cache),a.cache),a.cache.cacheTakeover&&(null!==(s=(C=a.headers)[I=c.CacheControl])&&void 0!==s||(C[I]="no-cache"),null!==(d=(A=a.headers)[O=c.Pragma])&&void 0!==d||(A[O]="no-cache"),null!==(g=(j=a.headers)[E=c.Expires])&&void 0!==g||(j[E]="0")),v(a.method,a.cache.methods)?[4,e.storage.get(a.id,a)]:[2,a]);case 1:return t=l.sent(),n=a.cache.override,"empty"===t.state||"stale"===t.state||n?!e.waiting[a.id]||n?[3,3]:[4,e.storage.get(a.id,a)]:[3,7];case 2:if("empty"!==(t=l.sent()).state)return[3,7];l.label=3;case 3:return e.waiting[a.id]=function(){var e,t,r=new Promise((function(r,a){e=r,t=a}));return r.resolve=e,r.reject=t,r[f]=1,r}(),e.waiting[a.id].catch((function(){})),[4,e.storage.set(a.id,{state:"loading",previous:n?t.data?"stale":"empty":t.state,data:t.data,createdAt:n&&!t.createdAt?Date.now():t.createdAt},a)];case 4:return l.sent(),"stale"===t.state&&p(t,a),a.validateStatus=h(a.validateStatus),"stale"===t.state||t.data?[4,null===(y=(m=a.cache).hydrate)||void 0===y?void 0:y.call(m,t)]:[3,6];case 5:l.sent(),l.label=6;case 6:return[2,a];case 7:return"loading"!==t.state?[3,17]:(i=e.waiting[a.id])?[3,10]:t.data?[4,null===(S=(b=a.cache).hydrate)||void 0===S?void 0:S.call(b,t)]:[3,9];case 8:l.sent(),l.label=9;case 9:return[2,a];case 10:0,l.label=11;case 11:return l.trys.push([11,13,,16]),[4,i];case 12:return o=l.sent(),[3,16];case 13:return l.sent(),t.data?[4,null===(x=(w=a.cache).hydrate)||void 0===x?void 0:x.call(w,t)]:[3,15];case 14:l.sent(),l.label=15;case 15:return[2,r(a)];case 16:return[3,18];case 17:o=t.data,l.label=18;case 18:return a.adapter=function(){return Promise.resolve({config:a,data:o.data,headers:o.headers,status:o.status,statusText:o.statusText,cached:!0,id:a.id})},[2,a]}}))}))};return{onFulfilled:r,apply:function(){return e.interceptors.request.use(r)}}}function y(e,t){var r;return d(this,void 0,void 0,(function(){var a,n,o,i,c,s,u,d,f,h;return l(this,(function(l){switch(l.label){case 0:return"function"==typeof t?[2,t(e)]:(a=t.statusCheck,n=t.responseMatch,o=t.containsHeaders,(c=a)?[4,a(e.status)]:[3,2]);case 1:c=!l.sent(),l.label=2;case 2:return(i=c)?[3,5]:(s=n)?[4,n(e)]:[3,4];case 3:s=!l.sent(),l.label=4;case 4:i=s,l.label=5;case 5:if(i)return[2,!1];if(!o)return[3,9];u=0,d=Object.entries(o),l.label=6;case 6:return u<d.length?(f=d[u],h=f[0],[4,(0,f[1])(null!==(r=e.headers[h.toLowerCase()])&&void 0!==r?r:e.headers[h])]):[3,9];case 7:if(!l.sent())return[2,!1];l.label=8;case 8:return u++,[3,6];case 9:return[2,!0]}}))}))}function b(e,t,r){return d(this,void 0,void 0,(function(){var a,n,o,i,c,s,u;return l(this,(function(d){switch(d.label){case 0:if("function"==typeof r)return[2,r(t)];a=0,n=Object.entries(r),d.label=1;case 1:return a<n.length?(o=n[a],i=o[0],"delete"!==(c=o[1])?[3,3]:[4,e.remove(i,t.config)]):[3,10];case 2:return d.sent(),[3,9];case 3:return[4,e.get(i,t.config)];case 4:return"loading"===(s=d.sent()).state?[3,9]:[4,c(s,t)];case 5:return"delete"!==(u=d.sent())?[3,7]:[4,e.remove(i,t.config)];case 6:return d.sent(),[3,9];case 7:return"ignore"===u?[3,9]:[4,e.set(i,u,t.config)];case 8:d.sent(),d.label=9;case 9:return a++,[3,1];case 10:return[2]}}))}))}function S(e){var t=this,r=function(r,a){return d(t,void 0,void 0,(function(){var t;return l(this,(function(n){switch(n.label){case 0:return[4,e.storage.remove(r,a)];case 1:return n.sent(),null===(t=e.waiting[r])||void 0===t||t.reject(),delete e.waiting[r],[2]}}))}))},a=function(a){return d(t,void 0,void 0,(function(){var t,n,o,i,s,u,d,f,h,p,m,S,w,x;return l(this,(function(l){switch(l.label){case 0:if(!(null==a?void 0:a.config))throw a;return a.id=a.config.id,null!==(x=a.cached)&&void 0!==x||(a.cached=!1),t=a.config,n=t.cache,a.cached?[2,a]:n?n.update?[4,b(e.storage,a,n.update)]:[3,2]:(a.cached=!1,[2,a]);case 1:l.sent(),l.label=2;case 2:return v(t.method,n.methods)?[4,e.storage.get(a.id,t)]:[2,a];case 3:return"loading"!==(o=l.sent()).state?[2,a]:(i=!o.data)?[4,y(a,n.cachePredicate)]:[3,5];case 4:i=!l.sent(),l.label=5;case 5:return i?[4,r(a.id,t)]:[3,7];case 6:return l.sent(),[2,a];case 7:for(s=0,u=Object.keys(a.headers);s<u.length;s++)(d=u[s]).startsWith("x-axios-cache")&&delete a.headers[d];return n.etag&&!0!==n.etag&&(a.headers[c.XAxiosCacheEtag]=n.etag),n.modifiedSince&&(a.headers[c.XAxiosCacheLastModified]=!0===n.modifiedSince?"use-cache-timestamp":n.modifiedSince.toUTCString()),f=n.ttl||-1,n.interpretHeader?"dont cache"!==(p=e.headerInterpreter(a.headers))?[3,9]:[4,r(a.id,t)]:[3,10];case 8:return l.sent(),[2,a];case 9:"not enough headers"!==p&&("number"==typeof p?f=p:(f=p.cache,h=p.stale)),l.label=10;case 10:return m=g(a,o.data),"function"!=typeof f?[3,12]:[4,f(a)];case 11:f=l.sent(),l.label=12;case 12:return n.staleIfError&&(a.headers[c.XAxiosCacheStaleIfError]=String(f)),S={state:"cached",ttl:f,staleTtl:h,createdAt:Date.now(),data:m},(w=e.waiting[a.id])&&(w.resolve(S.data),delete e.waiting[a.id]),[4,e.storage.set(a.id,S,t)];case 13:return l.sent(),[2,a]}}))}))},n=function(a){return d(t,void 0,void 0,(function(){var t,n,o,s,u,d,f,h,p,g;return l(this,(function(l){switch(l.label){case 0:if(!a.isAxiosError||!a.config)throw a;if(t=a.config,n=t.id,o=t.cache,s=a.response,!o||!n)throw a;return v(t.method,o.methods)?[3,2]:[4,r(n,t)];case 1:throw l.sent(),a;case 2:return[4,e.storage.get(n,t)];case 3:return"loading"===(u=l.sent()).state&&"stale"===u.previous?[3,5]:[4,r(n,t)];case 4:throw l.sent(),a;case 5:return o.staleIfError?(d=String(null==s?void 0:s.headers[c.CacheControl]),f=d&&i(d).staleIfError,"function"!=typeof o.staleIfError?[3,7]:[4,o.staleIfError(s,u,a)]):[3,10];case 6:return p=l.sent(),[3,8];case 7:p=!0===o.staleIfError&&f?1e3*f:o.staleIfError,l.label=8;case 8:return!0===(h=p)||"number"==typeof h&&u.createdAt+h>Date.now()?(null===(g=e.waiting[n])||void 0===g||g.resolve(u.data),delete e.waiting[n],[4,e.storage.set(n,{state:"stale",createdAt:Date.now(),data:u.data},t)]):[3,10];case 9:return l.sent(),[2,{cached:!0,config:t,id:n,data:u.data.data,headers:u.data.headers,status:u.data.status,statusText:u.data.statusText}];case 10:return[4,r(n,t)];case 11:throw l.sent(),a}}))}))};return{onFulfilled:a,onRejected:n,apply:function(){return e.interceptors.response.use(a,n)}}}var w=function(e){return!!e&&!!e["is-storage"]};function x(e){var t=e.data.headers;return c.ETag in t||c.LastModified in t||c.XAxiosCacheEtag in t||c.XAxiosCacheLastModified in t}function C(e){return!String(e.data.headers[c.CacheControl]).includes("must-revalidate")&&(!!x(e)||"cached"===e.state&&void 0!==e.staleTtl&&Math.abs(Date.now()-(e.createdAt+e.ttl))<=e.staleTtl)}function I(e){return void 0!==e.ttl&&e.createdAt+e.ttl<=Date.now()}function A(e){var t=this,r=e.set,a=e.find,n=e.remove;return{"is-storage":1,set:r,remove:n,get:function(e,o){return d(t,void 0,void 0,(function(){var t;return l(this,(function(i){switch(i.label){case 0:return[4,a(e,o)];case 1:return(t=i.sent())?"empty"===t.state||"loading"===t.state?[2,t]:"cached"!==t.state?[3,5]:I(t)?C(t)?[3,3]:[4,n(e,o)]:[2,t]:[2,{state:"empty"}];case 2:return i.sent(),[2,{state:"empty"}];case 3:return t={state:"stale",createdAt:t.createdAt,data:t.data,ttl:void 0!==t.staleTtl?t.staleTtl+t.ttl:void 0},[4,r(e,t,o)];case 4:i.sent(),i.label=5;case 5:return I(t)?x(t)?[2,t]:[4,n(e,o)]:[2,t];case 6:return i.sent(),[2,{state:"empty"}]}}))}))}}}function O(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===r&&(r=!1);var a=A({set:function(t,n){if(r){var o=Object.keys(a.data);if(o.length>=r)for(a.cleanup(),o=Object.keys(a.data);o.length>=r;)delete a.data[o.shift()]}a.data[t]="double"===e?"function"==typeof structuredClone?structuredClone(n):JSON.parse(JSON.stringify(n)):n},remove:function(e){delete a.data[e]},find:function(t){var r=a.data[t];return e&&void 0!==r?"function"==typeof structuredClone?structuredClone(r):JSON.parse(JSON.stringify(r)):r}});return a.data=Object.create(null),a.cleanup=function(){for(var e,t,r=Object.keys(a.data),n=-1;++n<r.length;)t=r[n],"empty"!==(e=a.data[t]).state?"cached"===e.state&&I(e)&&!C(e)&&a.remove(t):a.remove(t)},t&&(a.cleaner=setInterval(a.cleanup,t)),a}function j(e,t){return e>t?1:-1}function E(e,t){var r=5381;if("object"==typeof e&&null!==e&&(e.toString===Object.prototype.toString||e.toString===Array.prototype.toString)){t||(t=new WeakSet);for(var a=Object.keys(e).sort(j),n=0;n<a.length;n++){var o=a[n],i=e[o];if(r=33*r^E(o,t),"object"==typeof i&&null!==i&&(e.toString===Object.prototype.toString||e.toString===Array.prototype.toString)){if(t.has(i))continue;t.add(i)}r=33*r^E(i,t)}return 33*r^E(e.constructor,t)}var c=typeof e;try{e instanceof Date?c+=e.getTime():c+=String(e)}catch(t){c+=String(Object.assign({},e))}for(var s=0;s<c.length;s++)r=33*r^c.charCodeAt(s);return r}var T=/^\/|\/$/g;function M(e){return function(t){if(t.id)return t.id;var r=e(t);return"".concat("string"==typeof r||"number"==typeof r?r:E(r))}}var k=M((function(e){var t=e.baseURL,r=e.url,a=e.method,n=e.params,o=e.data;return t=void 0!==t?t.replace(T,""):"",r=void 0!==r?r.replace(T,""):"",{url:t+(t&&r?"/":"")+r,params:n,method:a=void 0!==a?a.toLowerCase():"get",data:o}}));function P(e,t){var r,a,n,o,i,c,u,d;void 0===t&&(t={});var l=e;if(l.defaults.cache)throw new Error("setupCache() should be called only once");if(l.storage=t.storage||O(),!w(l.storage))throw new Error("Use buildStorage() function");return l.waiting=t.waiting||{},l.generateKey=t.generateKey||k,l.headerInterpreter=t.headerInterpreter||s,l.requestInterceptor=t.requestInterceptor||m(l),l.responseInterceptor=t.responseInterceptor||S(l),l.debug=t.debug||function(){},l.defaults.cache={update:t.update||{},ttl:null!==(r=t.ttl)&&void 0!==r?r:3e5,methods:t.methods||["get","head"],cachePredicate:t.cachePredicate||{statusCheck:function(e){return[200,203,300,301,302,404,405,410,414,501].includes(e)}},etag:null===(a=t.etag)||void 0===a||a,modifiedSince:null!==(n=t.modifiedSince)&&void 0!==n?n:!1===t.etag,interpretHeader:null===(o=t.interpretHeader)||void 0===o||o,cacheTakeover:null===(i=t.cacheTakeover)||void 0===i||i,staleIfError:null===(c=t.staleIfError)||void 0===c||c,override:null!==(u=t.override)&&void 0!==u&&u,hydrate:null!==(d=t.hydrate)&&void 0!==d?d:void 0},l.requestInterceptor.apply(),l.responseInterceptor.apply(),l}function N(e,t){return void 0===t&&(t="axios-cache-"),A({find:function(r){var a=e.getItem(t+r);return a?JSON.parse(a):void 0},remove:function(r){e.removeItem(t+r)},set:function(r,a){var n=function(){return e.setItem(t+r,JSON.stringify(a))};try{return n()}catch(a){for(var o=Object.entries(e).filter((function(e){return e[0].startsWith(t)})).map((function(e){return[e[0],JSON.parse(e[1])]})),i=0,c=o;i<c.length;i++){var s=c[i];"cached"===s[1].state&&I(s[1])&&!C(s[1])&&e.removeItem(s[0])}try{return n()}catch(t){for(var u=o.sort((function(e,t){return(e[1].createdAt||0)-(t[1].createdAt||0)})),d=0,l=u;d<l.length;d++){var f=l[d];e.removeItem(f[0]);try{return n()}catch(e){}}}e.removeItem(t+r)}}})}return t}()}));