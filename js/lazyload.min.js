/*!
 * An jQuery | zepto plugin for lazy loading images.
 * author -> jieyou
 * see https://github.com/jieyou/lazyload
 * use some tuupola's code https://github.com/tuupola/jquery_lazyload (BSD)
 * use component's throttle https://github.com/component/throttle (MIT)
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery||window.Zepto)}((function(t,e){function g(){}function h(t,e){return(e._$container==n?("innerHeight"in r?r.innerHeight:n.height())+n.scrollTop():e._$container.offset().top+e._$container.height())<=t.offset().top-e.threshold}function i(e,a){return(a._$container==n?n.width()+(t.fn.scrollLeft?n.scrollLeft():r.pageXOffset):a._$container.offset().left+a._$container.width())<=e.offset().left-a.threshold}function j(t,e){return(e._$container==n?n.scrollTop():e._$container.offset().top)>=t.offset().top+e.threshold+t.height()}function k(e,a){return(a._$container==n?t.fn.scrollLeft?n.scrollLeft():r.pageXOffset:a._$container.offset().left)>=e.offset().left+a.threshold+e.width()}function l(t,e){var a=0;t.each((function(r,n){function g(){o.trigger("_lazyload_appear"),a=0}var o=t.eq(r);if(!(o.width()<=0&&o.height()<=0||"none"===o.css("display")))if(e.vertical_only)if(j(o,e));else if(h(o,e)){if(++a>e.failure_limit)return!1}else g();else if(j(o,e)||k(o,e));else if(h(o,e)||i(o,e)){if(++a>e.failure_limit)return!1}else g()}))}function m(t){return t.filter((function(e,a){return!t.eq(e)._lazyload_loadStarted}))}var a,r=window,n=t(r),o={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:r,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:g,load:g,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:g,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};a=function(){var t=Object.prototype.toString;return function(e){return t.call(e).replace("[object ","").replace("]","")}}(),t.fn.hasOwnProperty("lazyload")||(t.fn.lazyload=function(e){var c,f,_,s=this;return t.isPlainObject(e)||(e={}),t.each(o,(function(c,f){-1!=t.inArray(c,["threshold","failure_limit","check_appear_throttle_time"])?"String"==a(e[c])?e[c]=parseInt(e[c],10):e[c]=f:"container"==c?(e.hasOwnProperty(c)?e[c]==r||e[c]==document?e._$container=n:e._$container=t(e[c]):e._$container=n,delete e.container):!o.hasOwnProperty(c)||e.hasOwnProperty(c)&&a(e[c])==a(o[c])||(e[c]=f)})),c="scroll"==e.event,_=0==e.check_appear_throttle_time?l:function(t,e){function h(){o=0,c=+new Date,n=t.apply(a,r),a=null,r=null}var a,r,n,o,c=0;return function(){a=this,r=arguments;var t=new Date-c;return o||(t>=e?h():o=setTimeout(h,e-t)),n}}(l,e.check_appear_throttle_time),f=c||"scrollstart"==e.event||"scrollstop"==e.event,s.each((function(a,r){var n=this,o=s.eq(a),c=o.attr("src"),_=o.attr("data-"+e.data_attribute),d=e.url_rewriter_fn==g?_:e.url_rewriter_fn.call(n,o,_),u=o.attr("data-"+e.data_srcset_attribute),p=o.is("img");return 1==o._lazyload_loadStarted||c==d?(o._lazyload_loadStarted=!0,void(s=m(s))):(o._lazyload_loadStarted=!1,p&&!c&&o.one("error",(function(){o.attr("src",e.placeholder_real_img)})).attr("src",e.placeholder_data_img),o.one("_lazyload_appear",(function(){function i(){a&&o.hide(),p?(u&&o.attr("srcset",u),d&&o.attr("src",d)):o.css("background-image",'url("'+d+'")'),a&&o[e.effect].apply(o,r?e.effect_params:[]),s=m(s)}var a,r=t.isArray(e.effect_params);o._lazyload_loadStarted||(a="show"!=e.effect&&t.fn[e.effect]&&(!e.effect_params||r&&0==e.effect_params.length),e.appear!=g&&e.appear.call(n,o,s.length,e),o._lazyload_loadStarted=!0,e.no_fake_img_loader||u?(e.load!=g&&o.one("load",(function(){e.load.call(n,o,s.length,e)})),i()):t("<img />").one("load",(function(){i(),e.load!=g&&e.load.call(n,o,s.length,e)})).attr("src",d))})),void(f||o.on(e.event,(function(){o._lazyload_loadStarted||o.trigger("_lazyload_appear")}))))})),f&&e._$container.on(e.event,(function(){_(s,e)})),n.on("resize load",(function(){_(s,e)})),t((function(){_(s,e)})),this})}));