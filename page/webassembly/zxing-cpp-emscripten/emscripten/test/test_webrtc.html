<html><body><script async src="../../build/zxing.js"></script><div id="scanned"></div><script>var image,last=Date.now(),DEBUG=0,tick=function(){window.ZXing?(ZXing=ZXing(),testZXing()):setTimeout(tick,10)};function log(){if(DEBUG){var t=Date.now(),e=Array.prototype.slice.call(arguments);e.unshift("+"+(t-last)+"ms"),console.log.apply(console,e),last=t}}function testZXing(){var d=document.createElement("video");d.autoplay=!0,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var t={audio:!1,video:{mandatory:{maxWidth:640,maxHeight:480}}};function e(t){console.log("Can't access user media",t)}navigator.getUserMedia?navigator.getUserMedia(t,function(t){console.log("success",t),d.src=window.URL.createObjectURL(t),d.onclick=function(){d.play()},d.play();var l=ZXing.Runtime.addFunction(function(t,e,i,a,n,o,r,l,d,c,g,s){var h=new Uint8Array(ZXing.HEAPU8.buffer,t,e),u=String.fromCharCode.apply(null,h);0===i&&(window.resultString=""),window.resultString+=u+"<br>",ctx.fillStyle="red",ctx.fillRect(n-5,o-5,10,10),ctx.fillStyle="green",ctx.fillRect(r-5,l-5,10,10),ctx.fillStyle="blue",ctx.fillRect(d-5,c-5,10,10),ctx.fillStyle="purple",ctx.fillRect(g-5,s-5,10,10)});!function t(){if(requestAnimationFrame(t),d.videoWidth){if(!image){width=d.videoWidth,height=d.videoHeight,log("video",width,height,d);var e=document.createElement("canvas");return e.width=width,e.height=height,e.style.transform="scale(-1, 1)",ctx=e.getContext("2d"),document.body.appendChild(e),log("start"),void log("_xsetup",image=ZXing._resize(width,height),"pointer")}log("interval"),console.time("a"),ctx.drawImage(d,0,0,width,height);var i=ctx.getImageData(0,0,width,height);data=i.data;for(var a=0,n=0;a<data.length;a+=4,n++)ZXing.HEAPU8[image+n]=.2989*data[a+0]+.587*data[a+1]+.114*data[a+2];var o=ZXing._decode_qr_multi(l),r=o?"error: "+o:window.resultString;scanned.innerHTML=r,console.timeEnd("a")}}()},e):e("")}tick()</script></body></html>